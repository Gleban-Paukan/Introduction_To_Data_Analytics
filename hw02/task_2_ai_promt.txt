#%% md
<!-- ะะฝะธะผะฐะฝะธะต! ะะดะตัั ะฝะฐัะพะดะธััั ัะฟะตัะธะฐะปัะฝะฐั ะพัะผะตัะบะฐ. ะะต ะฝะตะปัะทั ัะดะฐะปััั! ะัะฒะตัั ะฝะฐ ะฒะพะฟัะพัั / ะฒัะฒะพะดั ะดะปั ะฟัะตะดัะดััะตะณะพ ะฟัะฝะบัะฐ(ะพะฒ) ะฟะธัะธ ะฒ ััะตะนะบะฐั ะฒััะต! -->
<!-- 401c68baed5870bfd4cb4374e9a69caf -->
ะญัะพ ะทะฐะดะฐัะฐ ะดะปั ัะฐะทะผะธะฝะบะธ ะฒัะตะณะพ ะฝะฐ 5 ะฑะฐะปะปะพะฒ. ะะพะทะผะพะถะฝะพ, ะพะฝะฐ ะฟะพะบะฐะถะตััั ะฒะฐะผ ะทะฐะฑะฐะฒะฝะพะน, ะฝะพ ััะพ ะดะตะนััะฒะธัะตะปัะฝะพ ัะฐะบ ๐

ะะธะถะต ะฟัะตะดััะฐะฒะปะตะฝ ะบะพะด ะฝะฐ ัะทัะบะต C++. ะะตัะตะฟะธัะธัะต ะตะณะพ ะฝะฐ Python ะธ ะทะฐะฟัััะธัะต ะฑะตะท ะพัะธะฑะพะบ. ะะพััะฝะธัะต, ััะพ ะดะตะปะฐะตั ััะพั ะบะพะด?

ะัะปะธ ะบะพะด ะฝะต ัะฐะฑะพัะฐะตั, ะพะฑััะดะธัะต ะฟัะพะฑะปะตะผั ั ะผะพะดะตะปัั ะธะปะธ ะธัะฟะพะปัะทัะนัะต ะดััะณัั, ััะฐ ะทะฐะดะฐัะฐ ะณะฐัะฐะฝัะธัะพะฒะฐะฝะฝะพ ัะตัะฐะตััั.
#include <iostream>
#include <vector>
#include <cstdlib>
#include <ctime>

#define ๐ int
#define ๐ void
#define ๐ std::vector<int>
#define ๐จ๏ธ std::cout
#define ๐ข rand()
#define โฐ time(0)
#define ๐ srand
#define ๐ for
#define ๐ while
#define ๐ฒ if
#define ๐ else
#define ๐ return
#define ๐ฏ main
#define ๐ฅ๏ธ std::endl

๐ ๐ญ(๐& ๐, ๐ ๐, ๐ ๐, ๐ ๐) {
    ๐ ๐ = ๐ - ๐ + 1;
    ๐ ๐ = ๐ - ๐;

    ๐ ๐(๐), ๐(๐);

    ๐ (๐ ๐ = 0; ๐ < ๐; ๐++)
        ๐[๐] = ๐[๐ + ๐];
    ๐ (๐ ๐ = 0; ๐ < ๐; ๐++)
        ๐[๐] = ๐[๐ + 1 + ๐];

    ๐ ๐ = 0, ๐ = 0, ๐ = ๐;
    ๐ (๐ < ๐ && ๐ < ๐) {
        ๐ฒ (๐[๐] <= ๐[๐]) {
            ๐[๐] = ๐[๐];
            ๐++;
        } ๐ {
            ๐[๐] = ๐[๐];
            ๐++;
        }
        ๐++;
    }

    ๐ (๐ < ๐) {
        ๐[๐] = ๐[๐];
        ๐++;
        ๐++;
    }

    ๐ (๐ < ๐) {
        ๐[๐] = ๐[๐];
        ๐++;
        ๐++;
    }
}

๐ ๐ฟ(๐& ๐, ๐ ๐, ๐ ๐) {
    ๐ฒ (๐ < ๐) {
        ๐ ๐ = ๐ + (๐ - ๐) / 2;

        ๐ฟ(๐, ๐, ๐);
        ๐ฟ(๐, ๐ + 1, ๐);

        ๐ญ(๐, ๐, ๐, ๐);
    }
}

๐ ๐ฒ(๐ ๐ฏ, ๐ ๐ฐ, ๐ ๐ณ) {
    ๐ ๐จ(๐ฏ);
    ๐ (๐ ๐ = 0; ๐ < ๐ฏ; ๐++) {
        ๐จ[๐] = ๐ข % (๐ณ - ๐ฐ + 1) + ๐ฐ;
    }
    ๐ ๐จ;
}

๐ ๐จ๏ธ(const ๐& ๐) {
    ๐ (๐ ๐ : ๐) {
        ๐จ๏ธ << ๐ << " ";
    }
    ๐จ๏ธ << ๐ฅ๏ธ;
}

๐ ๐ฏ() {
    ๐(โฐ);

    ๐ ๐ฏ = 20;
    ๐ ๐ฐ = 0;
    ๐ ๐ณ = 100;

    ๐ ๐ = ๐ฒ(๐ฏ, ๐ฐ, ๐ณ);

    ๐จ๏ธ << "?: ";
    ๐จ๏ธ(๐);

    ๐ฟ(๐, 0, ๐.size() - 1);

    ๐จ๏ธ << "??: ";
    ๐จ๏ธ(๐);

    ๐ 0;
}
ะะตัะตะฝะธะต ะทะฐะดะฐัะธ ััะตะฑัะตั ะฟะตัะตะฟะธััะฒะฐะฝะธั ะบะพะดะฐ ะฝะฐ ัะทัะบะต C++ ะฝะฐ Python. ะะฐะฒะฐะนัะต ัะฐะทะฑะตัะตะผ, ััะพ ะดะตะปะฐะตั ััะพั ะบะพะด, ะฐ ะทะฐัะตะผ ะฟะตัะตะฟะธัะตะผ ะตะณะพ. ### ะะพััะฝะตะฝะธะต ะบะพะดะฐ ะฝะฐ C++: ะญัะพั ะบะพะด ัะตะฐะปะธะทัะตั ัะพััะธัะพะฒะบั ัะปะธัะฝะธะตะผ (Merge Sort). ะะพั ะฟะพะดัะพะฑะฝะพะต ะพะฟะธัะฐะฝะธะต ัะฐะฑะพัั ะบะฐะถะดะพะณะพ ะบะพะผะฟะพะฝะตะฝัะฐ: 1. **ะัะฝะพะฒะฝัะต ะฟะตัะตะผะตะฝะฝัะต ะธ ััะฝะบัะธะธ:** - `๐ฏ` (main) โ ะณะปะฐะฒะฝะฐั ััะฝะบัะธั (`main`). - `๐` โ ะฒะตะบัะพั ัะตะปัั ัะธัะตะป (`std::vector<int>` ะฒ C++). - `๐` โ ะผะฐััะธะฒ/ะฒะตะบัะพั ัะธัะตะป, ะฟะตัะตะดะฐะฒะฐะตะผัะน ะฒ ััะฝะบัะธะธ. - `๐ฟ` โ ััะฝะบัะธั ัะพััะธัะพะฒะบะธ ะผะฐััะธะฒะฐ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ัะตะบัััะธะธ. - `๐ญ` โ ััะฝะบัะธั ะดะปั ัะปะธัะฝะธั ะดะฒัั ะพััะพััะธัะพะฒะฐะฝะฝัั ัะฐััะตะน ะฒ ะพะดะธะฝ ะพััะพััะธัะพะฒะฐะฝะฝัะน ะผะฐััะธะฒ. - `๐จ` โ ััะฝะบัะธั ะดะปั ะณะตะฝะตัะฐัะธะธ ัะปััะฐะนะฝัั ัะธัะตะป ะฒ ะดะธะฐะฟะฐะทะพะฝะต ะพั `๐ฐ` ะดะพ `๐ณ`. 2. **ะัะฝะพะฒะฝะพะน ะฟัะพัะตัั:** 1. ะะตะฝะตัะฐัะธั ะผะฐััะธะฒะฐ ัะปััะฐะนะฝัั ัะธัะตะป ั ะฟะพะผะพััั ััะฝะบัะธะธ `๐ฒ`. 2. ะกะพััะธัะพะฒะบะฐ ะผะฐััะธะฒะฐ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ััะฝะบัะธะธ `๐ฟ`. 3. ะะตัะฐัั ะผะฐััะธะฒะฐ ะดะพ ะธ ะฟะพัะปะต ัะพััะธัะพะฒะบะธ. ะะปั ััะพะณะพ ะธัะฟะพะปัะทััััั ััะฝะบัะธะธ `๐จ๏ธ`, ะบะพัะพัะฐั ะฒัะฒะพะดะธั ะฝะฐ ัะบัะฐะฝ ัะปะตะผะตะฝัั ะฒะตะบัะพัะฐ. ะขะตะฟะตัั ะฟะตัะตะฟะธัะตะผ ััะพั ะบะพะด ะฝะฐ Python. ### ะะตัะตะฟะธัะฐะฝะฝัะน ะบะพะด ะฝะฐ Python: ```python import random def merge(arr, left, mid, right): size_left = mid - left + 1 size_right = right - mid left_half = arr[left:mid + 1] right_half = arr[mid + 1:right + 1] i = j = k = left while i < size_left and j < size_right: if left_half[i] <= right_half[j]: arr[k] = left_half[i] i += 1 else: arr[k] = right_half[j] j += 1 k += 1 while i < size_left: arr[k] = left_half[i] i += 1 k += 1 while j < size_right: arr[k] = right_half[j] j += 1 k += 1 def merge_sort(arr, left, right): if left < right: mid = (left + right) // 2 merge_sort(arr, left, mid) merge_sort(arr, mid + 1, right) merge(arr, left, mid, right) def generate_random_numbers(n, min_val, max_val): return [random.randint(min_val, max_val) for _ in range(n)] def print_array(arr): print(" ".join(map(str, arr))) def main(): random.seed() num_elements = 20 min_val = 0 max_val = 100 arr = generate_random_numbers(num_elements, min_val, max_val) print("?: ", end="") print_array(arr) merge_sort(arr, 0, len(arr) - 1) print("??: ", end="") print_array(arr) if __name__ == "__main__": main() ``` ### ะะพััะฝะตะฝะธะต ัะฐะฑะพัั: 1. **ะะตะฝะตัะฐัะธั ัะปััะฐะนะฝัั ัะธัะตะป:** ะ Python ะธัะฟะพะปัะทัะตััั `random.randint()` ะดะปั ะณะตะฝะตัะฐัะธะธ ัะปััะฐะนะฝัั ัะธัะตะป ะฒ ะทะฐะดะฐะฝะฝะพะผ ะดะธะฐะฟะฐะทะพะฝะต. 2. **ะกะพััะธัะพะฒะบะฐ ัะปะธัะฝะธะตะผ:** ะคัะฝะบัะธั `merge_sort` ัะตะบัััะธะฒะฝะพ ะดะตะปะธั ะผะฐััะธะฒ ะฟะพะฟะพะปะฐะผ ะธ ะทะฐัะตะผ ะฒัะทัะฒะฐะตััั ะฝะฐ ะบะฐะถะดะพะผ ะธะท ะพััะพััะธัะพะฒะฐะฝะฝัั ะฟะพะดะผะฐััะธะฒะพะฒ. 3. **ะกะปะธัะฝะธะต ะฟะพะดะผะฐััะธะฒะพะฒ:** ะคัะฝะบัะธั `merge` ัะปะธะฒะฐะตั ะดะฒะฐ ะพััะพััะธัะพะฒะฐะฝะฝัั ะฟะพะดะผะฐััะธะฒะฐ ะฒ ะพะดะธะฝ ะพััะพััะธัะพะฒะฐะฝะฝัะน ะผะฐััะธะฒ. 4. **ะัะฒะพะด:** ะคัะฝะบัะธั `print_array` ะฒัะฒะพะดะธั ัะปะตะผะตะฝัั ะผะฐััะธะฒะฐ ะฝะฐ ัะบัะฐะฝ. ### ะัะพะฑะปะตะผั ั ะพัะธะณะธะฝะฐะปัะฝัะผ ะบะพะดะพะผ: - ะ ะพัะธะณะธะฝะฐะปัะฝะพะผ C++ ะบะพะดะต ะธัะฟะพะปัะทัะตััั ะทะฐะผะตะฝะฐ ััะฐะฝะดะฐััะฝัั ะธะผะตะฝ ัะธะผะฒะพะปะฐะผะธ ะดะปั ะทะฐะฑะฐะฒะฝัั ัะตะปะตะน, ะฝะพ ััะฝะบัะธะพะฝะฐะปัะฝะพ ััะพั ะบะพะด ัะตะฐะปะธะทัะตั ััะฐะฝะดะฐััะฝัั ัะพััะธัะพะฒะบั ัะปะธัะฝะธะตะผ ะธ ะณะตะฝะตัะฐัะธั ัะปััะฐะนะฝัั ัะธัะตะป. ะดะปั 1m 6s
ะะธะถะต ะฟัะธะฒะตะดัะฝ ัะบะฒะธะฒะฐะปะตะฝัะฝัะน ะบะพะด ะฝะฐ Python, ะบะพัะพััะน ะดะตะปะฐะตั ัะพ ะถะต ัะฐะผะพะต, ััะพ ะธ ะฒะฐั C++-ะฟัะธะผะตั ั ยซัะผะพะดะทะธ-ะผะฐะบัะพัะฐะผะธยป.

ะะพัะพัะบะพ ะพ ัะพะผ, ััะพ ะดะตะปะฐะตั ะธััะพะดะฝัะน ะบะพะด ะฝะฐ C++

ะะตะฝะตัะธััะตั ะฒะตะบัะพั (ะผะฐััะธะฒ) ัะปััะฐะนะฝัั ัะตะปัั ัะธัะตะป ะทะฐะดะฐะฝะฝะพะณะพ ัะฐะทะผะตัะฐ (20 ัััะบ) ะฒ ะดะธะฐะฟะฐะทะพะฝะต ะพั 0 ะดะพ 100.
ะัะฒะพะดะธั ัะณะตะฝะตัะธัะพะฒะฐะฝะฝัะน ะผะฐััะธะฒ.
ะกะพััะธััะตั ััะพั ะผะฐััะธะฒ ั ะฟะพะผะพััั ะฐะปะณะพัะธัะผะฐ ัะปะธัะฝะธั (merge sort).
ะัะฒะพะดะธั ะพััะพััะธัะพะฒะฐะฝะฝัะน ะผะฐััะธะฒ.
ะะฑัะฐัะธัะต ะฒะฝะธะผะฐะฝะธะต, ััะพ ะฒัะต ยซัะผะพะดะทะธยป ะฒ ะธััะพะดะฝะพะผ ะบะพะดะต ัะฐะบัะธัะตัะบะธ ัะฒะปััััั ะผะฐะบัะพัะฐะผะธ, ะบะพัะพััะต ะฟัะตะฒัะฐัะฐัั ะตะณะพ ะฒ ััะฐะฝะดะฐััะฝัั ะฟัะพะณัะฐะผะผั ะฝะฐ C++ ั ัะตะฐะปะธะทะฐัะธะตะน merge sort.

ะะตะฐะปะธะทะฐัะธั ะฝะฐ Python
python
ะะพะฟะธัะพะฒะฐัั
import random
import time

def merge(arr, left, mid, right):
    """
    ะกะปะธะฒะฐะตั ะดะฒะต ะพััะพััะธัะพะฒะฐะฝะฝัะต ัะฐััะธ ะผะฐััะธะฒะฐ arr:
      - arr[left..mid]
      - arr[mid+1..right]
    ะะตะทัะปััะฐั ัะพััะฐะฝัะตััั ะฒ arr[left..right].
    """
    n1 = mid - left + 1
    n2 = right - mid

    # ะกะพะทะดะฐะตะผ ะฒัะตะผะตะฝะฝัะต ะผะฐััะธะฒั ะดะปั ะปะตะฒะพะน ะธ ะฟัะฐะฒะพะน ะฟะพะปะพะฒะธะฝ
    L = arr[left:left+n1]
    R = arr[mid+1:mid+1+n2]

    i, j = 0, 0  # ะธะฝะดะตะบัั ะดะปั L ะธ R
    k = left     # ะธะฝะดะตะบั ะดะปั arr

    # ะกะปะธะฒะฐะตะผ, ะฟะพะบะฐ ะฝะต ะดะพััะธะณะฝะตะผ ะบะพะฝัะฐ ะพะดะฝะพะณะพ ะธะท ะฟะพะดะผะฐััะธะฒะพะฒ
    while i < n1 and j < n2:
        if L[i] <= R[j]:
            arr[k] = L[i]
            i += 1
        else:
            arr[k] = R[j]
            j += 1
        k += 1

    # ะะพะฟะธััะตะผ ะพััะฐะฒัะธะตัั ัะปะตะผะตะฝัั ะธะท L, ะตัะปะธ ะพะฝะธ ะตััั
    while i < n1:
        arr[k] = L[i]
        i += 1
        k += 1

    # ะะพะฟะธััะตะผ ะพััะฐะฒัะธะตัั ัะปะตะผะตะฝัั ะธะท R, ะตัะปะธ ะพะฝะธ ะตััั
    while j < n2:
        arr[k] = R[j]
        j += 1
        k += 1


def merge_sort(arr, left, right):
    """
    ะะตะบัััะธะฒะฝะฐั ัะพััะธัะพะฒะบะฐ ัะปะธัะฝะธะตะผ.
    ะกะพััะธััะตั ัะฐััั ะผะฐััะธะฒะฐ arr ั ะธะฝะดะตะบัะฐะผะธ ะพั left ะดะพ right.
    """
    if left < right:
        mid = (left + right) // 2
        merge_sort(arr, left, mid)
        merge_sort(arr, mid + 1, right)
        merge(arr, left, mid, right)


def generate_random_vector(size, low, high):
    """
    ะะตะฝะตัะธััะตั ัะฟะธัะพะบ ะธะท size ัะปััะฐะนะฝัั ัะตะปัั ัะธัะตะป
    ะฒ ะดะธะฐะฟะฐะทะพะฝะต [low, high].
    """
    return [random.randint(low, high) for _ in range(size)]


def print_vector(arr):
    """
    ะัะฒะพะดะธั ัะปะตะผะตะฝัั ัะฟะธัะบะฐ arr ะฒ ะพะดะฝั ัััะพะบั.
    """
    print(" ".join(map(str, arr)))


def main():
    # ะะฝะธัะธะฐะปะธะทะธััะตะผ ะณะตะฝะตัะฐัะพั ัะปััะฐะนะฝัั ัะธัะตะป
    random.seed(time.time())

    n = 20     # ัะฐะทะผะตั ะผะฐััะธะฒะฐ
    low = 0    # ะฝะธะถะฝัั ะณัะฐะฝะธัะฐ ัะปััะฐะนะฝัั ัะธัะตะป
    high = 100 # ะฒะตััะฝัั ะณัะฐะฝะธัะฐ ัะปััะฐะนะฝัั ัะธัะตะป

    arr = generate_random_vector(n, low, high)

    print("?: ", end="")
    print_vector(arr)

    merge_sort(arr, 0, len(arr) - 1)

    print("??: ", end="")
    print_vector(arr)


if __name__ == "__main__":
    main()
ะะพััะฝะตะฝะธะต, ััะพ ะดะตะปะฐะตั ะฟัะพะณัะฐะผะผะฐ:
generate_random_vector(n, low, high) ะณะตะฝะตัะธััะตั ัะฟะธัะพะบ ะธะท n ัะปััะฐะนะฝัั ัะธัะตะป ะฒ ะดะธะฐะฟะฐะทะพะฝะต ะพั low ะดะพ high.
ะัะฒะพะดะธั ัะณะตะฝะตัะธัะพะฒะฐะฝะฝัะน ัะฟะธัะพะบ.
ะคัะฝะบัะธั merge_sort ัะตะบัััะธะฒะฝะพ ัะฐะทะฑะธะฒะฐะตั ัะฟะธัะพะบ ะฝะฐ ะฟะพะดัะฟะธัะบะธ, ะฐ ะทะฐัะตะผ ัะปะธะฒะฐะตั ะธั ะพะฑัะฐัะฝะพ ะฒ ะพััะพััะธัะพะฒะฐะฝะฝะพะผ ะฟะพััะดะบะต (ััะฝะบัะธั merge).
ะัะฒะพะดะธั ะธัะพะณะพะฒัะน (ะพััะพััะธัะพะฒะฐะฝะฝัะน) ัะฟะธัะพะบ.
ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะฟัะธ ะทะฐะฟััะบะต ะฒั ัะฒะธะดะธัะต ัะฝะฐัะฐะปะฐ ะผะฐััะธะฒ ะธะท 20 ัะปััะฐะนะฝัั ัะธัะตะป, ะฐ ะทะฐัะตะผ ัะพั ะถะต ะผะฐััะธะฒ, ะฝะพ ัะถะต ะพััะพััะธัะพะฒะฐะฝะฝัะน ะฟะพ ะฒะพะทัะฐััะฐะฝะธั.






ะั ัะบะฐะทะฐะปะธ:
ะ ััะพะน ะทะฐะดะฐัะต ะฒะฐะผ ะฟัะตะดััะพะธั ะฟะพัะฐะฑะพัะฐัั ั ะฑะธะฑะปะธะพัะตะบะพะน Plotly. ะญัะพ ะฟะพะปะตะทะฝัะน ะธะฝััััะผะตะฝั ะดะปั ัะพะทะดะฐะฝะธั ะฟัะธะฒะปะตะบะฐัะตะปัะฝัั ะธ ัะดะพะฑะฝัั ะณัะฐัะธะบะพะฒ, ะบะพัะพััะน ะฒั ะฝะฐะฒะตัะฝัะบะฐ ะฑัะดะตัะต ะธัะฟะพะปัะทะพะฒะฐัั ะฒ ัะฒะพะตะน ัะฐะฑะพัะต. ะั ัะตะบะพะผะตะฝะดัะตะผ ะทะฐัะฐะฝะตะต ะธะทััะธัั ะตะณะพ ััะฝะบัะธะธ ะธ ะฒะพะทะผะพะถะฝะพััะธ, ััะพะฑั ะฒั ะผะพะณะปะธ ัะฒะตัะตะฝะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ะตะณะพ ะฒ ะดะฐะปัะฝะตะนัะตะผ.

ะะดะฝะฐ ะธะท ะณะปะฐะฒะฝัั ะพัะพะฑะตะฝะฝะพััะตะน ััะพะน ะฑะธะฑะปะธะพัะตะบะธ โ ะฒะพะทะผะพะถะฝะพััั ะฝะฐัััะฐะธะฒะฐัั ะธ ัะบัะฐัะฐัั ะณัะฐัะธะบะธ ะฟะพ ัะฒะพะตะผั ะฒะบััั. ะะผะตะฝะฝะพ ััะธะผ ะผั ะธ ะฟัะตะดะปะฐะณะฐะตะผ ะฒะฐะผ ะทะฐะฝััััั ะฒ ัะฐะผะบะฐั ะดะฐะฝะฝะพะน ะทะฐะดะฐัะธ.

ะะธะถะต ะฟัะธะฒะตะดะตะฝ ะบะพะด ะดะปั ะฟะพัััะพะตะฝะธั 3D-ะณัะฐัะธะบะฐ ััะฝะบัะธะธ ั ะฟะพะผะพััั Plotly.

import plotly.graph_objects as go


def plot_3d_surface():
    x = np.linspace(-10, 10, 200)
    y = np.linspace(-10, 10, 200)
    x, y = np.meshgrid(x, y)
    z = np.cos(np.sqrt(x**2 + y**2))

    fig = go.Figure(data=[go.Surface(z=z, x=x, y=y)])
    fig.update_layout(
        title='Cosine Function 3D Surface Plot',
        scene=dict(
            xaxis_title='X Axis',
            yaxis_title='Y Axis',
            zaxis_title='Z Axis',
            aspectmode='cube',
        ),
        margin=dict(l=0, r=0, b=0, t=0)
    )


    fig.show()

plot_3d_surface()

ะัะฟะพะปะฝะธัะต ัะปะตะดัััะธะต ะดะตะนััะฒะธั ะฒ ััะตะนะบะฐั ะฝะธะถะต.

1. ะะฐะดะพะบัะผะตะฝัะธััะนัะต ััะฝะบัะธั ะธ ะดะพะฑะฐะฒััะต ะบะพะผะผะตะฝัะฐัะธะตะฒ. ะะตะพะฑัะพะดะธะผะพ ััะพ ัะดะตะปะฐัั ัะฐะบ, ััะพะฑั ะปัะฑะพะน ัะตะปะพะฒะตะบ ะผะพะณ ะฟะพะฝััั, ะบะฐะบะฐั ั ะฝะตะต ะทะฐะดะฐัะฐ ะธ ััะพ ะดะตะปะฐัั ะพัะดะตะปัะฝัะต ัะฐััะธ ะบะพะดะฐ.

2. ะะฐะฟะธัะธัะต, ััะพ ะดะตะปะฐัั ัะปะตะดัััะธะต ััะฝะบัะธะธ ะธ ะพะฟัะธะธ:


*  meshgrid

*  Figure

*  Surface

*  update_layout

*  scene

*  margin

3. ะัััะฝะธัะต, ะบะฐะบะพะน ะฟะฐัะฐะผะตัั ะพัะฒะตัะฐะตั ะทะฐ ะฝะฐัััะพะนะบั ัะฒะตัะพะฒะพะน ะฟะฐะปะธััั ะณัะฐัะธะบะฐ? ะะทะผะตะฝะธัะต ะบะพะด ัะฐะบ, ััะพะฑั ะฟะฐะปะธััะฐ ะฑัะปะฐ ะพั ัะฒะตัะปะพ-ัะพะทะพะฒะพะณะพ ะดะพ ัะฒะตัะปะพ-ะณะพะปัะฑะพะณะพ.

4. ะะทะผะตะฝะธัะต ััะฝะบัะธั ัะฐะบ, ััะพะฑั ะพะฝะฐ ะผะพะณะปะฐ ะฟะพะปััะฐัั ะปัะฑัะต ะฟะฐัะฐะผะตััั ะฝะฐัััะพะนะบะธ ะณัะฐัะธะบะพะฒ ัะตัะตะท kwargs. ะญัะพ ะฟะพะทะฒะพะปะธั ะฟะพะปัะทะพะฒะฐัะตะปัะผ ะณะธะฑะบะพ ะฝะฐัััะฐะธะฒะฐัั ะฟะฐัะฐะผะตััั ะณัะฐัะธะบะฐ.

...ะ ะฝะฐะฟะธัะธัะต ะฟะพะดัะพะฑะฝัั ะธะฝััััะบัะธั ะดะปั ะฟะพะปัะทะพะฒะฐัะตะปั ััะพะน ััะฝะบัะธะธ๐
ะะฐัััะถะดะฐะปะฐ ะดะปั 34 ัะตะบัะฝะด
ะะธะถะต ะฟัะธะฒะตะดัะฝ ะฟัะธะผะตั ะบะพะดะฐ ะฝะฐ Python ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ะฑะธะฑะปะธะพัะตะบะธ Plotly, ะฒ ะบะพัะพัะพะผ:

ะะพะฑะฐะฒะปะตะฝั ะฟะพะดัะพะฑะฝัะต ะบะพะผะผะตะฝัะฐัะธะธ ะธ docstring ะบ ััะฝะบัะธะธ, ะฟะพััะฝัััะธะต, ััะพ ะดะตะปะฐะตั ะบะพะด.
ะะฟะธัะฐะฝั ััะฝะบัะธะธ ะธ ะพะฟัะธะธ meshgrid, Figure, Surface, update_layout, scene ะธ margin.
ะัะพะดะตะผะพะฝัััะธัะพะฒะฐะฝะพ, ะบะฐะบ ะธะทะผะตะฝะธัั ัะฒะตัะพะฒัั ะฟะฐะปะธััั ั ะฟะพะผะพััั ะฟะฐัะฐะผะตััะฐ colorscale, ััะพะฑั ะฟะพะปััะธัั ะณัะฐะดะธะตะฝั ะพั ัะฒะตัะปะพ-ัะพะทะพะฒะพะณะพ ะบ ัะฒะตัะปะพ-ะณะพะปัะฑะพะผั.
ะะตะฐะปะธะทะพะฒะฐะฝ ะผะตัะฐะฝะธะทะผ ะฟะตัะตะดะฐัะธ ะดะพะฟะพะปะฝะธัะตะปัะฝัั ะฟะฐัะฐะผะตััะพะฒ ัะตัะตะท **kwargs (keyword arguments), ะฟะพะทะฒะพะปัััะธะน ะณะธะฑะบะพ ะฝะฐัััะฐะธะฒะฐัั ะณัะฐัะธะบ.
python
ะะพะฟะธัะพะฒะฐัั
import numpy as np
import plotly.graph_objects as go

def plot_3d_surface(**kwargs):
    """
    ะกััะพะธั 3D-ะณัะฐัะธะบ ะฟะพะฒะตััะฝะพััะธ ััะฝะบัะธะธ z = cos(sqrt(x^2 + y^2)) ั ะฟะพะผะพััั Plotly.

    ะะฐัะฐะผะตััั:
    ----------
    **kwargs : dict
        ะกะปะพะฒะฐัั ะฟัะพะธะทะฒะพะปัะฝัั ะธะผะตะฝะพะฒะฐะฝะฝัั ะฐัะณัะผะตะฝัะพะฒ, ะบะพัะพััะต ะฟะพะทะฒะพะปััั
        ะฝะฐัััะฐะธะฒะฐัั ะบะฐะบ ัะฐะผะธ ะดะฐะฝะฝัะต ะดะปั ะณัะฐัะธะบะฐ, ัะฐะบ ะธ ะฟะฐัะฐะผะตััั ะผะฐะบะตัะฐ (layout).
        
        ะะธะถะต ะฝะตัะบะพะปัะบะพ ะฟัะธะผะตัะพะฒ ะบะปััะตะน ะธ ะธั ะทะฝะฐัะตะฝะธะน:
        
        - surface_params : dict
            ะะพะฟะพะปะฝะธัะตะปัะฝัะต ะฟะฐัะฐะผะตััั ะดะปั go.Surface (ะฝะฐะฟัะธะผะตั, colorscale, opacity ะธ ั.ะด.).
            ะัะธะผะตั: surface_params={'colorscale': 'Viridis', 'showscale': False}
            
        - layout_params : dict
            ะะพะฟะพะปะฝะธัะตะปัะฝัะต ะฟะฐัะฐะผะตััั ะดะปั layout (ะฝะฐะฟัะธะผะตั, ัะธัะธะฝะฐ/ะฒััะพัะฐ, ัะพะฝะพะฒัะน ัะฒะตั ะธ ั.ะด.).
            ะัะธะผะตั: layout_params={'width': 700, 'height': 700}
            
        - title : str
            ะะฐะณะพะปะพะฒะพะบ ะณัะฐัะธะบะฐ (ะฟะพ ัะผะพะปัะฐะฝะธั 'Cosine Function 3D Surface Plot').
            
        - scene : dict
            ะะฐัััะพะนะบะธ 3D-ััะตะฝั (ะพัั X, Y, Z, ัะตะถะธะผ ะพัะพะฑัะฐะถะตะฝะธั ะธ ั.ะด.).
            ะัะธะผะตั: scene={'xaxis_title': 'My X', 'yaxis_title': 'My Y', 'zaxis_title': 'My Z'}
            
        - margin : dict
            ะััััะฟั ะพั ะบัะฐัะฒ ัะธะณััั. ะะพ ัะผะพะปัะฐะฝะธั ัะฐะฒะฝั 0.
            ะัะธะผะตั: margin={'l': 10, 'r': 10, 'b': 20, 't': 40}
    
    ะัะธะผะตั ะฒัะทะพะฒะฐ:
    -------------
    plot_3d_surface(
        title="ะะพะน 3D-ะณัะฐัะธะบ",
        surface_params={'colorscale': [[0, 'pink'], [1, 'lightblue']]},
        scene={'xaxis_title': 'X', 'yaxis_title': 'Y', 'zaxis_title': 'Z'},
        margin={'l': 0, 'r': 0, 'b': 0, 't': 50},
        layout_params={'width': 800, 'height': 800}
    )
    
    ะะตะทัะปััะฐั:
    ----------
    ะััะธัะพะฒัะฒะฐะตั ะธะฝัะตัะฐะบัะธะฒะฝัะน 3D-ะณัะฐัะธะบ, ะบะพัะพััะน ะฐะฒัะพะผะฐัะธัะตัะบะธ ะพัะบััะฒะฐะตััั ะฒ ะฑัะฐัะทะตัะต
    ะธะปะธ ะฒะฝัััะธ Jupyter Notebook, ะฒ ะทะฐะฒะธัะธะผะพััะธ ะพั ััะตะดั ะฒัะฟะพะปะฝะตะฝะธั.
    """
    
    # 1) ะะตะฝะตัะธััะตะผ ะบะพะพัะดะธะฝะฐัั x ะธ y ะฒ ะดะธะฐะฟะฐะทะพะฝะต [-10, 10] ั 200 ัะพัะบะฐะผะธ ะฒ ะบะฐะถะดะพะผ ะฝะฐะฟัะฐะฒะปะตะฝะธะธ
    x_vals = np.linspace(-10, 10, 200)
    y_vals = np.linspace(-10, 10, 200)
    
    # 2) ะกะพะทะดะฐะตะผ ัะตัะบั ะธะท x_vals ะธ y_vals
    #   meshgrid(x, y) ะฒะพะทะฒัะฐัะฐะตั ะดะฒัะผะตัะฝัะต ะผะฐััะธะฒั X ะธ Y, ะณะดะต:
    #   - X[i, j] = x[j] (ะฟะพ ััะพะปะฑัะฐะผ)
    #   - Y[i, j] = y[i] (ะฟะพ ัััะพะบะฐะผ)
    #   ะญัะพ ะฝัะถะฝะพ, ััะพะฑั ะผะพะถะฝะพ ะฑัะปะพ ัะฐัััะธัะฐัั Z ะดะปั ะบะฐะถะดะพะน ัะพัะบะธ (x, y).
    x, y = np.meshgrid(x_vals, y_vals)
    
    # 3) ะััะธัะปัะตะผ z = cos( sqrt(x^2 + y^2) )
    #   sqrt(x^2 + y^2) โ ััะพ ัะฐะดะธะฐะปัะฝะพะต ัะฐัััะพัะฝะธะต ะพั ะฝะฐัะฐะปะฐ ะบะพะพัะดะธะฝะฐั ะฒ 2D.
    z = np.cos(np.sqrt(x**2 + y**2))

    # ะะทะฒะปะตะบะฐะตะผ ะฟะพะปัะทะพะฒะฐัะตะปััะบะธะต ะฝะฐัััะพะนะบะธ ะธะท kwargs ะธะปะธ ะฟะพะดััะฐะฒะปัะตะผ ะทะฝะฐัะตะฝะธั ะฟะพ ัะผะพะปัะฐะฝะธั
    surface_params = kwargs.get('surface_params', {})
    layout_params = kwargs.get('layout_params', {})
    title = kwargs.get('title', 'Cosine Function 3D Surface Plot')
    scene = kwargs.get('scene', dict(
        xaxis_title='X Axis',
        yaxis_title='Y Axis',
        zaxis_title='Z Axis',
        aspectmode='cube',
    ))
    margin = kwargs.get('margin', dict(l=0, r=0, b=0, t=0))
    
    # 4) ะกะพะทะดะฐะตะผ ัะธะณััั (Figure) ั ะพะดะฝะธะผ ะพะฑัะตะบัะพะผ Surface
    #   go.Figure(...) โ ััะพ ะฑะฐะทะพะฒัะน ะพะฑัะตะบั ะณัะฐัะธะบะฐ ะฒ Plotly, ัะพะดะตัะถะฐัะธะน ะฝะฐะฑะพั ะดะฐะฝะฝัั (data) ะธ ะผะฐะบะตั (layout).
    #   go.Surface(...) โ ััะพ 3D-ะฟะพะฒะตััะฝะพััั, ะฟะพัััะพะตะฝะฝะฐั ะฟะพ ะผะฐััะธะฒะฐะผ x, y, z.
    #   'colorscale' โ ะฟะฐัะฐะผะตัั, ะบะพัะพััะน ะพัะฒะตัะฐะตั ะทะฐ ัะฒะตัะพะฒัั ะฟะฐะปะธััั.
    #   ะะธะถะต ัััะฐะฝะพะฒะปะตะฝ ะบะฐััะพะผะฝัะน ะณัะฐะดะธะตะฝั ะพั ัะฒะตัะปะพ-ัะพะทะพะฒะพะณะพ ะบ ัะฒะตัะปะพ-ะณะพะปัะฑะพะผั,
    #   ะตัะปะธ ะฟะพะปัะทะพะฒะฐัะตะปั ะฝะต ะฟะตัะตะดะฐะป ัะฒะพั ะฟะฐะปะธััั ะฒ surface_params.
    default_colorscale = [[0, 'rgb(255, 182, 193)'],  # ัะฒะตัะปะพ-ัะพะทะพะฒัะน
                          [1, 'rgb(173, 216, 230)']]  # ัะฒะตัะปะพ-ะณะพะปัะฑะพะน
    if 'colorscale' not in surface_params:
        surface_params['colorscale'] = default_colorscale
    
    fig = go.Figure(
        data=[
            go.Surface(
                x=x,   # ะะพะพัะดะธะฝะฐัั X
                y=y,   # ะะพะพัะดะธะฝะฐัั Y
                z=z,   # ะะพะพัะดะธะฝะฐัั Z (ะฒััะพัะฐ)
                **surface_params  # ะัะธะผะตะฝัะตะผ ะฒัะต ะฟะฐัะฐะผะตััั, ะบะพัะพััะต ะฟะตัะตะดะฐะป ะฟะพะปัะทะพะฒะฐัะตะปั
            )
        ]
    )

    # 5) ะะฐัััะฐะธะฒะฐะตะผ ะผะฐะบะตั (layout) ั ะฟะพะผะพััั update_layout
    #   update_layout ะฟะพะทะฒะพะปัะตั ะธะทะผะตะฝะธัั ะทะฐะณะพะปะพะฒะพะบ, ัะฐะทะผะตัั, ะพััััะฟั, ะพัะธ ะธ ั.ะด.
    #   scene โ ัะปะพะฒะฐัั, ัะพะดะตัะถะฐัะธะน ะฝะฐัััะพะนะบะธ 3D-ััะตะฝั (ะฝะฐะทะฒะฐะฝะธั ะพัะตะน, ัะตะถะธะผั ะพัะพะฑัะฐะถะตะฝะธั).
    #   margin โ ะพััััะฟั ะพั ะบัะฐัะฒ ะณัะฐัะธะบะฐ.
    fig.update_layout(
        title=title,
        scene=scene,
        margin=margin,
        **layout_params  # ะัะธะผะตะฝัะตะผ ะฒัะต ะดะพะฟะพะปะฝะธัะตะปัะฝัะต ะฟะฐัะฐะผะตััั ะดะปั layout, ะฟะตัะตะดะฐะฝะฝัะต ะฟะพะปัะทะพะฒะฐัะตะปะตะผ
    )

    # 6) ะะพะบะฐะทัะฒะฐะตะผ ะธัะพะณะพะฒัะน ะณัะฐัะธะบ
    fig.show()

# ------------------------------------------------------------------------------
# ะะธะถะต โ ะบัะฐัะบะธะต ะพะฟะธัะฐะฝะธั ัะฟะพะผัะฝัััั ััะฝะบัะธะน ะธ ะพะฟัะธะน
# ------------------------------------------------------------------------------

"""
1) np.meshgrid(x, y)
   ะคัะฝะบัะธั ะธะท ะฑะธะฑะปะธะพัะตะบะธ NumPy, ะบะพัะพัะฐั ะฟัะธะฝะธะผะฐะตั ะพะดะฝะพะผะตัะฝัะต ะผะฐััะธะฒั x ะธ y
   ะธ ะฒะพะทะฒัะฐัะฐะตั ะดะฒัะผะตัะฝัะต ะผะฐััะธะฒั X ะธ Y. 
   X ะธ Y ะผะพะถะฝะพ ัะฐััะผะฐััะธะฒะฐัั ะบะฐะบ ะบะพะพัะดะธะฝะฐัะฝัั ัะตัะบั, 
   ะณะดะต X[i,j] ัะพะพัะฒะตัััะฒัะตั ะบะพะพัะดะธะฝะฐัะต x, ะฐ Y[i,j] โ ะบะพะพัะดะธะฝะฐัะต y.

2) go.Figure
   ะะปะฐัั ะธะท plotly.graph_objects. ะกะพะทะดะฐะตั ะพะฑัะตะบั ยซัะธะณัััยป, 
   ะฒ ะบะพัะพัะพะผ ััะฐะฝัััั ะดะฐะฝะฝัะต (data) ะธ ะผะฐะบะตั (layout) ะณัะฐัะธะบะฐ.

3) go.Surface
   ะะปะฐัั, ะพะฟะธััะฒะฐััะธะน 3D-ะฟะพะฒะตััะฝะพััั ะฒ Plotly. 
   ะัะธะฝะธะผะฐะตั ะผะฐััะธะฒั x, y, z, ะฐ ัะฐะบะถะต ะดััะณะธะต ะฟะฐัะฐะผะตััั (colorscale, opacity ะธ ั.ะด.). 
   ะัะฟะพะปัะทัะตััั ะดะปั ะพัะพะฑัะฐะถะตะฝะธั 3D-ะฟะพะฒะตััะฝะพััะตะน.

4) update_layout
   ะะตัะพะด ะพะฑัะตะบัะฐ Figure, ะบะพัะพััะน ะฟะพะทะฒะพะปัะตั ะพะฑะฝะพะฒะปััั ะฟะฐัะฐะผะตััั ะผะฐะบะตัะฐ (layout):
   ะทะฐะณะพะปะพะฒะบะธ, ะปะตะณะตะฝะดั, ัะฐะทะผะตัั, ััะธััั, ัะฒะตัะฐ ัะพะฝะฐ, ะพััััะฟั ะธ ะผะฝะพะณะพะต ะดััะณะพะต.

5) scene
   ะะปัั ะฒ layout, ะพัะฒะตัะฐััะธะน ะทะฐ 3D-ััะตะฝั. ะ ะฝะตะผ ะผะพะถะฝะพ ะฝะฐัััะฐะธะฒะฐัั:
   - xaxis_title, yaxis_title, zaxis_title โ ะฟะพะดะฟะธัะธ ะบ ะพััะผ
   - aspectmode (ะฝะฐะฟัะธะผะตั, 'cube') โ ัะตะถะธะผ ะฟัะพะฟะพััะธะน ะพัะตะน 
   - ะดััะณะธะต ะฟะฐัะฐะผะตััั (ัะฒะตั ะพัะตะน, ัะตัะบั ะธ ั.ะด.)

6) margin
   ะะปัั ะฒ layout, ะพัะฒะตัะฐััะธะน ะทะฐ ะพััััะฟั ะณัะฐัะธะบะฐ (ัะปะตะฒะฐ, ัะฟัะฐะฒะฐ, ัะฒะตััั, ัะฝะธะทั).
   margin=dict(l=0, r=0, t=0, b=0) ะพะทะฝะฐัะฐะตั, ััะพ ั ะณัะฐัะธะบะฐ ะฝะตั ะพััััะฟะพะฒ.
"""

# ------------------------------------------------------------------------------
# ะัะธะผะตั ะธัะฟะพะปัะทะพะฒะฐะฝะธั ััะฝะบัะธะธ plot_3d_surface
# ------------------------------------------------------------------------------
if __name__ == "__main__":
    # ะัะทะพะฒ ั ะฝะฐัััะพะนะบะพะน ะฟะฐะปะธััั ะธ ะฝะตะฑะพะปััะธะผะธ ะพััััะฟะฐะผะธ
    plot_3d_surface(
        title="ะะพั ะบะพัะธะฝััะฝะฐั ะฟะพะฒะตััะฝะพััั",
        surface_params={
            'colorscale': [[0, 'pink'], [1, 'lightblue']],  # ัะฒะพะน ะณัะฐะดะธะตะฝั
            'showscale': True,  # ะฟะพะบะฐะทะฐัั ัะฒะตัะพะฒัั ัะบะฐะปั
        },
        scene={
            'xaxis_title': 'X',
            'yaxis_title': 'Y',
            'zaxis_title': 'Z',
            'aspectmode': 'cube'
        },
        margin={'l': 10, 'r': 10, 'b': 10, 't': 30},
        layout_params={
            'width': 800,
            'height': 800
        }
    )
ะะพะดัะพะฑะฝะฐั ะธะฝััััะบัะธั ะดะปั ะฟะพะปัะทะพะฒะฐัะตะปั
ะฃััะฐะฝะพะฒะบะฐ ะฑะธะฑะปะธะพัะตะบ
ะฃะฑะตะดะธัะตัั, ััะพ ั ะฒะฐั ัััะฐะฝะพะฒะปะตะฝั numpy ะธ plotly. ะัะปะธ ะฝะตั, ัะพ ัััะฐะฝะพะฒะธัะต ะธั ะบะพะผะฐะฝะดะพะน:

bash
ะะพะฟะธัะพะฒะฐัั
pip install numpy plotly
ะะผะฟะพัั
ะ ะฝะฐัะฐะปะต ัะฐะนะปะฐ ะธะปะธ ะฝะพััะฑัะบะฐ ะธะผะฟะพััะธััะนัะต ะฝะตะพะฑัะพะดะธะผัะต ะผะพะดัะปะธ:

python
ะะพะฟะธัะพะฒะฐัั
import numpy as np
import plotly.graph_objects as go
ะะพะดะบะปััะตะฝะธะต ััะฝะบัะธะธ
ะกะบะพะฟะธััะนัะต ะบะพะด ััะฝะบัะธะธ plot_3d_surface ะฒ ัะฒะพะน ะฟัะพะตะบั ะธะปะธ ะฝะพััะฑัะบ.

ะัะทะพะฒ ััะฝะบัะธะธ
ะัะทะพะฒะธัะต ััะฝะบัะธั:

python
ะะพะฟะธัะพะฒะฐัั
plot_3d_surface()
ะะพ ัะผะพะปัะฐะฝะธั ะพะฝะฐ ะฝะฐัะธััะตั 3D-ะฟะพะฒะตััะฝะพััั ััะฝะบัะธะธ 
cos
โก
(
๐ฅ
2
+
๐ฆ
2
)
cos( 
x 
2
 +y 
2
 
โ
 ) ั ะทะฐะณะพะปะพะฒะบะพะผ Cosine Function 3D Surface Plot ะธ ะพััััะฟะฐะผะธ 0.

ะะฐัััะพะนะบะฐ ะฟะฐัะฐะผะตััะพะฒ
ะงัะพะฑั ะธะทะผะตะฝะธัั ัะฒะตัะพะฒัั ะฟะฐะปะธััั, ัะฐะทะผะตั, ะทะฐะณะพะปะพะฒะพะบ, ะฟะพะดะฟะธัะธ ะพัะตะน ะธ ั.ะด., ะฟะตัะตะดะฐะนัะต ัะพะพัะฒะตัััะฒัััะธะต ะฐัะณัะผะตะฝัั:

python
ะะพะฟะธัะพะฒะฐัั
plot_3d_surface(
    title="My 3D Cosine Surface",
    surface_params={
        'colorscale': [[0, 'pink'], [1, 'lightblue']],  # ะัะฐะดะธะตะฝั ะพั ัะพะทะพะฒะพะณะพ ะบ ะณะพะปัะฑะพะผั
        'showscale': True,  # ะะพะบะฐะทะฐัั ัะฒะตัะพะฒัั ัะบะฐะปั
    },
    scene={
        'xaxis_title': 'My X Axis',
        'yaxis_title': 'My Y Axis',
        'zaxis_title': 'My Z Axis',
        'aspectmode': 'cube'
    },
    margin={'l': 20, 'r': 20, 'b': 20, 't': 50},
    layout_params={
        'width': 900,
        'height': 900
    }
)
ะะตะทัะปััะฐั
ะะพัะปะต ะฒัะทะพะฒะฐ ััะฝะบัะธั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฟะพัััะพะธั ะธ ะพัะพะฑัะฐะทะธั ะธะฝัะตัะฐะบัะธะฒะฝัะน 3D-ะณัะฐัะธะบ.

ะั ะผะพะถะตัะต ะฒัะฐัะฐัั, ะฟัะธะฑะปะธะถะฐัั ะธ ะพัะดะฐะปััั ะตะณะพ ะผััะบะพะน (ะธะปะธ ัะฐัะฟะฐะดะพะผ).
ะฆะฒะตัะพะฒะฐั ัะบะฐะปะฐ ะฟะพะบะฐะทัะฒะฐะตั ัะพะพัะฒะตัััะฒะธะต ะฒััะพัั (ะทะฝะฐัะตะฝะธะน z) ัะฒะตัั ะฝะฐ ะฟะพะฒะตััะฝะพััะธ.
ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะฒั ะผะพะถะตัะต ะปะตะณะบะพ ะผะพะดะธัะธัะธัะพะฒะฐัั ะฒะธะด ะณัะฐัะธะบะฐ, ะฝะต ะผะตะฝัั ะพัะฝะพะฒะฝัั ะปะพะณะธะบั ะฟะพัััะพะตะฝะธั ะฟะพะฒะตััะฝะพััะธ, ะฐ ัะพะปัะบะพ ะฟะตัะตะดะฐะฒะฐั ะฝัะถะฝัะต ะฟะฐัะฐะผะตััั ะฒ **kwargs.






ะั ัะบะฐะทะฐะปะธ:
2. ะะฐะฟะธัะธัะต, ััะพ ะดะตะปะฐัั ัะปะตะดัััะธะต ััะฝะบัะธะธ ะธ ะพะฟัะธะธ:


*  meshgrid

*  Figure

*  Surface

*  update_layout

*  scene

*  margin
ะะฐัััะถะดะฐะปะฐ ะดะปั 5 ัะตะบัะฝะด
ะะพั ะบัะฐัะบะพะต ะพะฟะธัะฐะฝะธะต ะบะฐะถะดะพะน ะธะท ัะฟะพะผัะฝัััั ััะฝะบัะธะน ะธ ะพะฟัะธะน:

meshgrid
ะคัะฝะบัะธั ะธะท ะฑะธะฑะปะธะพัะตะบะธ NumPy, ะบะพัะพัะฐั ะฟัะธะฝะธะผะฐะตั ะพะดะฝะพะผะตัะฝัะต ะผะฐััะธะฒั ะบะพะพัะดะธะฝะฐั (ะฝะฐะฟัะธะผะตั, ะดะปั ะพัะตะน x ะธ y) ะธ ัะพะทะดะฐัั ะธะท ะฝะธั ะดะฒัะผะตัะฝัะต ะผะฐััะธะฒั, ะฟัะตะดััะฐะฒะปัััะธะต ะบะพะพัะดะธะฝะฐัะฝัั ัะตัะบั. ะญัะพ ัะดะพะฑะฝะพ ะดะปั ะฒััะธัะปะตะฝะธั ะทะฝะฐัะตะฝะธะน ััะฝะบัะธะธ ะฟะพ ะฒัะตะน ะฟะปะพัะบะพััะธ.

Figure
ะัะฝะพะฒะฝะพะน ะพะฑัะตะบั ะฒ Plotly, ะฟัะตะดััะฐะฒะปัััะธะน ะณัะฐัะธะบ. ะะฝ ัะพะดะตัะถะธั ะดะฐะฝะฝัะต (data) โ ะฝะฐะฑะพัั ะณัะฐัะธัะตัะบะธั ะพะฑัะตะบัะพะฒ (ะฝะฐะฟัะธะผะตั, ะปะธะฝะธะธ, ะฟะพะฒะตััะฝะพััะธ) โ ะธ ะฝะฐัััะพะนะบะธ ะผะฐะบะตัะฐ (layout), ัะฐะบะธะต ะบะฐะบ ะทะฐะณะพะปะพะฒะบะธ, ะพัะธ, ะพััััะฟั ะธ ะดั.

Surface
ะะปะฐัั ะธะท Plotly, ะฟัะตะดะฝะฐะทะฝะฐัะตะฝะฝัะน ะดะปั ัะพะทะดะฐะฝะธั 3D-ะฟะพะฒะตััะฝะพััะตะน. ะะฝ ะฟัะธะฝะธะผะฐะตั ะผะฐััะธะฒั ะบะพะพัะดะธะฝะฐั x, y, z ะธ ะดััะณะธะต ะฟะฐัะฐะผะตััั (ะฝะฐะฟัะธะผะตั, colorscale) ะดะปั ะฒะธะทัะฐะปะธะทะฐัะธะธ ััะฝะบัะธะธ ะฒ ัััั ะธะทะผะตัะตะฝะธัั.

update_layout
ะะตัะพะด ะพะฑัะตะบัะฐ Figure, ะฟะพะทะฒะพะปัััะธะน ะพะฑะฝะพะฒะปััั ะธ ะฝะฐัััะฐะธะฒะฐัั ะฒะฝะตัะฝะธะน ะฒะธะด ะณัะฐัะธะบะฐ. ะก ะตะณะพ ะฟะพะผะพััั ะผะพะถะฝะพ ะธะทะผะตะฝะธัั ะทะฐะณะพะปะพะฒะพะบ, ัะฐะทะผะตัั, ะพััััะฟั, ะฟะฐัะฐะผะตััั ะพัะตะน ะธ ะดััะณะธะต ัะปะตะผะตะฝัั ะผะฐะบะตัะฐ.

scene
ะะฟัะธั ะฒ ะฝะฐัััะพะนะบะฐั ะผะฐะบะตัะฐ (layout) Plotly, ะพัะฒะตัะฐััะฐั ะทะฐ ะฟะฐัะฐะผะตััั 3D-ััะตะฝั. ะะดะตัั ะทะฐะดะฐัััั ะฟะพะดะฟะธัะธ ะพัะตะน (xaxis_title, yaxis_title, zaxis_title), ัะตะถะธะผั ะพัะพะฑัะฐะถะตะฝะธั (ะฝะฐะฟัะธะผะตั, aspectmode) ะธ ะดััะณะธะต ัะฒะพะนััะฒะฐ, ะฒะปะธัััะธะต ะฝะฐ ะฒะฝะตัะฝะธะน ะฒะธะด 3D-ะณัะฐัะธะบะฐ.

margin
ะะฐัะฐะผะตัั ะฒ layout, ะบะพัะพััะน ะพะฟัะตะดะตะปัะตั ะพััััะฟั ะณัะฐัะธะบะฐ ะพั ะบัะฐัะฒ ะบะพะฝัะตะนะฝะตัะฐ. ะะฑััะฝะพ ะทะฐะดะฐัััั ะฒ ะฒะธะดะต ัะปะพะฒะฐัั ั ะบะปััะฐะผะธ l, r, t, b (ะพััััะฟั ัะปะตะฒะฐ, ัะฟัะฐะฒะฐ, ัะฒะตััั ะธ ัะฝะธะทั ัะพะพัะฒะตัััะฒะตะฝะฝะพ) ะดะปั ัะพัะฝะพะน ะฝะฐัััะพะนะบะธ ัะฐัะฟะพะปะพะถะตะฝะธั ะณัะฐัะธะบะฐ.






ะั ัะบะฐะทะฐะปะธ:

3. ะัััะฝะธัะต, ะบะฐะบะพะน ะฟะฐัะฐะผะตัั ะพัะฒะตัะฐะตั ะทะฐ ะฝะฐัััะพะนะบั ัะฒะตัะพะฒะพะน ะฟะฐะปะธััั ะณัะฐัะธะบะฐ? ะะทะผะตะฝะธัะต ะบะพะด ัะฐะบ, ััะพะฑั ะฟะฐะปะธััะฐ ะฑัะปะฐ ะพั ัะฒะตัะปะพ-ัะพะทะพะฒะพะณะพ ะดะพ ัะฒะตัะปะพ-ะณะพะปัะฑะพะณะพ.
ะะฐัััะถะดะฐะปะฐ ะดะปั 8 ัะตะบัะฝะด
ะะฐัะฐะผะตัั, ะพัะฒะตัะฐััะธะน ะทะฐ ะฝะฐัััะพะนะบั ัะฒะตัะพะฒะพะน ะฟะฐะปะธััั ะฒ ะดะฐะฝะฝะพะผ ะบะพะดะต โ ััะพ colorscale. ะะฝ ะทะฐะดะฐะตััั ะฒะฝัััะธ ะพะฑัะตะบัะฐ go.Surface ะธ ะพะฟัะตะดะตะปัะตั, ะบะฐะบะธะผ ะพะฑัะฐะทะพะผ ะทะฝะฐัะตะฝะธั ััะฝะบัะธะธ ะฟัะตะพะฑัะฐะทััััั ะฒ ัะฒะตัะฐ ะฝะฐ ะณัะฐัะธะบะต.

ะงัะพะฑั ะทะฐะดะฐัั ะณัะฐะดะธะตะฝั ะพั ัะฒะตัะปะพ-ัะพะทะพะฒะพะณะพ ะดะพ ัะฒะตัะปะพ-ะณะพะปัะฑะพะณะพ, ะผะพะถะฝะพ ัััะฐะฝะพะฒะธัั ะฟะฐัะฐะผะตัั colorscale ัะปะตะดัััะธะผ ะพะฑัะฐะทะพะผ:

python
ะะพะฟะธัะพะฒะฐัั
colorscale = [[0, 'rgb(255,182,193)'],  # ัะฒะตัะปะพ-ัะพะทะพะฒัะน
              [1, 'rgb(173,216,230)']]  # ัะฒะตัะปะพ-ะณะพะปัะฑะพะน
ะะธะถะต ะฟัะธะฒะตะดะตะฝ ะธะทะผะตะฝะตะฝะฝัะน ััะฐะณะผะตะฝั ะบะพะดะฐ ั ััะตัะพะผ ะฝะพะฒะพะณะพ ะฟะฐัะฐะผะตััะฐ:

python
ะะพะฟะธัะพะฒะฐัั
import numpy as np
import plotly.graph_objects as go

def plot_3d_surface():
    # ะกะพะทะดะฐะตะผ ะผะฐััะธะฒั ะบะพะพัะดะธะฝะฐั x ะธ y ะฒ ะดะธะฐะฟะฐะทะพะฝะต ะพั -10 ะดะพ 10 ั 200 ัะพัะบะฐะผะธ
    x_vals = np.linspace(-10, 10, 200)
    y_vals = np.linspace(-10, 10, 200)
    x, y = np.meshgrid(x_vals, y_vals)
    
    # ะััะธัะปัะตะผ z = cos(sqrt(x^2 + y^2))
    z = np.cos(np.sqrt(x**2 + y**2))
    
    # ะะฐะดะฐะตะผ colorscale ะพั ัะฒะตัะปะพ-ัะพะทะพะฒะพะณะพ ะดะพ ัะฒะตัะปะพ-ะณะพะปัะฑะพะณะพ
    custom_colorscale = [[0, 'rgb(255,182,193)'],  # ัะฒะตัะปะพ-ัะพะทะพะฒัะน
                         [1, 'rgb(173,216,230)']]  # ัะฒะตัะปะพ-ะณะพะปัะฑะพะน

    # ะกะพะทะดะฐะตะผ 3D-ัะธะณััะฐ ั ะฟะพะฒะตััะฝะพัััั ะธ ัััะฐะฝะฐะฒะปะธะฒะฐะตะผ colorscale
    fig = go.Figure(data=[go.Surface(z=z, x=x, y=y, colorscale=custom_colorscale)])
    
    # ะะฑะฝะพะฒะปัะตะผ ะผะฐะบะตั ะณัะฐัะธะบะฐ
    fig.update_layout(
        title='Cosine Function 3D Surface Plot',
        scene=dict(
            xaxis_title='X Axis',
            yaxis_title='Y Axis',
            zaxis_title='Z Axis',
            aspectmode='cube',
        ),
        margin=dict(l=0, r=0, b=0, t=0)
    )
    
    # ะัะพะฑัะฐะถะฐะตะผ ะณัะฐัะธะบ
    fig.show()

plot_3d_surface()
ะ ััะพะผ ะฟัะธะผะตัะต ะฟะฐัะฐะผะตัั colorscale ะฒะฝัััะธ go.Surface ะทะฐะดะฐะตััั ัะฐะฒะฝัะผ ัะฟะธัะบั, ะณะดะต ะฟะตัะฒะฐั ะฟะพะทะธัะธั (0) ัะพะพัะฒะตัััะฒัะตั ัะฒะตัะปะพ-ัะพะทะพะฒะพะผั ัะฒะตัั, ะฐ ะฒัะพัะฐั (1) โ ัะฒะตัะปะพ-ะณะพะปัะฑะพะผั, ััะพ ะทะฐะดะฐะตั ะณัะฐะดะธะตะฝั ะผะตะถะดั ััะธะผะธ ะดะฒัะผั ัะฒะตัะฐะผะธ.






ะั ัะบะฐะทะฐะปะธ:

4. ะะทะผะตะฝะธัะต ััะฝะบัะธั ัะฐะบ, ััะพะฑั ะพะฝะฐ ะผะพะณะปะฐ ะฟะพะปััะฐัั ะปัะฑัะต ะฟะฐัะฐะผะตััั ะฝะฐัััะพะนะบะธ ะณัะฐัะธะบะพะฒ ัะตัะตะท kwargs. ะญัะพ ะฟะพะทะฒะพะปะธั ะฟะพะปัะทะพะฒะฐัะตะปัะผ ะณะธะฑะบะพ ะฝะฐัััะฐะธะฒะฐัั ะฟะฐัะฐะผะตััั ะณัะฐัะธะบะฐ.

...ะ ะฝะฐะฟะธัะธัะต ะฟะพะดัะพะฑะฝัั ะธะฝััััะบัะธั ะดะปั ะฟะพะปัะทะพะฒะฐัะตะปั ััะพะน ััะฝะบัะธะธ๐
ะะฐัััะถะดะฐะปะฐ ะดะปั 21 ัะตะบัะฝะด
ะะธะถะต ะฟัะธะฒะตะดัะฝ ะธะทะผะตะฝัะฝะฝัะน ะบะพะด ััะฝะบัะธะธ, ะบะพัะพัะฐั ัััะพะธั 3D-ะณัะฐัะธะบ ะธ ะฟัะธะฝะธะผะฐะตั ะฟัะพะธะทะฒะพะปัะฝัะต ะธะผะตะฝะพะฒะฐะฝะฝัะต ะฟะฐัะฐะผะตััั ัะตัะตะท **kwargs. ะญัะพ ะฟะพะทะฒะพะปัะตั ะฟะพะปัะทะพะฒะฐัะตะปั ะณะธะฑะบะพ ะฝะฐัััะฐะธะฒะฐัั ะบะฐะบ ะฟะฐัะฐะผะตััั ัะฐะผะพะน ะฟะพะฒะตััะฝะพััะธ, ัะฐะบ ะธ ะผะฐะบะตัะฐ ะณัะฐัะธะบะฐ.

python
ะะพะฟะธัะพะฒะฐัั
import numpy as np
import plotly.graph_objects as go

def plot_3d_surface(**kwargs):
    """
    ะกััะพะธั ะธะฝัะตัะฐะบัะธะฒะฝัะน 3D-ะณัะฐัะธะบ ะฟะพะฒะตััะฝะพััะธ ััะฝะบัะธะธ z = cos(sqrt(x^2 + y^2)) ั ะฟะพะผะพััั Plotly.

    ะะฐัะฐะผะตััั:
    ----------
    **kwargs : dict
        ะะพะฟะพะปะฝะธัะตะปัะฝัะต ะธะผะตะฝะพะฒะฐะฝะฝัะต ะฟะฐัะฐะผะตััั ะดะปั ะฝะฐัััะพะนะบะธ ะณัะฐัะธะบะฐ. ะะพะทะผะพะถะฝัะต ะบะปััะธ:
        
        - surface_params : dict
            ะกะปะพะฒะฐัั ะฟะฐัะฐะผะตััะพะฒ ะดะปั ะพะฑัะตะบัะฐ go.Surface.
            ะะฐะฟัะธะผะตั:
                {'colorscale': [[0, 'pink'], [1, 'lightblue']], 'showscale': True}
            ะัะปะธ ะฝะต ัะบะฐะทะฐะฝ, ะธัะฟะพะปัะทัะตััั ะณัะฐะดะธะตะฝั ะพั ัะฒะตัะปะพ-ัะพะทะพะฒะพะณะพ ะดะพ ัะฒะตัะปะพ-ะณะพะปัะฑะพะณะพ.
            
        - layout_params : dict
            ะกะปะพะฒะฐัั ะดะพะฟะพะปะฝะธัะตะปัะฝัั ะฟะฐัะฐะผะตััะพะฒ ะดะปั ะผะฐะบะตัะฐ ะณัะฐัะธะบะฐ (layout).
            ะะฐะฟัะธะผะตั:
                {'width': 800, 'height': 800}
                
        - title : str
            ะะฐะณะพะปะพะฒะพะบ ะณัะฐัะธะบะฐ. ะะพ ัะผะพะปัะฐะฝะธั: "Cosine Function 3D Surface Plot".
            
        - scene : dict
            ะกะปะพะฒะฐัั ะฟะฐัะฐะผะตััะพะฒ 3D-ััะตะฝั, ะทะฐะดะฐััะธั ะฟะพะดะฟะธัะธ ะพัะตะน ะธ ัะตะถะธะผ ะพัะพะฑัะฐะถะตะฝะธั.
            ะะฐะฟัะธะผะตั:
                {'xaxis_title': 'X Axis', 'yaxis_title': 'Y Axis', 'zaxis_title': 'Z Axis', 'aspectmode': 'cube'}
                
        - margin : dict
            ะกะปะพะฒะฐัั ะพััััะฟะพะฒ ะณัะฐัะธะบะฐ ะพั ะบัะฐัะฒ ะบะพะฝัะตะนะฝะตัะฐ.
            ะะฐะฟัะธะผะตั:
                {'l': 10, 'r': 10, 'b': 10, 't': 50}

    ะัะธะผะตั ะธัะฟะพะปัะทะพะฒะฐะฝะธั:
    ---------------------
    plot_3d_surface(
        title="ะะพะน 3D-ะณัะฐัะธะบ ะบะพัะธะฝััะฐ",
        surface_params={'colorscale': [[0, 'pink'], [1, 'lightblue']], 'showscale': True},
        scene={'xaxis_title': 'X', 'yaxis_title': 'Y', 'zaxis_title': 'Z', 'aspectmode': 'cube'},
        margin={'l': 10, 'r': 10, 'b': 10, 't': 50},
        layout_params={'width': 800, 'height': 800}
    )

    ะะตะทัะปััะฐั:
    ---------
    ะคัะฝะบัะธั ัะพะทะดะฐัั ะธ ะพัะพะฑัะฐะถะฐะตั ะธะฝัะตัะฐะบัะธะฒะฝัะน 3D-ะณัะฐัะธะบ, ะบะพัะพััะน ะผะพะถะฝะพ ะฒัะฐัะฐัั, ะผะฐัััะฐะฑะธัะพะฒะฐัั ะธ ะธััะปะตะดะพะฒะฐัั.
    """

    # ะะตะฝะตัะธััะตะผ ะพะดะฝะพะผะตัะฝัะต ะผะฐััะธะฒั ะทะฝะฐัะตะฝะธะน ะดะปั ะพัะตะน x ะธ y
    x_vals = np.linspace(-10, 10, 200)
    y_vals = np.linspace(-10, 10, 200)
    
    # ะคัะฝะบัะธั np.meshgrid ัะพะทะดะฐะตั ะดะฒัะผะตัะฝัั ัะตัะบั ะบะพะพัะดะธะฝะฐั ะธะท x_vals ะธ y_vals.
    # x ะธ y โ ะดะฒัะผะตัะฝัะต ะผะฐััะธะฒั, ัะพะดะตัะถะฐัะธะต ะบะพะพัะดะธะฝะฐัั ัะพัะตะบ ะฝะฐ ะฟะปะพัะบะพััะธ.
    x, y = np.meshgrid(x_vals, y_vals)
    
    # ะััะธัะปัะตะผ ะทะฝะฐัะตะฝะธะต ััะฝะบัะธะธ z = cos(sqrt(x^2 + y^2))
    z = np.cos(np.sqrt(x**2 + y**2))
    
    # ะะฝะฐัะตะฝะธั ะฟะพ ัะผะพะปัะฐะฝะธั ะดะปั ะฟะฐัะฐะผะตััะพะฒ
    default_surface_params = {'colorscale': [[0, 'rgb(255,182,193)'], [1, 'rgb(173,216,230)']]}  # ะพั ัะฒะตัะปะพ-ัะพะทะพะฒะพะณะพ ะบ ัะฒะตัะปะพ-ะณะพะปัะฑะพะผั
    default_layout_params = {}
    default_title = 'Cosine Function 3D Surface Plot'
    default_scene = {
        'xaxis_title': 'X Axis',
        'yaxis_title': 'Y Axis',
        'zaxis_title': 'Z Axis',
        'aspectmode': 'cube'
    }
    default_margin = {'l': 0, 'r': 0, 'b': 0, 't': 0}
    
    # ะะทะฒะปะตะบะฐะตะผ ะฟะฐัะฐะผะตััั ะธะท kwargs, ะตัะปะธ ะพะฝะธ ะทะฐะดะฐะฝั ะฟะพะปัะทะพะฒะฐัะตะปะตะผ, ะธะฝะฐัะต ะธัะฟะพะปัะทัะตะผ ะทะฝะฐัะตะฝะธั ะฟะพ ัะผะพะปัะฐะฝะธั
    surface_params = kwargs.get('surface_params', default_surface_params)
    layout_params = kwargs.get('layout_params', default_layout_params)
    title = kwargs.get('title', default_title)
    scene = kwargs.get('scene', default_scene)
    margin = kwargs.get('margin', default_margin)
    
    # ะกะพะทะดะฐะตะผ ัะธะณััั (Figure) ั ะพะฑัะตะบัะพะผ Surface.
    # go.Surface ะพัะฒะตัะฐะตั ะทะฐ ะฟะพัััะพะตะฝะธะต 3D-ะฟะพะฒะตััะฝะพััะธ, ะฐ ะฟะฐัะฐะผะตัั colorscale ะทะฐะดะฐะตั ัะฒะตัะพะฒัั ะฟะฐะปะธััั.
    fig = go.Figure(
        data=[go.Surface(x=x, y=y, z=z, **surface_params)]
    )
    
    # update_layout ะฝะฐัััะฐะธะฒะฐะตั ะผะฐะบะตั (layout) ะณัะฐัะธะบะฐ: ะทะฐะณะพะปะพะฒะพะบ, ะพััััะฟั, ะฝะฐัััะพะนะบะธ 3D-ััะตะฝั ะธ ะดััะณะธะต ะฟะฐัะฐะผะตััั.
    fig.update_layout(
        title=title,
        scene=scene,
        margin=margin,
        **layout_params
    )
    
    # ะัะพะฑัะฐะถะฐะตะผ ะณัะฐัะธะบ
    fig.show()

# ะัะธะผะตั ะธัะฟะพะปัะทะพะฒะฐะฝะธั ััะฝะบัะธะธ ั ะฝะฐัััะพะนะบะฐะผะธ ัะตัะตะท kwargs
if __name__ == '__main__':
    plot_3d_surface(
        title="ะะพะน ะบะฐััะพะผะฝัะน 3D-ะณัะฐัะธะบ",
        surface_params={'colorscale': [[0, 'pink'], [1, 'lightblue']], 'showscale': True},
        scene={'xaxis_title': 'ะัั X', 'yaxis_title': 'ะัั Y', 'zaxis_title': 'ะัั Z', 'aspectmode': 'cube'},
        margin={'l': 10, 'r': 10, 'b': 10, 't': 50},
        layout_params={'width': 800, 'height': 800}
    )
ะะพะดัะพะฑะฝะฐั ะธะฝััััะบัะธั ะดะปั ะฟะพะปัะทะพะฒะฐัะตะปั ััะฝะบัะธะธ
ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน
ะฃะฑะตะดะธัะตัั, ััะพ ั ะฒะฐั ัััะฐะฝะพะฒะปะตะฝั ะฑะธะฑะปะธะพัะตะบะธ:

NumPy: ะดะปั ะฒััะธัะปะตะฝะธะน ะธ ัะฐะฑะพัั ั ะผะฐััะธะฒะฐะผะธ
Plotly: ะดะปั ัะพะทะดะฐะฝะธั ะธะฝัะตัะฐะบัะธะฒะฝัั ะณัะฐัะธะบะพะฒ
ะัะปะธ ะธั ะฝะตั, ัััะฐะฝะพะฒะธัะต ั ะฟะพะผะพััั ะบะพะผะฐะฝะดั:

bash
ะะพะฟะธัะพะฒะฐัั
pip install numpy plotly
ะะผะฟะพัั ะผะพะดัะปะตะน
ะ ะฝะฐัะฐะปะต ะฒะฐัะตะณะพ ัะบัะธะฟัะฐ ะธะปะธ Jupyter Notebook ะธะผะฟะพััะธััะนัะต ะฝะตะพะฑัะพะดะธะผัะต ะผะพะดัะปะธ:

python
ะะพะฟะธัะพะฒะฐัั
import numpy as np
import plotly.graph_objects as go
ะะพะฟะธัะพะฒะฐะฝะธะต ััะฝะบัะธะธ
ะกะบะพะฟะธััะนัะต ะฟัะธะฒะตะดัะฝะฝัั ะฒััะต ััะฝะบัะธั plot_3d_surface ะฒ ะฒะฐั ะฟัะพะตะบั.

ะัะทะพะฒ ััะฝะบัะธะธ
ะัะทะพะฒะธัะต ััะฝะบัะธั plot_3d_surface() ะฑะตะท ะฟะฐัะฐะผะตััะพะฒ ะดะปั ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะฝะฐัััะพะตะบ ะฟะพ ัะผะพะปัะฐะฝะธั:

python
ะะพะฟะธัะพะฒะฐัั
plot_3d_surface()
ะะธะฑะพ ะฟะตัะตะดะฐะนัะต ะฝัะถะฝัะต ะฟะฐัะฐะผะตััั ะดะปั ะบะฐััะพะผะธะทะฐัะธะธ:

python
ะะพะฟะธัะพะฒะฐัั
plot_3d_surface(
    title="ะะพะน ะบะฐััะพะผะฝัะน 3D-ะณัะฐัะธะบ",
    surface_params={'colorscale': [[0, 'pink'], [1, 'lightblue']], 'showscale': True},
    scene={'xaxis_title': 'ะัั X', 'yaxis_title': 'ะัั Y', 'zaxis_title': 'ะัั Z', 'aspectmode': 'cube'},
    margin={'l': 10, 'r': 10, 'b': 10, 't': 50},
    layout_params={'width': 800, 'height': 800}
)
ะะฐัะฐะผะตััั ะฝะฐัััะพะนะบะธ ัะตัะตะท kwargs
ะคัะฝะบัะธั ะฟัะธะฝะธะผะฐะตั ัะปะตะดัััะธะต ะบะปััะธ ะฒ kwargs:

surface_params: ะฟะตัะตะดะฐะตััั ะฒ ะพะฑัะตะบั go.Surface. ะะพะทะฒะพะปัะตั ะฝะฐัััะฐะธะฒะฐัั ะฟะฐัะฐะผะตััั ะฟะพะฒะตััะฝะพััะธ, ัะฐะบะธะต ะบะฐะบ colorscale (ัะฒะตัะพะฒะฐั ะฟะฐะปะธััะฐ), opacity (ะฝะตะฟัะพะทัะฐัะฝะพััั) ะธ ั.ะด.
layout_params: ะดะพะฟะพะปะฝะธัะตะปัะฝัะต ะฟะฐัะฐะผะตััั ะดะปั ะผะฐะบะตัะฐ (layout) ะณัะฐัะธะบะฐ, ะฝะฐะฟัะธะผะตั, ัะฐะทะผะตัั (width, height), ัะพะฝ, ััะธััั ะธ ะดััะณะธะต.
title: ัััะพะบะฐ ั ะทะฐะณะพะปะพะฒะบะพะผ ะณัะฐัะธะบะฐ.
scene: ัะปะพะฒะฐัั ั ะฝะฐัััะพะนะบะฐะผะธ 3D-ััะตะฝั, ะฒะบะปััะฐั ะฟะพะดะฟะธัะธ ะพัะตะน ะธ ัะตะถะธะผ ะฟัะพะฟะพััะธะน (ะฝะฐะฟัะธะผะตั, aspectmode).
margin: ัะปะพะฒะฐัั ั ะพััััะฟะฐะผะธ ะณัะฐัะธะบะฐ ะพั ะบัะฐัะฒ ะบะพะฝัะตะนะฝะตัะฐ (ะบะปััะธ l, r, b, t).
ะะตะทัะปััะฐั
ะะพัะปะต ะฒัะทะพะฒะฐ ััะฝะบัะธะธ ะพัะบัะพะตััั ะธะฝัะตัะฐะบัะธะฒะฝะพะต ะพะบะฝะพ (ะธะปะธ ะพัะพะฑัะฐะทะธััั ะณัะฐัะธะบ ะฒ Jupyter Notebook), ะณะดะต ะฒั ัะผะพะถะตัะต ะฒัะฐัะฐัั ะธ ะผะฐัััะฐะฑะธัะพะฒะฐัั 3D-ะณัะฐัะธะบ.

ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะดะฐะฝะฝะฐั ััะฝะบัะธั ะพะฑะตัะฟะตัะธะฒะฐะตั ะณะธะฑะบะพััั ะฝะฐัััะพะนะบะธ ะณัะฐัะธะบะฐ, ะฟะพะทะฒะพะปัั ะปะตะณะบะพ ะผะตะฝััั ะตะณะพ ะฒะฝะตัะฝะธะน ะฒะธะด ะฑะตะท ะฝะตะพะฑัะพะดะธะผะพััะธ ะธะทะผะตะฝััั ะธััะพะดะฝัะน ะบะพะด ะฟะพัััะพะตะฝะธั ะณัะฐัะธะบะฐ.






ะั ัะบะฐะทะฐะปะธ:
ะะฐะบ ัะฐะฑะพัะฐะตั groupby, pandas
ะะฐัััะถะดะฐะปะฐ ะดะปั 7 ัะตะบัะฝะด
ะะตัะพะด groupby ะฒ ะฑะธะฑะปะธะพัะตะบะต pandas ัะตะฐะปะธะทัะตั ะบะปะฐััะธัะตัะบะธะน ัะฐะฑะปะพะฝ ยซัะฐะทะฑะธัั-ะฟัะธะผะตะฝะธัั-ะพะฑัะตะดะธะฝะธััยป (split-apply-combine). ะญัะพ ะพะทะฝะฐัะฐะตั, ััะพ ะดะฐะฝะฝัะต:

ะะฐะทะฑะธะฒะฐัััั ะฝะฐ ะณััะฟะฟั ะฟะพ ะทะฝะฐัะตะฝะธั ะพะดะฝะพะณะพ ะธะปะธ ะฝะตัะบะพะปัะบะธั ััะพะปะฑัะพะฒ (ะธะปะธ ะฟะพ ะฟัะพะธะทะฒะพะปัะฝะพะน ััะฝะบัะธะธ).
ะ ะบะฐะถะดะพะน ะณััะฟะฟะต ะฟัะธะผะตะฝัะตััั ััะฝะบัะธั โ ะฐะณัะตะณะธััััะฐั (ะฝะฐะฟัะธะผะตั, ััะผะผะฐ, ััะตะดะฝะตะต, ัััััะธะบ), ััะฐะฝััะพัะผะธััััะฐั (ะฝะฐะฟัะธะผะตั, ะฝะพัะผะฐะปะธะทะฐัะธั) ะธะปะธ ะดััะณะฐั.
ะะตะทัะปััะฐัั ะพะฑัะตะดะธะฝััััั ะฒ ะฝะพะฒัั ััััะบัััั (DataFrame ะธะปะธ Series).
ะัะฝะพะฒะฝัะต ััะฐะฟั ัะฐะฑะพัั groupby:
Split (ะะฐะทะฑะธะฒะบะฐ):
ะัะฑะธัะฐะตััั ััะพะปะฑะตั ะธะปะธ ะฝะตัะบะพะปัะบะพ ััะพะปะฑัะพะฒ, ะฟะพ ะบะพัะพััะผ ะดะฐะฝะฝัะต ะฑัะดัั ะณััะฟะฟะธัะพะฒะฐัััั. Pandas ัะพะทะดะฐะตั ะพะฑัะตะบัั ะณััะฟะฟ, ะฒ ะบะฐะถะดะพะผ ะธะท ะบะพัะพััั ัะพะดะตัะถะฐััั ะฒัะต ัััะพะบะธ DataFrame, ะดะปั ะบะพัะพััั ะทะฝะฐัะตะฝะธะต ะณััะฟะฟะธััััะตะณะพ ััะพะปะฑัะฐ ัะพะฒะฟะฐะดะฐะตั.

Apply (ะัะธะผะตะฝะตะฝะธะต):
ะะฐ ะบะฐะถะดัั ะณััะฟะฟั ะผะพะถะฝะพ ะฟัะธะผะตะฝะธัั ััะฝะบัะธั โ ะฐะณัะตะณะธัััััั (ะฝะฐะฟัะธะผะตั, sum(), mean(), count()), ััะฐะฝััะพัะผะฐัะธะพะฝะฝัั (ะฝะฐะฟัะธะผะตั, transform()) ะธะปะธ ะดะฐะถะต ะฟัะพะธะทะฒะพะปัะฝัั ะฟะพะปัะทะพะฒะฐัะตะปััะบัั ััะฝะบัะธั ัะตัะตะท apply(). ะญัะพ ะฟะพะทะฒะพะปัะตั ะฒััะธัะปะธัั ะฝัะถะฝัะต ััะฐัะธััะธะบะธ ะธะปะธ ะธะทะผะตะฝะธัั ะดะฐะฝะฝัะต ะฒะฝัััะธ ะบะฐะถะดะพะน ะณััะฟะฟั.

Combine (ะะฑัะตะดะธะฝะตะฝะธะต):
ะะพัะปะต ะฟัะธะผะตะฝะตะฝะธั ััะฝะบัะธะธ ัะตะทัะปััะฐัั ัะพะฑะธัะฐัััั ะฒะผะตััะต ะฒ ะฒะธะดะต ะฝะพะฒะพะณะพ ะพะฑัะตะบัะฐ (ะฝะฐะฟัะธะผะตั, DataFrame ะธะปะธ Series), ะณะดะต ะบะฐะถะดะฐั ัััะพะบะฐ (ะธะปะธ ััะพะปะฑะตั) ัะพะพัะฒะตัััะฒัะตั ะณััะฟะฟะต, ะฐ ะทะฝะฐัะตะฝะธั โ ัะตะทัะปััะฐัั ะฐะณัะตะณะธัะพะฒะฐะฝะธั ะธะปะธ ััะฐะฝััะพัะผะฐัะธะธ.

ะัะธะผะตั ะธัะฟะพะปัะทะพะฒะฐะฝะธั:
python
ะะพะฟะธัะพะฒะฐัั
import pandas as pd

# ะัะธะผะตั DataFrame
data = {
    'ะะฐัะตะณะพัะธั': ['A', 'B', 'A', 'B', 'A', 'B'],
    'ะะฝะฐัะตะฝะธะต': [10, 20, 15, 25, 10, 30]
}
df = pd.DataFrame(data)

# ะััะฟะฟะธััะตะผ ะฟะพ ััะพะปะฑัั 'ะะฐัะตะณะพัะธั' ะธ ะฒััะธัะปัะตะผ ััะผะผั ะฟะพ 'ะะฝะฐัะตะฝะธะต'
grouped = df.groupby('ะะฐัะตะณะพัะธั')
result = grouped['ะะฝะฐัะตะฝะธะต'].sum()

print(result)
ะ ะดะฐะฝะฝะพะผ ะฟัะธะผะตัะต:

ะะฐะทะฑะธะฒะบะฐ: ัััะพะบะธ DataFrame ัะฐะทะดะตะปััััั ะฝะฐ ะดะฒะต ะณััะฟะฟั ะฟะพ ะทะฝะฐัะตะฝะธั ััะพะปะฑัะฐ ะะฐัะตะณะพัะธั ('A' ะธ 'B').
ะัะธะผะตะฝะตะฝะธะต: ะดะปั ะบะฐะถะดะพะน ะณััะฟะฟั ััะธัะฐะตััั ััะผะผะฐ ะทะฝะฐัะตะฝะธะน ะฒ ััะพะปะฑัะต ะะฝะฐัะตะฝะธะต.
ะะฑัะตะดะธะฝะตะฝะธะต: ะฟะพะปััะตะฝะฝัะน ัะตะทัะปััะฐั โ Series, ะณะดะต ะธะฝะดะตะบัะพะผ ัะฒะปััััั ะณััะฟะฟั ('A' ะธ 'B'), ะฐ ะทะฝะฐัะตะฝะธัะผะธ โ ัะพะพัะฒะตัััะฒัััะธะต ััะผะผั.
ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, groupby ะฟะพะทะฒะพะปัะตั ัะดะพะฑะฝะพ ะธ ัััะตะบัะธะฒะฝะพ ะฒัะฟะพะปะฝััั ะณััะฟะฟะพะฒัะต ะฒััะธัะปะตะฝะธั ะฝะฐะด ะดะฐะฝะฝัะผะธ ะฒ pandas.






ะั ัะบะฐะทะฐะปะธ:
ะะพะถะฝะพ ะปะธ ะฒัะฒะตััะธ ัะณััะฟะฟะธัะพะฒะฐะฝะฝัั ัะฐะฑะปะธัั, ะบะฐะบ ััะพ ัะตะฐะปะธะทะพะฒะฐะฝะพ ะฒ SQL, ะธะปะธ ะผะพะถะฝะพ ัะพะปัะบะพ ะฟัะธะผะตะฝััั ะฐะณัะตะณะณะธััััะธะต ััะฝะบัะธะธ 
ะะฐ, ะฒ pandas ะผะพะถะฝะพ ะฒัะฒะตััะธ ัะณััะฟะฟะธัะพะฒะฐะฝะฝัะต ะดะฐะฝะฝัะต ะฒ ะฒะธะดะต ัะฐะฑะปะธัั, ะบะฐะบ ััะพ ัะตะฐะปะธะทะพะฒะฐะฝะพ ะฒ SQL. ะะปั ััะพะณะพ ะดะพััะฐัะพัะฝะพ ะฟัะพััะพ ะฒัะฟะพะปะฝะธัั ะณััะฟะฟะธัะพะฒะบั ั ะฝัะถะฝัะผะธ ััะพะปะฑัะฐะผะธ, ะฑะตะท ะฟัะธะผะตะฝะตะฝะธั ะฐะณัะตะณะธััััะธั ััะฝะบัะธะน. ะญัะพ ะฑัะดะตั ัะบะฒะธะฒะฐะปะตะฝัะฝะพ ะฒัะฒะพะดั ะดะฐะฝะฝัั, ัะณััะฟะฟะธัะพะฒะฐะฝะฝัั ะฟะพ ะพะฟัะตะดะตะปัะฝะฝะพะผั ััะพะปะฑัั, ะบะฐะบ ะฒ SQL-ะทะฐะฟัะพัะต ั `GROUP BY`. ะ ัะฐะบะพะผ ัะปััะฐะต pandas ะฟะพะผะตัะฐะตั ะฒัะต ัััะพะบะธ ะฒะฝัััะธ ะบะฐะถะดะพะน ะณััะฟะฟั ะฒ ัะฒะพะธ ัะพะฑััะฒะตะฝะฝัะต ะทะฐะฟะธัะธ. ะัะธะผะตั: ```python import pandas as pd # ะัะธะผะตั DataFrame data = { 'ะะฐัะตะณะพัะธั': ['A', 'B', 'A', 'B', 'A', 'B'], 'ะะฝะฐัะตะฝะธะต': [10, 20, 15, 25, 10, 30], 'ะะฟะธัะฐะฝะธะต': ['X', 'Y', 'Z', 'W', 'U', 'V'] } df = pd.DataFrame(data) # ะััะฟะฟะธััะตะผ ะฟะพ ััะพะปะฑัั 'ะะฐัะตะณะพัะธั', ะฒัะฒะพะดะธะผ ะณััะฟะฟะธัะพะฒะบั ะฑะตะท ะฟัะธะผะตะฝะตะฝะธั ะฐะณัะตะณะฐัะฝัั ััะฝะบัะธะน grouped = df.groupby('ะะฐัะตะณะพัะธั') print(grouped.get_group('A')) print(grouped.get_group('B')) ``` ะ ััะพะผ ะฟัะธะผะตัะต: - `groupby('ะะฐัะตะณะพัะธั')` ะณััะฟะฟะธััะตั ัััะพะบะธ DataFrame ะฟะพ ะบะฐัะตะณะพัะธัะผ. - ะะตัะพะด `get_group('A')` ะฒัะทะพะฒะตั ัััะพะบะธ, ะพัะฝะตััะฝะฝัะต ะบ ะบะฐัะตะณะพัะธะธ 'A'. - ะะตัะพะด `get_group('B')` ะฒัะทะพะฒะตั ัััะพะบะธ, ะพัะฝะตััะฝะฝัะต ะบ ะบะฐัะตะณะพัะธะธ 'B'. **ะะตะทัะปััะฐั** (ะดะปั ะบะฐะถะดะพะน ะณััะฟะฟั): ``` ะะฐัะตะณะพัะธั ะะฝะฐัะตะฝะธะต ะะฟะธัะฐะฝะธะต 0 A 10 X 2 A 15 Z 4 A 10 U ะะฐัะตะณะพัะธั ะะฝะฐัะตะฝะธะต ะะฟะธัะฐะฝะธะต 1 B 20 Y 3 B 25 W 5 B 30 V ``` ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะฒั ะผะพะถะตัะต ัะพะทะดะฐะฒะฐัั ัะฐะฑะปะธัั, ะณะดะต ะฒัะฒะพะดัััั ะทะฐะฟะธัะธ, ัะณััะฟะฟะธัะพะฒะฐะฝะฝัะต ะฟะพ ะพะดะฝะพะผั ะธะปะธ ะฝะตัะบะพะปัะบะธะผ ััะพะปะฑัะฐะผ, ะฑะตะท ะฟัะธะผะตะฝะตะฝะธั ะฐะณัะตะณะฐัะฝัั ััะฝะบัะธะน. ะขะฐะบะถะต, ะตัะปะธ ะฒะฐะผ ะฝัะถะฝะพ ะฟะพะปััะธัั ะฟะพะปะฝัะน ัะตะทัะปััะฐั ั ะณััะฟะฟะธัะพะฒะบะพะน ะธ ะพัะพะฑัะฐะถะตะฝะธะตะผ ะฒัะตั ัััะพะบ, ะฒั ะผะพะถะตัะต ะธัะฟะพะปัะทะพะฒะฐัั, ะฝะฐะฟัะธะผะตั, `apply()` ะธะปะธ `agg()` ั ะดะธะฝะฐะผะธัะตัะบะธะผะธ ััะฝะบัะธัะผะธ ะดะปั ะฑะพะปะตะต ัะปะพะถะฝัั ะผะฐะฝะธะฟัะปััะธะน: ```python # ะััะณะพะน ะฟัะธะผะตั - ะณััะฟะฟะธััะตะผ ะฟะพ ะบะฐัะตะณะพัะธัะผ ะธ ะฒัะฒะพะดะธะผ ะฒัะต ัััะพะบะธ ะฒ ะบะฐะถะดะพะน ะณััะฟะฟะต grouped = df.groupby('ะะฐัะตะณะพัะธั').apply(lambda x: x) print(grouped) ``` ะญัะพั ะบะพะด ะฑัะดะตั ะฒัะฒะพะดะธัั ะฒัั ัะฐะฑะปะธัั, ะณะดะต ัััะพะบะธ ะฑัะดัั ะดะปั ะบะฐะถะดะพะน ะธะท ะบะฐัะตะณะพัะธะธ. ะดะปั 16 ัะตะบัะฝะด
ะ pandas ะผะตัะพะด groupby ะฒะพะทะฒัะฐัะฐะตั ะพะฑัะตะบั ะณััะฟะฟะธัะพะฒะบะธ, ะบะพัะพััะน ัะฐะผ ะฟะพ ัะตะฑะต ะฝะต ัะฒะปัะตััั ะณะพัะพะฒะพะน ัะฐะฑะปะธัะตะน โ ะพะฝ ัะปัะถะธั ะดะปั ะฟะพัะปะตะดัััะตะณะพ ะฟัะธะผะตะฝะตะฝะธั ะฐะณัะตะณะธััััะธั, ััะฐะฝััะพัะผะฐัะธะพะฝะฝัั ะธะปะธ ะฟะพะปัะทะพะฒะฐัะตะปััะบะธั ััะฝะบัะธะน ะบ ะบะฐะถะดะพะน ะณััะฟะฟะต. ะญัะพ ะพัะปะธัะฐะตััั ะพั SQL, ะณะดะต ะทะฐะฟัะพั ั GROUP BY ััะฐะทั ะฒะพะทะฒัะฐัะฐะตั ัะตะทัะปััะฐั ะฒ ะฒะธะดะต ัะฐะฑะปะธัั ั ะพะดะฝะพะน ัััะพะบะพะน ะฝะฐ ะณััะฟะฟั (ะพะฑััะฝะพ ั ะฐะณัะตะณะธัะพะฒะฐะฝะฝัะผะธ ะทะฝะฐัะตะฝะธัะผะธ).

ะะดะฝะฐะบะพ ะตััั ะฝะตัะบะพะปัะบะพ ัะฟะพัะพะฑะพะฒ ะฟะพะปััะธัั ยซัะณััะฟะฟะธัะพะฒะฐะฝะฝัั ัะฐะฑะปะธััยป:

ะะณัะตะณะฐัะธั ั ะฟะพะผะพััั ะฐะณัะตะณะธััััะธั ััะฝะบัะธะน:
ะะฐะฟัะธะผะตั, ะฒั ะผะพะถะตัะต ะฟะพััะธัะฐัั ััะผะผั, ััะตะดะฝะตะต, ัะฟะธัะพะบ ะทะฝะฐัะตะฝะธะน ะธะปะธ ะฒัะฟะพะปะฝะธัั ะปัะฑัั ะดััะณัั ะพะฟะตัะฐัะธั ะดะปั ะบะฐะถะดะพะน ะณััะฟะฟั.

python
ะะพะฟะธัะพะฒะฐัั
df_grouped = df.groupby('column').agg({'another_column': 'sum'}).reset_index()
ะญัะพ ะฐะฝะฐะปะพะณะธัะฝะพ SQL-ะทะฐะฟัะพัั ั ะฐะณัะตะณะฐัะฐะผะธ, ะธ ัะตะทัะปััะฐัะพะผ ะฑัะดะตั DataFrame ั ะพะดะฝะพะน ัััะพะบะพะน ะฝะฐ ะณััะฟะฟั.

ะัะธะผะตะฝะตะฝะธะต ััะฝะบัะธะธ, ะบะพัะพัะฐั ะฒะพะทะฒัะฐัะฐะตั DataFrame:
ะั ะผะพะถะตัะต ะธัะฟะพะปัะทะพะฒะฐัั ะผะตัะพะด .apply(), ััะพะฑั ะดะปั ะบะฐะถะดะพะน ะณััะฟะฟั ะฒะตัะฝััั, ะฝะฐะฟัะธะผะตั, ะฟะพะดัะฐะฑะปะธัั ะธะปะธ ะฟัะพะธะทะฒะพะปัะฝัั ััััะบัััั, ะฐ ะทะฐัะตะผ ะพะฑัะตะดะธะฝะธัั ัะตะทัะปััะฐัั.

python
ะะพะฟะธัะพะฒะฐัั
df_grouped = df.groupby('column').apply(lambda group: group)
ะขะฐะบะพะน ะฟะพะดัะพะด ะฒะตัะฝะตั ะพะฑัะตะบั, ะฒ ะบะพัะพัะพะผ ะบะฐะถะดะฐั ะณััะฟะฟะฐ ะฟัะตะดััะฐะฒะปะตะฝะฐ ะฒ ะฒะธะดะต DataFrame, ะฝะพ ะพะฝ ะฑัะดะตั ะธะผะตัั ะผะฝะพะณะพััะพะฒะฝะตะฒัะน ะธะฝะดะตะบั.

ะะพะปััะตะฝะธะต ัะปะพะฒะฐัั ะณััะฟะฟ:
ะัะปะธ ะฒะฐะผ ะฝัะถะฝะพ ะฟัะพััะพ ัะฒะธะดะตัั, ะบะฐะบะธะต ัััะพะบะธ ะพัะฝะพััััั ะบ ะบะฐะถะดะพะน ะณััะฟะฟะต, ะผะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ะฐััะธะฑัั .groups, ะบะพัะพััะน ะฒะพะทะฒัะฐัะฐะตั ัะปะพะฒะฐัั ั ะบะปััะฐะผะธ-ะณััะฟะฟะฐะผะธ ะธ ะธะฝะดะตะบัะฐะผะธ ัััะพะบ.

python
ะะพะฟะธัะพะฒะฐัั
groups_dict = df.groupby('column').groups
ะะพ ััะพ ะฝะต ัะพะฒัะตะผ ัะฐะฑะปะธัะฝะพะต ะฟัะตะดััะฐะฒะปะตะฝะธะต, ะฐ ะปะธัั ััััะบัััะฐ ะดะฐะฝะฝัั ะดะปั ะดะฐะปัะฝะตะนัะตะน ะพะฑัะฐะฑะพัะบะธ.

ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะฒ pandas ะฒั ะฝะต ยซะฒัะฒะพะดะธัะต ัะณััะฟะฟะธัะพะฒะฐะฝะฝัั ัะฐะฑะปะธััยป ะฝะฐะฟััะผัั ัะฐะบ, ะบะฐะบ ััะพ ะดะตะปะฐะตััั ะฒ SQL, ะฐ ัะฝะฐัะฐะปะฐ ะณััะฟะฟะธััะตัะต ะดะฐะฝะฝัะต, ะฐ ะทะฐัะตะผ ะฟัะธะผะตะฝัะตัะต ััะฝะบัะธะธ, ััะพะฑั ะฟะพะปััะธัั ะฝัะถะฝะพะต ะฟัะตะดััะฐะฒะปะตะฝะธะต ะดะฐะฝะฝัั. ะัะปะธ ััะตะฑัะตััั ะธะผะตะฝะฝะพ SQL-ะฟะพะดะพะฑะฝัะน ะฒัะฒะพะด, ะพะฑััะฝะพ ะฟัะธะผะตะฝัะตััั ะฐะณัะตะณะธัะพะฒะฐะฝะธะต ั ะฟะพัะปะตะดัััะธะผ ะฒัะทะพะฒะพะผ reset_index(), ััะพะฑั ะฟะพะปััะธัั DataFrame ั ะฟะปะพัะบะพะน ััััะบัััะพะน ัััะพะบ.






ะั ัะบะฐะทะฐะปะธ:
ะะฐะฟะธัะธ ะผะฝะต ะฟัะธะผะตั ะธัะฟะพะปัะทะพะฒะฐะฝะธั count ะธ groupby ะฒ ะพะดะฝะพะผ ะทะฐะฟัะพัะต
ะะฐัััะถะดะฐะปะฐ ะดะปั 8 ัะตะบัะฝะด
ะะธะถะต ะฟัะธะฒะตะดัะฝ ะฟัะธะผะตั ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะผะตัะพะดะพะฒ groupby ะธ count ะฒ ะพะดะฝะพะผ ะทะฐะฟัะพัะต. ะ ััะพะผ ะฟัะธะผะตัะต ะผั ะณััะฟะฟะธััะตะผ DataFrame ะฟะพ ััะพะปะฑัั ยซะะฐัะตะณะพัะธัยป ะธ ััะธัะฐะตะผ, ัะบะพะปัะบะพ ัััะพะบ ะฝะฐัะพะดะธััั ะฒ ะบะฐะถะดะพะน ะณััะฟะฟะต.

python
ะะพะฟะธัะพะฒะฐัั
import pandas as pd

# ะกะพะทะดะฐะตะผ DataFrame ั ะดะฐะฝะฝัะผะธ
data = {
    'ะะฐัะตะณะพัะธั': ['A', 'B', 'A', 'B', 'A', 'C', 'B'],
    'ะะฝะฐัะตะฝะธะต': [10, 20, 15, 25, 10, 30, 40]
}
df = pd.DataFrame(data)

# ะััะฟะฟะธััะตะผ ะฟะพ ััะพะปะฑัั 'ะะฐัะตะณะพัะธั' ะธ ััะธัะฐะตะผ ะบะพะปะธัะตััะฒะพ ะทะฐะฟะธัะตะน ะฒ ะบะฐะถะดะพะน ะณััะฟะฟะต
grouped = df.groupby('ะะฐัะตะณะพัะธั').count()

# ะกะฑัะฐััะฒะฐะตะผ ะธะฝะดะตะบั ะดะปั ะฟะพะปััะตะฝะธั ะฟะปะพัะบะพะน ัะฐะฑะปะธัั
result = grouped.reset_index()

print(result)
ะะพััะฝะตะฝะธะต:
df.groupby('ะะฐัะตะณะพัะธั') โ ะณััะฟะฟะธััะตั DataFrame ะฟะพ ััะพะปะฑัั ยซะะฐัะตะณะพัะธัยป.
.count() โ ะดะปั ะบะฐะถะดะพะน ะณััะฟะฟั ััะธัะฐะตั ะบะพะปะธัะตััะฒะพ ะฝะตะฟััััั ะทะฝะฐัะตะฝะธะน ะฒ ะบะฐะถะดะพะผ ััะพะปะฑัะต.
.reset_index() โ ะฟัะตะพะฑัะฐะทัะตั ะผะฝะพะณะพััะพะฒะฝะตะฒัะน ะธะฝะดะตะบั ะพะฑัะฐัะฝะพ ะฒ ะพะฑััะฝัะต ััะพะปะฑัั ะดะปั ัะดะพะฑะฝะพะณะพ ะพัะพะฑัะฐะถะตะฝะธั ัะตะทัะปััะฐัะฐ.
ะ ัะตะทัะปััะฐัะต ะฒั ะฟะพะปััะธัะต DataFrame, ะณะดะต ะดะปั ะบะฐะถะดะพะน ะบะฐัะตะณะพัะธะธ ัะบะฐะทะฐะฝะพ ะบะพะปะธัะตััะฒะพ ะทะฐะฟะธัะตะน (ะฒ ะดะฐะฝะฝะพะผ ัะปััะฐะต, ะบะพะปะธัะตััะฒะพ ัััะพะบ) ะฒ ะณััะฟะฟะต.






ะั ัะบะฐะทะฐะปะธ:
ะะฐะบ ะฒัะฒะตััะธ ััะพะปะฑะตั 
ะะฐัััะถะดะฐะปะฐ ะดะปั 11 ัะตะบัะฝะด
ะงัะพะฑั ะฒัะฒะตััะธ ััะพะปะฑะตั ะธะท DataFrame ะฒ pandas, ะผะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ะบะฒะฐะดัะฐัะฝัะต ัะบะพะฑะบะธ ั ะธะผะตะฝะตะผ ััะพะปะฑัะฐ ะฒ ะฒะธะดะต ัััะพะบะธ. ะะฐะฟัะธะผะตั:

python
ะะพะฟะธัะพะฒะฐัั
import pandas as pd

# ะกะพะทะดะฐะตะผ DataFrame ั ะดะฐะฝะฝัะผะธ
data = {
    'ะะฐัะตะณะพัะธั': ['A', 'B', 'A', 'B', 'A', 'C', 'B'],
    'ะะฝะฐัะตะฝะธะต': [10, 20, 15, 25, 10, 30, 40]
}
df = pd.DataFrame(data)

# ะัะฒะพะด ััะพะปะฑัะฐ "ะะฐัะตะณะพัะธั"
print(df['ะะฐัะตะณะพัะธั'])
ะญัะพ ะฒัะฒะตะดะตั ัะพะดะตัะถะธะผะพะต ััะพะปะฑัะฐ "ะะฐัะตะณะพัะธั". ะัะปะธ ะฒั ัะพัะธัะต ะฟะพะปััะธัั ััะพะปะฑะตั ะฒ ะฒะธะดะต ัะฟะธัะบะฐ, ะผะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ะผะตัะพะด tolist():

python
ะะพะฟะธัะพะฒะฐัั
ะบะฐัะตะณะพัะธะธ = df['ะะฐัะตะณะพัะธั'].tolist()
print(ะบะฐัะตะณะพัะธะธ)
ะขะฐะบะถะต, ะตัะปะธ ะธะผั ััะพะปะฑัะฐ ัะฒะปัะตััั ะบะพััะตะบัะฝัะผ ะธะดะตะฝัะธัะธะบะฐัะพัะพะผ Python, ะผะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ัะพัะตัะฝัั ะฝะพัะฐัะธั:

python
ะะพะฟะธัะพะฒะฐัั
print(df.ะะฐัะตะณะพัะธั)
ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะดะปั ะฒัะฒะพะดะฐ ะปัะฑะพะณะพ ััะพะปะฑัะฐ ะธะท DataFrame ะดะพััะฐัะพัะฝะพ ะพะฑัะฐัะธัััั ะบ ะฝะตะผั ัะตัะตะท df['ะะผัะกัะพะปะฑัะฐ'].






ะั ัะบะฐะทะฐะปะธ:
ะฏ ะฟััะฐััั ะฝะฐะฟะธัะฐัั df.head()['name]. 

ะ ัะตะผ ะผะพะถะตั ะฑััั ะฟัะพะฑะปะตะผะฐ 
ะะฐัััะถะดะฐะปะฐ ะดะปั 10 ัะตะบัะฝะด
ะกะบะพัะตะต ะฒัะตะณะพ, ะพัะธะฑะบะฐ ะฒะพะทะฝะธะบะฐะตั ะธะท-ะทะฐ ะพััััััะฒะธั ะทะฐะบััะฒะฐััะตะน ะบะฐะฒััะบะธ. ะะผะตััะพ

python
ะะพะฟะธัะพะฒะฐัั
df.head()['name]
ะฝัะถะฝะพ ะฝะฐะฟะธัะฐัั

python
ะะพะฟะธัะพะฒะฐัั
df.head()['name']
ัะพ ะตััั ะดะพะฑะฐะฒะธัั ะทะฐะบััะฒะฐัััั ะบะฐะฒััะบั ะฟะพัะปะต name.






ะั ัะบะฐะทะฐะปะธ:
#%%
grouped = business.groupby(["city"]).count()
grouped.sort_values(by='business_id', ascending=False, inplace=True)
grouped.head()['city']
# grouped.sort_values(by=business['business_id'].value_counts(), inplace=True)KeyError: 'city'
ะะฐัััะถะดะฐะปะฐ ะดะปั 9 ัะตะบัะฝะด
ะะพัะปะต ะณััะฟะฟะธัะพะฒะบะธ ะฟะพ ััะพะปะฑัั "city" ั ะฟะพะผะพััั ะผะตัะพะดะฐ groupby, ะทะฝะฐัะตะฝะธั ััะพะณะพ ััะพะปะฑัะฐ ััะฐะฝะพะฒัััั ะธะฝะดะตะบัะพะผ ัะตะทัะปััะธััััะตะณะพ DataFrame, ะฐ ะฝะต ะตะณะพ ะพัะดะตะปัะฝัะผ ััะพะปะฑัะพะผ. ะะพััะพะผั ะพะฑัะฐัะตะฝะธะต grouped.head()['city'] ะฒัะทัะฒะฐะตั ะพัะธะฑะบั KeyError, ัะฐะบ ะบะฐะบ ััะพะปะฑัะฐ ั ะธะผะตะฝะตะผ "city" ัะฐะผ ะฝะตั.

ะงัะพะฑั ะฟะพะปััะธัั "city" ะบะฐะบ ััะพะปะฑะตั, ะผะพะถะฝะพ ัะฑัะพัะธัั ะธะฝะดะตะบั ั ะฟะพะผะพััั ะผะตัะพะดะฐ reset_index(), ะฝะฐะฟัะธะผะตั:

python
ะะพะฟะธัะพะฒะฐัั
grouped = business.groupby("city").count().reset_index()
grouped.sort_values(by='business_id', ascending=False, inplace=True)
print(grouped.head()['city'])
ะะธะฑะพ, ะตัะปะธ ะฒะฐั ะธะฝัะตัะตััะตั ะธะผะตะฝะฝะพ ะธะฝะดะตะบั, ะผะพะถะฝะพ ะพะฑัะฐัะธัััั ะบ ะฝะตะผั ัะตัะตะท grouped.index:

python
ะะพะฟะธัะพะฒะฐัั
print(grouped.head().index)
ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะพัะธะฑะบะฐ ะฒะพะทะฝะธะบะฐะตั ะธะท-ะทะฐ ัะพะณะพ, ััะพ "city" ัะตะฟะตัั ัะฒะปัะตััั ะธะฝะดะตะบัะพะผ, ะฐ ะฝะต ััะพะปะฑัะพะผ.






ะั ัะบะฐะทะฐะปะธ:
ะะฐะบ ะธัะฟะพะปัะทะพะฒะฐัั dict ะธ pyplot 
ะะฐัััะถะดะฐะปะฐ ะดะปั 7 ัะตะบัะฝะด
ะะธะถะต ะฟัะธะฒะตะดัะฝ ะฟัะธะผะตั, ะดะตะผะพะฝัััะธััััะธะน, ะบะฐะบ ะผะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ัะปะพะฒะฐัั (dict) ะดะปั ััะฐะฝะตะฝะธั ะดะฐะฝะฝัั ะธ ะผะพะดัะปั pyplot ะธะท matplotlib ะดะปั ะธั ะฒะธะทัะฐะปะธะทะฐัะธะธ.

ะัะธะผะตั: ะะพัััะพะตะฝะธะต ััะพะปะฑัะฐัะพะน ะดะธะฐะณัะฐะผะผั ะธะท ะดะฐะฝะฝัั ัะปะพะฒะฐัั
python
ะะพะฟะธัะพะฒะฐัั
import matplotlib.pyplot as plt

# ะกะพะทะดะฐะตะผ ัะปะพะฒะฐัั ั ะดะฐะฝะฝัะผะธ: ะบะปััะธ โ ะบะฐัะตะณะพัะธะธ, ะทะฝะฐัะตะฝะธั โ ัะธัะปะพะฒัะต ะฟะพะบะฐะทะฐัะตะปะธ.
data = {
    'A': 10,
    'B': 20,
    'C': 15,
    'D': 25,
    'E': 5
}

# ะะทะฒะปะตะบะฐะตะผ ะบะปััะธ ะธ ะทะฝะฐัะตะฝะธั ะธะท ัะปะพะฒะฐัั ะดะปั ะฟะพัััะพะตะฝะธั ะณัะฐัะธะบะฐ.
categories = list(data.keys())
values = list(data.values())

# ะกะพะทะดะฐะตะผ ะพะบะฝะพ ั ะดะธะฐะณัะฐะผะผะพะน, ะทะฐะดะฐะตะผ ัะฐะทะผะตั.
plt.figure(figsize=(8, 6))

# ะะพัััะพะตะฝะธะต ััะพะปะฑัะฐัะพะน ะดะธะฐะณัะฐะผะผั
plt.bar(categories, values, color='skyblue')

# ะะพะฑะฐะฒะปัะตะผ ะฟะพะดะฟะธัะธ ะพัะตะน ะธ ะทะฐะณะพะปะพะฒะพะบ
plt.xlabel('ะะฐัะตะณะพัะธะธ')
plt.ylabel('ะะฝะฐัะตะฝะธั')
plt.title('ะัะธะผะตั ััะพะปะฑัะฐัะพะน ะดะธะฐะณัะฐะผะผั')

# ะัะพะฑัะฐะถะฐะตะผ ะณัะฐัะธะบ
plt.show()
ะะพััะฝะตะฝะธะต:
dict:
ะกะปะพะฒะฐัั โ ััะพ ััััะบัััะฐ ะดะฐะฝะฝัั Python, ะบะพัะพัะฐั ััะฐะฝะธั ะฟะฐัั ยซะบะปัั-ะทะฝะฐัะตะฝะธะตยป. ะ ะฟัะธะผะตัะต ะบะปััะธ ะฟัะตะดััะฐะฒะปััั ะบะฐัะตะณะพัะธะธ (ะฝะฐะฟัะธะผะตั, 'A', 'B', 'C' ะธ ั.ะด.), ะฐ ะทะฝะฐัะตะฝะธั โ ัะธัะปะพะฒัะต ะดะฐะฝะฝัะต, ะบะพัะพััะต ะผั ัะพัะธะผ ะพัะพะฑัะฐะทะธัั.

pyplot:
ะะพะดัะปั pyplot ะธะท ะฑะธะฑะปะธะพัะตะบะธ matplotlib ะฟัะตะดะพััะฐะฒะปัะตั ััะฝะบัะธะธ ะดะปั ัะพะทะดะฐะฝะธั ัะฐะทะปะธัะฝัั ัะธะฟะพะฒ ะณัะฐัะธะบะพะฒ. ะะดะตัั ะผั ะธัะฟะพะปัะทัะตะผ ััะฝะบัะธั plt.bar() ะดะปั ะฟะพัััะพะตะฝะธั ััะพะปะฑัะฐัะพะน ะดะธะฐะณัะฐะผะผั. ะขะฐะบะถะต ะธัะฟะพะปัะทััััั ััะฝะบัะธะธ plt.xlabel(), plt.ylabel() ะธ plt.title() ะดะปั ะดะพะฑะฐะฒะปะตะฝะธั ะฟะพะดะฟะธัะตะน ะธ ะทะฐะณะพะปะพะฒะบะฐ, ะฐ plt.show() ะดะปั ะพัะพะฑัะฐะถะตะฝะธั ะณัะฐัะธะบะฐ.

ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะฒั ะผะพะถะตัะต ะธัะฟะพะปัะทะพะฒะฐัั dict ะดะปั ััะฐะฝะตะฝะธั ะธ ะพัะณะฐะฝะธะทะฐัะธะธ ะดะฐะฝะฝัั, ะฐ pyplot ะดะปั ะธั ะฒะธะทัะฐะปะธะทะฐัะธะธ ะฒ ะฒะธะดะต ัะฐะทะปะธัะฝัั ะณัะฐัะธะบะพะฒ.






ะั ัะบะฐะทะฐะปะธ:
ะั ะผะฝะต ะฝะฐะดะพ ัะดะตะปะฐัั ะณัะฐัะธะบ, ัะพััะพััะธะน ะธะท ะดะฒัั ะผะฐััะธะฒะพะฒ: ะบะปัั ะธ ะทะฝะฐัะตะฝะธะต 
ะะฐัััะถะดะฐะปะฐ ะดะปั 12 ัะตะบัะฝะด
ะะธะถะต ะฟัะธะฒะตะดัะฝ ะฟัะธะผะตั ะบะพะดะฐ, ะฒ ะบะพัะพัะพะผ ะธัะฟะพะปัะทััััั ะดะฒะฐ ะผะฐััะธะฒะฐ โ ะพะดะธะฝ ะดะปั ะบะปััะตะน (ะฝะฐะฟัะธะผะตั, ะบะฐัะตะณะพัะธะน) ะธ ะพะดะธะฝ ะดะปั ะทะฝะฐัะตะฝะธะน โ ะดะปั ะฟะพัััะพะตะฝะธั ะณัะฐัะธะบะฐ. ะ ะดะฐะฝะฝะพะผ ะฟัะธะผะตัะต ะธัะฟะพะปัะทัะตััั ััะพะปะฑัะฐัะฐั ะดะธะฐะณัะฐะผะผะฐ (bar chart), ะบะพัะพัะฐั ะฟะพะดัะพะดะธั, ะตัะปะธ ะบะปััะธ ัะฒะปััััั ะบะฐัะตะณะพัะธะฐะปัะฝัะผะธ ะดะฐะฝะฝัะผะธ.

python
ะะพะฟะธัะพะฒะฐัั
import matplotlib.pyplot as plt

# ะะฒะฐ ะผะฐััะธะฒะฐ: keys - ะบะฐัะตะณะพัะธะธ, values - ัะธัะปะพะฒัะต ะทะฝะฐัะตะฝะธั
keys = ['A', 'B', 'C', 'D', 'E']
values = [10, 20, 15, 25, 5]

# ะะฐัััะพะนะบะฐ ัะฐะทะผะตัะฐ ะณัะฐัะธะบะฐ
plt.figure(figsize=(8, 6))

# ะะพัััะพะตะฝะธะต ััะพะปะฑัะฐัะพะน ะดะธะฐะณัะฐะผะผั: ะบะปััะธ ะฟะพ ะพัะธ X, ะทะฝะฐัะตะฝะธั ะฟะพ ะพัะธ Y
plt.bar(keys, values, color='skyblue')

# ะะพะฑะฐะฒะปะตะฝะธะต ะฟะพะดะฟะธัะตะน ะพัะตะน ะธ ะทะฐะณะพะปะพะฒะบะฐ
plt.xlabel('ะะปััะธ')
plt.ylabel('ะะฝะฐัะตะฝะธั')
plt.title('ะัะฐัะธะบ: ะะปััะธ ะธ ะะฝะฐัะตะฝะธั')

# ะัะพะฑัะฐะถะตะฝะธะต ะณัะฐัะธะบะฐ
plt.show()
ะะพััะฝะตะฝะธะต:
keys โ ะผะฐััะธะฒ, ัะพะดะตัะถะฐัะธะน ะบะฐัะตะณะพัะธะธ ะธะปะธ ะบะปััะธ, ะบะพัะพััะต ะฑัะดัั ะพัะพะฑัะฐะถะตะฝั ะฟะพ ะพัะธ X.
values โ ะผะฐััะธะฒ, ัะพะดะตัะถะฐัะธะน ัะธัะปะพะฒัะต ะทะฝะฐัะตะฝะธั, ัะพะพัะฒะตัััะฒัััะธะต ะบะฐะถะดะพะผั ะบะปััั, ะบะพัะพััะต ะฑัะดัั ะพัะพะฑัะฐะถะตะฝั ะฟะพ ะพัะธ Y.
plt.bar() โ ััะฝะบัะธั ะธะท ะผะพะดัะปั pyplot, ะบะพัะพัะฐั ัััะพะธั ััะพะปะฑัะฐััั ะดะธะฐะณัะฐะผะผั.
plt.xlabel(), plt.ylabel(), plt.title() โ ััะฝะบัะธะธ ะดะปั ะดะพะฑะฐะฒะปะตะฝะธั ะฟะพะดะฟะธัะตะน ะพัะตะน ะธ ะทะฐะณะพะปะพะฒะบะฐ ะณัะฐัะธะบะฐ.
plt.show() โ ััะฝะบัะธั, ะบะพัะพัะฐั ะพัะพะฑัะฐะถะฐะตั ัะพะทะดะฐะฝะฝัะน ะณัะฐัะธะบ.
ะัะปะธ ะฒะฐัะธ ะบะปััะธ ัะฒะปััััั ัะธัะปะพะฒัะผะธ, ัะพ ะฒะผะตััะพ ััะพะปะฑัะฐัะพะน ะดะธะฐะณัะฐะผะผั ะผะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั, ะฝะฐะฟัะธะผะตั, ะปะธะฝะตะนะฝัะน ะณัะฐัะธะบ:

python
ะะพะฟะธัะพะฒะฐัั
import matplotlib.pyplot as plt

# ะัะธะผะตั ั ัะธัะปะพะฒัะผะธ ะบะปััะฐะผะธ
keys = [1, 2, 3, 4, 5]
values = [10, 20, 15, 25, 5]

plt.figure(figsize=(8, 6))
plt.plot(keys, values, marker='o', linestyle='-', color='blue')
plt.xlabel('ะะปััะธ')
plt.ylabel('ะะฝะฐัะตะฝะธั')
plt.title('ะะธะฝะตะนะฝัะน ะณัะฐัะธะบ: ะะปััะธ ะธ ะะฝะฐัะตะฝะธั')
plt.show()
ะะฑะฐ ะฟัะธะผะตัะฐ ะดะตะผะพะฝัััะธัััั, ะบะฐะบ ะผะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ะดะฒะฐ ะผะฐััะธะฒะฐ ะดะปั ะฟะพัััะพะตะฝะธั ะณัะฐัะธะบะฐ ั ะฟะพะผะพััั ะผะพะดัะปั pyplot. ะัะฑะตัะธัะต ัะธะฟ ะณัะฐัะธะบะฐ ะฒ ะทะฐะฒะธัะธะผะพััะธ ะพั ะฟัะธัะพะดั ะฒะฐัะธั ะดะฐะฝะฝัั ะธ ะฟัะตะดะฟะพััะธัะตะปัะฝะพะณะพ ัะฟะพัะพะฑะฐ ะฒะธะทัะฐะปะธะทะฐัะธะธ.






ะั ัะบะฐะทะฐะปะธ:

ะขะฐะบ. ะะฝะต ะฝัะถะฝะพ ัะดะตะปะฐัั ะบัะฐัะธะฒัะน ะณัะฐัะธะบ ัะพ ะทะฝะฐัะตะฝะธัะผะธ ะดะพะปะณะพัั ะธ ัะธัะพัั. ะกะตะนัะฐั ะฟะพะปััะฐะตััั ะบะฐะบะฐั-ัะพ ะปะฐะถะฐ. ะงัะพ ะผะฝะต ะดะตะปะฐัั? 
ะะฐัััะถะดะฐะปะฐ ะดะปั 19 ัะตะบัะฝะด
ะัะปะธ ะฒะฐะผ ะฝัะถะฝะพ ะฒะธะทัะฐะปะธะทะธัะพะฒะฐัั ัะธัะพัั ะธ ะดะพะปะณะพัั ะฝะฐ ะฟะปะพัะบะพััะธ, ะพะฑััะฝัะน ะฒัะทะพะฒ plt.plot(latitude, longitude) ะทะฐัะฐัััั ะดะฐัั ยซะปะพะผะฐะฝัั ะปะธะฝะธัยป, ะบะพัะพัะฐั ะฒัะณะปัะดะธั ะฝะต ะพัะตะฝั ะฝะฐะณะปัะดะฝะพ. ะะฑััะฝะพ ะณะตะพะบะพะพัะดะธะฝะฐัั ะพัะพะฑัะฐะถะฐัั ะปะธะฑะพ ะฒ ะฒะธะดะต ัะพัะตะบ (scatter-ะฟะปะพั), ะปะธะฑะพ ะฟะพะฒะตัั ะบะฐะบะพะน-ัะพ ะบะฐััั. ะะธะถะต ะฝะตัะบะพะปัะบะพ ัะพะฒะตัะพะฒ:

1. ะัะพััะฐั ัะพัะตัะฝะฐั ะดะธะฐะณัะฐะผะผะฐ (scatter plot) ะฒ Matplotlib
ะัะปะธ ะฒั ะฟัะพััะพ ัะพัะธัะต ัะฒะธะดะตัั ยซะพะฑะปะฐะบะพยป ัะพัะตะบ (ะบะฐะถะดะฐั ัะพัะบะฐ โ ััะพ ะพะดะฝะฐ ะฟะฐัะฐ 
(
ะดะพะปะณะพัะฐ
,
ัะธัะพัะฐ
)
(ะดะพะปะณะพัะฐ,ัะธัะพัะฐ)), ัะพ ะธัะฟะพะปัะทัะนัะต scatter:

python
ะะพะฟะธัะพะฒะฐัั
import matplotlib.pyplot as plt

plt.figure(figsize=(8, 6))
# ะะฑัะฐัะธัะต ะฒะฝะธะผะฐะฝะธะต: ััะฐะดะธัะธะพะฝะฝะพ ะดะพะปะณะพัั (longitude) ะพัะบะปะฐะดัะฒะฐัั ะฟะพ ะพัะธ X, ะฐ ัะธัะพัั (latitude) โ ะฟะพ ะพัะธ Y
plt.scatter(top_city_businesses['longitude'], top_city_businesses['latitude'], alpha=0.5)

plt.xlabel('Longitude')
plt.ylabel('Latitude')
plt.title('Locations of top city businesses')
plt.show()
plt.scatter(x, y) ัััะพะธั ัะพัะบะธ ั ะบะพะพัะดะธะฝะฐัะฐะผะธ 
(
๐ฅ
๐
,
๐ฆ
๐
)
(x 
i
โ
 ,y 
i
โ
 ).
ะ ะฝะฐัะตะผ ัะปััะฐะต, x = longitude, y = latitude.
ะะฐัะฐะผะตัั alpha=0.5 ะดะตะปะฐะตั ัะพัะบะธ ะฟะพะปัะฟัะพะทัะฐัะฝัะผะธ, ััะพะฑั ะผะพะถะฝะพ ะฑัะปะพ ัะฒะธะดะตัั ะฝะฐะปะพะถะตะฝะธั ะฟัะธ ะฑะพะปััะพะน ะฟะปะพัะฝะพััะธ.
ะัะปะธ ั ะฒะฐั ะผะฝะพะณะพ ัะพัะตะบ, ะผะพะถะฝะพ ะดะพะฑะฐะฒะธัั ะฟะฐัะฐะผะตััั s= (ัะฐะทะผะตั ัะพัะตะบ) ะธะปะธ c= (ัะฒะตัะฐ) ะดะปั ะดะพะฟะพะปะฝะธัะตะปัะฝะพะน ะฝะฐะณะปัะดะฝะพััะธ.
ะะฐะถะฝะพ: ะัะปะธ ะฒั ะฟะพะผะตะฝัะตัะต ะผะตััะฐะผะธ ัะธัะพัั ะธ ะดะพะปะณะพัั, ัะพ ะฟะพะปััะธัะต ะพััะฐะถะตะฝะธะต ะฟะพ ะดะธะฐะณะพะฝะฐะปะธ, ััะพ ะพะฑััะฝะพ ะฝะต ัะพะพัะฒะตัััะฒัะตั ะพะฑัะตะฟัะธะฝััะพะผั ัะฟะพัะพะฑั ะพัะพะฑัะฐะถะตะฝะธั ะบะฐัั.

2. ะัะฟะพะปัะทะพะฒะฐะฝะธะต ัะฟะตัะธะฐะปะธะทะธัะพะฒะฐะฝะฝัั ะฑะธะฑะปะธะพัะตะบ ะดะปั ะบะฐัั
ะัะปะธ ะฒั ัะพัะธัะต ะธะผะตะฝะฝะพ ยซะบะฐัััยป ั ะฟะพะดะปะพะถะบะพะน (ัะปะธัั, ะณัะฐะฝะธัั ะณะพัะพะดะพะฒ ะธ ั.ะด.), ัะพ ะฒะฐะผ ะผะพะณัั ะฟะพะผะพัั:

geopandas
ะะพะทะฒะพะปัะตั ัะฐะฑะพัะฐัั ั ะณะตะพะดะฐะฝะฝัะผะธ (GeoDataFrame) ะธ ะพัะพะฑัะฐะถะฐัั ะธั ั ะฟะพะผะพััั ะฒัััะพะตะฝะฝัั ะผะตัะพะดะพะฒ ะธะปะธ ัะพะฒะผะตััะฝะพ ั matplotlib.

contextily
ะะพะดะบะปััะฐะตััั ะบ tile-ัะตัะฒะธัะฐะผ (ะฝะฐะฟัะธะผะตั, OpenStreetMap) ะธ ะฟะพะทะฒะพะปัะตั ะดะพะฑะฐะฒะธัั ยซัะพะฝะพะฒััยป ะบะฐััั.

cartopy ะธะปะธ Basemap
ะะธะฑะปะธะพัะตะบะธ ะดะปั ะฟัะพะตะบัะธะน, ะบะพะพัะดะธะฝะฐัะฝัั ะฟัะตะพะฑัะฐะทะพะฒะฐะฝะธะน ะธ ัะธัะพะฒะฐะฝะธั ะบะฐัั. Cartopy โ ะฑะพะปะตะต ัะพะฒัะตะผะตะฝะฝัะน ะฒะฐัะธะฐะฝั.

ะัะธะผะตั ั geopandas (ะตัะปะธ ั ะฒะฐั ะตััั ััะพะปะฑัั latitude ะธ longitude ะธ ะฒั ัะพัะธัะต ะฑััััะพ ะพัะพะฑัะฐะทะธัั ัะพัะบะธ ะฝะฐ ะบะฐััะต):

python
ะะพะฟะธัะพะฒะฐัั
import geopandas as gpd
from shapely.geometry import Point

# ะกะพะทะดะฐะตะผ GeoDataFrame ะธะท DataFrame
geometry = [Point(xy) for xy in zip(top_city_businesses['longitude'], top_city_businesses['latitude'])]
gdf = gpd.GeoDataFrame(top_city_businesses, geometry=geometry, crs="EPSG:4326")

# ะัะพะฑัะฐะถะฐะตะผ
gdf.plot(figsize=(8, 6), alpha=0.5, marker='o')
plt.show()
ะะดะตัั ะผั ัะบะฐะทัะฒะฐะตะผ ัะธััะตะผั ะบะพะพัะดะธะฝะฐั crs="EPSG:4326", ะบะพัะพัะฐั ัะพะพัะฒะตัััะฒัะตั ัะธัะพัะต/ะดะพะปะณะพัะต ะฒ ะณัะฐะดััะฐั.
ะะตะทัะปััะฐั โ ัะพัะบะธ ะฝะฐ ััะปะพะฒะฝะพะน ยซะฑะตะปะพะน ะบะฐััะตยป. ะงัะพะฑั ะดะพะฑะฐะฒะธัั ะฟะพะดะปะพะถะบั (ะฝะฐะฟัะธะผะตั, OpenStreetMap), ะผะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั contextily.
3. ะะพัะตะผั plot() ะดะฐัั ยซะปะพะผะฐะฝััยป
ะคัะฝะบัะธั plt.plot(x, y) ะฒ Matplotlib ะฟะพ ัะผะพะปัะฐะฝะธั ัะพะตะดะธะฝัะตั ัะพัะบะธ ะปะธะฝะธัะผะธ ะฒ ะฟะพััะดะบะต ะธั ัะปะตะดะพะฒะฐะฝะธั ะฒ ะผะฐััะธะฒะต. ะญัะพ ัะดะพะฑะฝะพ ะดะปั ะฒัะตะผะตะฝะฝัั ััะดะพะฒ ะธะปะธ ััะฝะบัะธะน, ะฝะพ ะฝะต ะดะปั ะบะพะพัะดะธะฝะฐั, ะบะพัะพััะต ะฝะต ัะฒัะทะฐะฝั ะฟะพััะดะบะพะผ. ะะพััะพะผั ะฟัะธ ัะฐะฑะพัะต ั ัะธัะพัะพะน/ะดะพะปะณะพัะพะน:

ะัะปะธ ะฒั ะดะตะนััะฒะธัะตะปัะฝะพ ัะพัะธัะต ะปะธะฝะธั (ะฝะฐะฟัะธะผะตั, ะผะฐััััั), ัะพ ะดะฐะฝะฝัะต ะดะพะปะถะฝั ะธะดัะธ ะฒ ะฟะพััะดะบะต ัะปะตะดะพะฒะฐะฝะธั ะผะฐัััััะฐ.
ะัะปะธ ะฒั ัะพัะธัะต ะฟัะพััะพ ะฝะฐะฑะพั ัะพัะตะบ, ัะพ ะธัะฟะพะปัะทัะนัะต plt.scatter(...).
ะะตะทัะผะต
ะขะพัะตัะฝะฐั ะดะธะฐะณัะฐะผะผะฐ (scatter plot) โ ะปัััะธะน ะฒะฐัะธะฐะฝั, ะตัะปะธ ะฝัะถะฝะฐ ะฟัะพััะฐั ะฒะธะทัะฐะปะธะทะฐัะธั ะบะพะพัะดะธะฝะฐั ะฝะฐ ะฟะปะพัะบะพััะธ.
ะะธะฑะปะธะพัะตะบะธ ะดะปั ะบะฐัั โ ะฝัะถะฝั, ะตัะปะธ ัะพัะธัะต ยซะฝะฐััะพััััยป ะบะฐััั ั ะฟะพะดะปะพะถะบะพะน ะธะปะธ ะณะตะพะฟัะธะฒัะทะบะพะน.
plot() vs scatter():
plot(x, y) โ ัะธััะตั ะปะธะฝะธะธ/ะปะพะผะฐะฝัั.
scatter(x, y) โ ัะธััะตั ะพัะดะตะปัะฝัะต ัะพัะบะธ.
ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ััะพะฑั ยซะฝะต ะฑัะปะพ ะปะฐะถะธยป, ะฒะพัะฟะพะปัะทัะนัะตัั scatter, ัะฐัััะฐะฒััะต ะฟะพะดะฟะธัะธ ะพัะตะน ะธ ะทะฐะดะฐะนัะต ะฟะพะฝััะฝัะต ัะฐะทะผะตัั/ะฟัะพะทัะฐัะฝะพััั. ะะปะธ ะถะต ะฟะตัะตะนะดะธัะต ะฝะฐ ะฑะพะปะตะต ะฟัะพะดะฒะธะฝัััะต ะธะฝััััะผะตะฝัั ะดะปั ะณะตะพะดะฐะฝะฝัั, ะตัะปะธ ััะตะฑัะตััั ะฝะฐััะพััะฐั ะบะฐััะฐ.






ะั ัะบะฐะทะฐะปะธ:
ะขะฐะบ, ะฐ ะตัะปะธ ั ัะพัั ะณะตะพ ะบะฐััั? ะขะธะฟ ะฝะฐััะพัััั ะบะฐััั, ััะพะฑั ะพะฝะฐ ะบัะฐัะธะฒะพ ะพัะพะฑัะฐะถะฐะปะฐัั 
ะัะปะธ ะฒั ัะพัะธัะต ะฟะพัััะพะธัั **ะฝะฐััะพัััั ะณะตะพ-ะบะฐััั** ั ะพัะพะฑัะฐะถะตะฝะธะตะผ ัะพัะตะบ, ัะฐะบะธั ะบะฐะบ ะผะตััะพะฟะพะปะพะถะตะฝะธั ะฝะฐ ะบะฐััะต, ะธัะฟะพะปัะทะพะฒะฐะฝะธะต **ะณะตะพะณัะฐัะธัะตัะบะธั ะฑะธะฑะปะธะพัะตะบ** ะฑัะดะตั ะฝะฐะธะปัััะธะผ ัะตัะตะฝะธะตะผ. ะะธะถะต ะพะฑัััะฝั, ะบะฐะบ ััะพ ัะดะตะปะฐัั ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ **Folium**, **Geopandas**, ะธะปะธ **Plotly** ะดะปั ัะพะทะดะฐะฝะธั ะพัะผััะปะตะฝะฝัั ะธ ะบัะฐัะธะฒัั ะบะฐัั. ### 1. ะัะฟะพะปัะทะพะฒะฐะฝะธะต **Folium** **Folium** ะฟะพะทะฒะพะปัะตั ะฒะฐะผ ะธะฝัะตะณัะธัะพะฒะฐัั ะบะฐััั ะฟััะผะพ ะฒ ะฒะฐั Python ะบะพะด ะธ ะฝะฐัััะฐะธะฒะฐัั ะธะฝัะตัะฐะบัะธะฒะฝัะต ะบะฐััั ั ะฟะพะผะพััั ะดะฐะฝะฝัั GPS-ะบะพะพัะดะธะฝะฐั (ัะธัะพัะฐ ะธ ะดะพะปะณะพัะฐ). #### ะฃััะฐะฝะพะฒะบะฐ: ```bash pip install folium ``` #### ะัะธะผะตั ะบะพะดะฐ ั Folium: ```python import folium # ะกะพะทะดะฐะตะผ ะพะฑัะตะบั ะบะฐััั, ัะตะฝััะธััะตะผ ะฝะฐ ััะตะดะฝะตะน ัะพัะบะต m = folium.Map(location=[55.7558, 37.6173], zoom_start=10) # ะะพัะบะฒะฐ, ะฝะฐะฟัะธะผะตั # ะะพะฑะฐะฒะปัะตะผ ะผะฐัะบะตัั ะดะปั ะบะฐะถะดะพะน ัะพัะบะธ ั ะบะพะพัะดะธะฝะฐัะฐะผะธ (ัะธัะพัะฐ, ะดะพะปะณะพัะฐ) m.add_child(folium.Marker([55.7558, 37.6173], popup='ะะพัะบะฒะฐ')) m.add_child(folium.Marker([59.9343, 30.3351], popup='ะกะฐะฝะบั-ะะตัะตัะฑััะณ')) # ะกะพััะฐะฝัะตะผ ะบะฐััั ะฒ HTML ัะฐะนะปะต m.save("map.html") ``` ะญัะพั ะบะพะด ัะพะทะดะฐัั ะบะฐััั ั ะผะฐัะบะตัะฐะผะธ, ะฟัะตะดััะฐะฒะปะตะฝะฝัะผะธ ะฒ HTML-ัะฐะนะปะต, ะบะพัะพััะน ะผะพะถะฝะพ ะพัะบัััั ะฒ ะฑัะฐัะทะตัะต. **Folium** ะฟะพะทะฒะพะปัะตั ะธัะฟะพะปัะทะพะฒะฐัั ะบะฐััั ะพั **OpenStreetMap**, **Google Maps** ะธ ะดััะณะธั ัะตัะฒะธัะพะฒ ะดะปั ะฟะพะดะปะพะถะบะธ. ### 2. ะัะฟะพะปัะทะพะฒะฐะฝะธะต **Geopandas** ะธ **Contextily** ะดะปั ะบะฐัั ั ะฟะพะดะปะพะถะบะพะน **Geopandas** ะฟะพะทะฒะพะปัะตั ัะฐะฑะพัะฐัั ั ะณะตะพ-ะดะฐะฝะฝัะผะธ, ะฐ **Contextily** ะฟะพะทะฒะพะปัะตั ะฝะฐะปะพะถะธัั ะบะฐััะพะณัะฐัะธัะตัะบะธะน ัะปะพะน, ะฝะฐะฟัะธะผะตั, OpenStreetMap, ะฒ ะฟัะพะตะบั. #### ะฃััะฐะฝะพะฒะบะฐ: ```bash pip install geopandas contextily ``` #### ะัะธะผะตั ะบะพะดะฐ ั Geopandas: ```python import geopandas as gpd from shapely.geometry import Point import contextily as ctx # ะัะธะผะตั ะดะฐะฝะฝัั: ะบะพะพัะดะธะฝะฐัั ัะพัะตะบ (ะดะพะปะณะพัะฐ, ัะธัะพัะฐ) data = { 'city': ['ะะพัะบะฒะฐ', 'ะกะฐะฝะบั-ะะตัะตัะฑััะณ'], 'longitude': [37.6173, 30.3351], 'latitude': [55.7558, 59.9343] } # ะกะพะทะดะฐะตะผ GeoDataFrame ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ะดะฐะฝะฝัั gdf = gpd.GeoDataFrame(data, geometry=gpd.GeoSeries([Point(lon, lat) for lon, lat in zip(data['longitude'], data['latitude'])]), crs="EPSG:4326") # ะกะพะณะปะฐัะฐะตะผัั ั ะฟัะพะตะบัะธะตะน ะบะฐััั (EPSG:3857 โ ะดะปั ะบะฐััะพะฒัั ะฟัะพะตะบัะธะน) gdf = gdf.to_crs(epsg=3857) # ะะธะทัะฐะปะธะทะธััะตะผ ะฝะฐ ะบะฐััะต ั ะฟะพะดะปะพะถะบะพะน (OpenStreetMap) ax = gdf.plot(figsize=(10, 10), alpha=0.5, marker='o', color='red') ctx.add_basemap(ax, crs=gdf.crs.to_string()) # ะะพะบะฐะทัะฒะฐะตะผ ะบะฐััั import matplotlib.pyplot as plt plt.show() ``` ะญัะพั ะบะพะด ะฟะพัััะพะธั ะบะฐััั ั ะดะฒัะผั ัะพัะบะฐะผะธ (ะะพัะบะฒะฐ ะธ ะกะฐะฝะบั-ะะตัะตัะฑััะณ) ะฝะฐ ัะพะฝะต OpenStreetMap. `contextily` ะดะพะฑะฐะฒะปัะตั ะฑะฐะทะพะฒัะต ะบะฐััั, ะบะพัะพััะต ะดะฐัั ะบัะฐัะธะฒะพะต ะพัะพะฑัะฐะถะตะฝะธะต ะณะตะพะณัะฐัะธัะผ. ### 3. ะัะฟะพะปัะทะพะฒะฐะฝะธะต **Plotly** ะดะปั ะบะฐัั ั ะธะฝัะตัะฐะบัะธะฒะฝะพะน ะฒะธะทัะฐะปะธะทะฐัะธะตะน **Plotly** ัะฐะบะถะต ะฟะพะทะฒะพะปัะตั ัััะพะธัั ะบัะฐัะธะฒัะต ะธะฝัะตัะฐะบัะธะฒะฝัะต ะบะฐััั. ะญัะฐ ะฑะธะฑะปะธะพัะตะบะฐ ะพัะพะฑะตะฝะฝะพ ัะพัะพัะฐ ะดะปั ัะพะทะดะฐะฝะธั ะณัะฐัะธะบะพะฒ ะธ ะบะฐัั ั ะฒะพะทะผะพะถะฝะพัััั ะผะฐัััะฐะฑะธัะพะฒะฐะฝะธั. #### ะฃััะฐะฝะพะฒะบะฐ: ```bash pip install plotly ``` #### ะัะธะผะตั ะบะพะดะฐ ั Plotly: ```python import plotly.express as px # ะัะธะผะตั ะดะฐะฝะฝัั data = { 'city': ['ะะพัะบะฒะฐ', 'ะกะฐะฝะบั-ะะตัะตัะฑััะณ'], 'longitude': [37.6173, 30.3351], 'latitude': [55.7558, 59.9343] } # ะกะพะทะดะฐะตะผ DataFrame import pandas as pd df = pd.DataFrame(data) # ะกััะพะธะผ ะบะฐััั fig = px.scatter_geo(df, lon='longitude', lat='latitude', hover_name="city", title="Cities in Russia") # ะะพะบะฐะทัะฒะฐะตะผ ะธะฝัะตัะฐะบัะธะฒะฝัั ะบะฐััั fig.show() ``` ะญัะพั ะบะพะด ัะพะทะดะฐัั ะธะฝัะตัะฐะบัะธะฒะฝัั ะบะฐััั ั ะผะตัะบะฐะผะธ ะฝะฐ ัะพัะบะฐั, ะพัะพะฑัะฐะถะฐััะธะต ะณะพัะพะดะฐ "ะะพัะบะฒะฐ" ะธ "ะกะฐะฝะบั-ะะตัะตัะฑััะณ". ะะฐัะบะตัั ะผะพะถะฝะพ ะดะพะฑะฐะฒะธัั, ะฝะฐัััะฐะธะฒะฐัั ะบะพะปะธัะตััะฒะพ ััะพะฒะฝะตะน ะดะตัะฐะปะธะทะฐัะธะธ ะบะฐััั ะธ ะผะฝะพะถะตััะฒะพ ะดััะณะธั ะฟะฐัะฐะผะตััะพะฒ. ### ะะตะทัะผะต: - **Folium** ะพัะปะธัะฝะพ ะฟะพะดัะพะดะธั, ะตัะปะธ ะฝัะถะฝะพ ัะพะทะดะฐัั ะบะฐััั ั ะผะฐัะบะตัะฐะผะธ ะธ ะณะตะพะปะพะบะฐัะธะพะฝะฝัะผะธ ะดะฐะฝะฝัะผะธ (ะดะปั ะพัะพะฑัะฐะถะตะฝะธั ะผะตััะพะฟะพะปะพะถะตะฝะธะน ะฝะฐ ะฝะฐััะพััะธั ะบะฐััะฐั). - **Geopandas** ัะพัะพัะพ ัะฟัะฐะฒะปัะตััั ั ะพะฑัะฐะฑะพัะบะพะน ะณะตะพะณัะฐัะธัะตัะบะธั ะดะฐะฝะฝัั ะธ ะฒะธะทัะฐะปะธะทะฐัะธะตะน ะบะฐัั ั ะฟะพะดะปะพะถะบะพะน. - **Plotly** ะฟะพะทะฒะพะปัะตั ัััะพะธัั ะบัะฐัะธะฒัะต ะธะฝัะตัะฐะบัะธะฒะฝัะต ะณะตะพะณัะฐัะธัะตัะบะธะต ะบะฐััั ั ะฒะพะทะผะพะถะฝะพัััั ะผะฐัััะฐะฑะธัะพะฒะฐะฝะธั ะธ ะฝะฐัััะพะนะบะธ. ะะฐะถะดัะน ะธะฝััััะผะตะฝั ะธะผะตะตั ัะฒะพะธ ะพัะพะฑะตะฝะฝะพััะธ ะธ ะผะพะถะตั ะธัะฟะพะปัะทะพะฒะฐัััั ะฒ ะทะฐะฒะธัะธะผะพััะธ ะพั ะฒะฐัะธั ัะตะปะตะน. ะัะปะธ ะณะปะฐะฒะฝะฐั ัะตะปั โ ััะพ ัะพะทะดะฐะฝะธะต ะฑัะฐัะทะตัะฝัั ะบะฐัั ั ะฟะพะดะปะพะถะบะพะน OpenStreetMap, ะปัััะต ะธัะฟะพะปัะทะพะฒะฐัั **Folium**. ะัะปะธ ัะพัะธัะต ัะฐะฑะพัะฐัั ั ะณะตะพะณัะฐัะธัะตัะบะธะผะธ ะดะฐะฝะฝัะผะธ ะธ ะฒะธะทัะฐะปะธะทะธัะพะฒะฐะฝะธะตะผ ะฟะพ ะบะพะพัะดะธะฝะฐัะฐะผ, ะฒะพัะฟะพะปัะทัะนัะตัั **Geopandas** ะธะปะธ **Plotly**. ะดะปั 42 ัะตะบัะฝะด
ะงัะพะฑั ะพัะพะฑัะฐะทะธัั ัะพัะบะธ ั ะดะพะปะณะพัะพะน ะธ ัะธัะพัะพะน ะฝะฐ ัะตะฐะปัะฝะพะน ะบะฐััะต, ะฐ ะฝะต ะฟัะพััะพ ะฝะฐ ะฐะฑัััะฐะบัะฝะพะน ะบะพะพัะดะธะฝะฐัะฝะพะน ะฟะปะพัะบะพััะธ, ะฒ Python ะตััั ะฝะตัะบะพะปัะบะพ ะฟะพะฟัะปััะฝัั ัะฟะพัะพะฑะพะฒ:

ะัะฟะพะปัะทะพะฒะฐัั ะฑะธะฑะปะธะพัะตะบั Folium (ะพัะพะฑัะฐะถะฐะตั ะบะฐััั ะฒ ััะธะปะต Leaflet ะฒ ะฑัะฐัะทะตัะต).
ะัะฟะพะปัะทะพะฒะฐัั GeoPandas + Contextily/Cartopy (ะฟะพะทะฒะพะปัะตั ะฝะฐะบะปะฐะดัะฒะฐัั ะณะตะพะดะฐะฝะฝัะต ะฝะฐ ัะฐะนะปั ั ะบะฐัั).
ะัะฟะพะปัะทะพะฒะฐัั Plotly (ะฝะฐะฟัะธะผะตั, scatter_mapbox ะธะปะธ scatter_geo).
ะะธะถะต ะฝะตัะบะพะปัะบะพ ะบัะฐัะบะธั ะฟัะธะผะตัะพะฒ ะดะปั ะบะฐะถะดะพะณะพ ะฟะพะดัะพะดะฐ.

1. Folium
ะกะฐะผัะน ะฟัะพััะพะน ะฒะฐัะธะฐะฝั, ะตัะปะธ ะฒั ัะพัะธัะต ะฑััััะพ ะฟะพะปััะธัั ะธะฝัะตัะฐะบัะธะฒะฝัั ะบะฐััั ะฒ ะฑัะฐัะทะตัะต:

python
ะะพะฟะธัะพะฒะฐัั
import folium

# ะะพะฟัััะธะผ, ั ะฒะฐั ะตััั DataFrame top_city_businesses 
# ัะพ ััะพะปะฑัะฐะผะธ ['latitude', 'longitude', 'business_name'].

# ะะฐะดะฐัะผ ะฝะฐัะฐะปัะฝัะต ะบะพะพัะดะธะฝะฐัั ะดะปั ัะตะฝััะฐ ะบะฐััั (ะฝะฐะฟัะธะผะตั, ััะตะดะฝะธะต ะทะฝะฐัะตะฝะธั)
start_lat = top_city_businesses['latitude'].mean()
start_lon = top_city_businesses['longitude'].mean()

# ะกะพะทะดะฐัะผ ะบะฐััั ั ะฝะตะบะพัะพััะผ ะทัะผะพะผ (zoom_start)
m = folium.Map(location=[start_lat, start_lon], zoom_start=10)

# ะะพะฑะฐะฒะปัะตะผ ัะพัะบะธ (ะผะฐัะบะตัั) ะฝะฐ ะบะฐััั
for idx, row in top_city_businesses.iterrows():
    folium.Marker(
        location=[row['latitude'], row['longitude']],
        popup=row['business_name']  # ััะพ ะฑัะดะตั ะฟะพะบะฐะทะฐะฝะพ ะฟัะธ ะบะปะธะบะต
    ).add_to(m)

# ะัะพะฑัะฐะทะธัั ะบะฐััั ะฒ Jupyter Notebook
m

# ะะปะธ ัะพััะฐะฝะธัั ะฒ HTML-ัะฐะนะป
m.save('my_map.html')
ะัะตะธะผััะตััะฒะฐ Folium:

ะัะพััะพัะฐ ัััะฐะฝะพะฒะบะธ ะธ ะธัะฟะพะปัะทะพะฒะฐะฝะธั.
ะะฝัะตัะฐะบัะธะฒะฝะฐั ะบะฐััะฐ ะฝะฐ ะพัะฝะพะฒะต Leaflet.
ะะตะณะบะพ ะดะพะฑะฐะฒะปััั ะผะฐัะบะตัั, ะฒัะฟะปัะฒะฐััะธะต ะฟะพะดัะบะฐะทะบะธ, ะบััะณะธ, ะฟะพะปะธะณะพะฝั ะธ ั.ะด.
ะะตะดะพััะฐัะบะธ:

ะะณัะฐะฝะธัะตะฝะฐ ะฒ ะฟะปะฐะฝะต ะพัะพัะผะปะตะฝะธั (ะฝะพ ะฑะฐะทะพะฒัั ะฒะพะทะผะพะถะฝะพััะตะน ัะฒะฐัะฐะตั ะดะปั ะฑะพะปััะธะฝััะฒะฐ ะทะฐะดะฐั).
ะัะพะฑัะฐะถะฐะตััั ะฒ ะฑัะฐัะทะตัะต ะธะปะธ ะฒ Jupyter Notebook (ะฒ ะบะพะฝัะพะปะธ ะฝะต ัะฒะธะดะธัั).
2. GeoPandas + Contextily
ะัะปะธ ั ะฒะฐั GeoDataFrame ะธ ะฒั ัะพัะธัะต ยซะฟะพะดะปะพะถะธััยป ะฟะพะด ะฝะตะณะพ ัะฐะนะปั (ะฝะฐะฟัะธะผะตั, OpenStreetMap), ัะพ ัะฐััะพ ะธัะฟะพะปัะทััั ัะฒัะทะบั geopandas + contextily.

ะจะฐะณะธ:
ะฃััะฐะฝะพะฒะธัะต ะฑะธะฑะปะธะพัะตะบะธ:
bash
ะะพะฟะธัะพะฒะฐัั
pip install geopandas contextily
ะัะตะพะฑัะฐะทัะนัะต ะฒะฐั DataFrame ะฒ GeoDataFrame, ัะบะฐะทะฐะฒ ัะธััะตะผั ะบะพะพัะดะธะฝะฐั EPSG:4326 (ัะธัะพัะฐ/ะดะพะปะณะพัะฐ).
ะะตัะตะฒะตะดะธัะต ะฒ ะฟัะพะตะบัะธั Web Mercator (EPSG:3857), ะบะพัะพััั ะฟะพะฝะธะผะฐัั ะผะฝะพะณะธะต tile-ัะตัะฒะธัั (ะฒ
ะงัะพะฑั ะพัะพะฑัะฐะทะธัั ัะพัะบะธ ั ะดะพะปะณะพัะพะน ะธ ัะธัะพัะพะน ะฝะฐ ัะตะฐะปัะฝะพะน ะบะฐััะต, ะฐ ะฝะต ะฟัะพััะพ ะฝะฐ ะฐะฑัััะฐะบัะฝะพะน ะบะพะพัะดะธะฝะฐัะฝะพะน ะฟะปะพัะบะพััะธ, ะฒ Python ะตััั ะฝะตัะบะพะปัะบะพ ะฟะพะฟัะปััะฝัั ัะฟะพัะพะฑะพะฒ:

ะัะฟะพะปัะทะพะฒะฐัั ะฑะธะฑะปะธะพัะตะบั Folium (ะพัะพะฑัะฐะถะฐะตั ะบะฐััั ะฒ ััะธะปะต Leaflet ะฒ ะฑัะฐัะทะตัะต).
ะัะฟะพะปัะทะพะฒะฐัั GeoPandas + Contextily/Cartopy (ะฟะพะทะฒะพะปัะตั ะฝะฐะบะปะฐะดัะฒะฐัั ะณะตะพะดะฐะฝะฝัะต ะฝะฐ ัะฐะนะปั ั ะบะฐัั).
ะัะฟะพะปัะทะพะฒะฐัั Plotly (ะฝะฐะฟัะธะผะตั, scatter_mapbox ะธะปะธ scatter_geo).
ะะธะถะต ะฝะตัะบะพะปัะบะพ ะบัะฐัะบะธั ะฟัะธะผะตัะพะฒ ะดะปั ะบะฐะถะดะพะณะพ ะฟะพะดัะพะดะฐ.

1. Folium
ะกะฐะผัะน ะฟัะพััะพะน ะฒะฐัะธะฐะฝั, ะตัะปะธ ะฒั ัะพัะธัะต ะฑััััะพ ะฟะพะปััะธัั ะธะฝัะตัะฐะบัะธะฒะฝัั ะบะฐััั ะฒ ะฑัะฐัะทะตัะต:

python
ะะพะฟะธัะพะฒะฐัั
import folium

# ะะพะฟัััะธะผ, ั ะฒะฐั ะตััั DataFrame top_city_businesses 
# ัะพ ััะพะปะฑัะฐะผะธ ['latitude', 'longitude', 'business_name'].

# ะะฐะดะฐัะผ ะฝะฐัะฐะปัะฝัะต ะบะพะพัะดะธะฝะฐัั ะดะปั ัะตะฝััะฐ ะบะฐััั (ะฝะฐะฟัะธะผะตั, ััะตะดะฝะธะต ะทะฝะฐัะตะฝะธั)
start_lat = top_city_businesses['latitude'].mean()
start_lon = top_city_businesses['longitude'].mean()

# ะกะพะทะดะฐัะผ ะบะฐััั ั ะฝะตะบะพัะพััะผ ะทัะผะพะผ (zoom_start)
m = folium.Map(location=[start_lat, start_lon], zoom_start=10)

# ะะพะฑะฐะฒะปัะตะผ ัะพัะบะธ (ะผะฐัะบะตัั) ะฝะฐ ะบะฐััั
for idx, row in top_city_businesses.iterrows():
    folium.Marker(
        location=[row['latitude'], row['longitude']],
        popup=row['business_name']  # ััะพ ะฑัะดะตั ะฟะพะบะฐะทะฐะฝะพ ะฟัะธ ะบะปะธะบะต
    ).add_to(m)

# ะัะพะฑัะฐะทะธัั ะบะฐััั ะฒ Jupyter Notebook
m

# ะะปะธ ัะพััะฐะฝะธัั ะฒ HTML-ัะฐะนะป
m.save('my_map.html')
ะัะตะธะผััะตััะฒะฐ Folium:

ะัะพััะพัะฐ ัััะฐะฝะพะฒะบะธ ะธ ะธัะฟะพะปัะทะพะฒะฐะฝะธั.
ะะฝัะตัะฐะบัะธะฒะฝะฐั ะบะฐััะฐ ะฝะฐ ะพัะฝะพะฒะต Leaflet.
ะะตะณะบะพ ะดะพะฑะฐะฒะปััั ะผะฐัะบะตัั, ะฒัะฟะปัะฒะฐััะธะต ะฟะพะดัะบะฐะทะบะธ, ะบััะณะธ, ะฟะพะปะธะณะพะฝั ะธ ั.ะด.
ะะตะดะพััะฐัะบะธ:

ะะณัะฐะฝะธัะตะฝะฐ ะฒ ะฟะปะฐะฝะต ะพัะพัะผะปะตะฝะธั (ะฝะพ ะฑะฐะทะพะฒัั ะฒะพะทะผะพะถะฝะพััะตะน ัะฒะฐัะฐะตั ะดะปั ะฑะพะปััะธะฝััะฒะฐ ะทะฐะดะฐั).
ะัะพะฑัะฐะถะฐะตััั ะฒ ะฑัะฐัะทะตัะต ะธะปะธ ะฒ Jupyter Notebook (ะฒ ะบะพะฝัะพะปะธ ะฝะต ัะฒะธะดะธัั).
2. GeoPandas + Contextily
ะัะปะธ ั ะฒะฐั GeoDataFrame ะธ ะฒั ัะพัะธัะต ยซะฟะพะดะปะพะถะธััยป ะฟะพะด ะฝะตะณะพ ัะฐะนะปั (ะฝะฐะฟัะธะผะตั, OpenStreetMap), ัะพ ัะฐััะพ ะธัะฟะพะปัะทััั ัะฒัะทะบั geopandas + contextily.

ะจะฐะณะธ:
ะฃััะฐะฝะพะฒะธัะต ะฑะธะฑะปะธะพัะตะบะธ:
bash
ะะพะฟะธัะพะฒะฐัั
pip install geopandas contextily
ะัะตะพะฑัะฐะทัะนัะต ะฒะฐั DataFrame ะฒ GeoDataFrame, ัะบะฐะทะฐะฒ ัะธััะตะผั ะบะพะพัะดะธะฝะฐั EPSG:4326 (ัะธัะพัะฐ/ะดะพะปะณะพัะฐ).
ะะตัะตะฒะตะดะธัะต ะฒ ะฟัะพะตะบัะธั Web Mercator (EPSG:3857), ะบะพัะพััั ะฟะพะฝะธะผะฐัั ะผะฝะพะณะธะต tile-ัะตัะฒะธัั (ะฒะบะปััะฐั contextily).
ะะพัััะพะนัะต ัะพัะบะธ, ะทะฐัะตะผ ะดะพะฑะฐะฒััะต ัะฐะนะปั ั ะฟะพะผะพััั ctx.add_basemap(...).
ะัะธะผะตั ะบะพะดะฐ:

python
ะะพะฟะธัะพะฒะฐัั
import geopandas as gpd
from shapely.geometry import Point
import contextily as ctx
import matplotlib.pyplot as plt

# ะจะฐะณ 1: ะกะพะทะดะฐะดะธะผ GeoDataFrame ะธะท pandas DataFrame
geometry = [
    Point(xy) for xy in zip(top_city_businesses['longitude'], top_city_businesses['latitude'])
]
gdf = gpd.GeoDataFrame(top_city_businesses, geometry=geometry, crs="EPSG:4326")

# ะจะฐะณ 2: ะะตัะตะฒะพะดะธะผ ะบะพะพัะดะธะฝะฐัั ะฒ Web Mercator (EPSG:3857)
gdf_web_mercator = gdf.to_crs(epsg=3857)

# ะจะฐะณ 3: ะกััะพะธะผ ัะพัะบะธ ะฝะฐ ะบะฐััะต
ax = gdf_web_mercator.plot(figsize=(10, 8), alpha=0.5, color='red')

# ะจะฐะณ 4: ะะพะฑะฐะฒะปัะตะผ ัะพะฝะพะฒัั ะบะฐััั (ัะฐะนะปั)
ctx.add_basemap(ax, source=ctx.providers.Stamen.TonerLite)

# ะะฐัััะฐะธะฒะฐะตะผ ะฒะธะดะธะผะพััั ะพัะตะน
ax.set_axis_off()

plt.title("Top City Businesses on a Real Map")
plt.show()
ะ ัะตะทัะปััะฐัะต ะฟะพะปััะธัะต ะบัะฐัะธะฒัั ะบะฐััั ั ัะพัะบะฐะผะธ. ะะพะถะฝะพ ะฝะฐัััะฐะธะฒะฐัั ัะฐะทะฝัะต ะฟัะพะฒะฐะนะดะตัั ัะฐะนะปะพะฒ (OpenStreetMap, Stamen, Carto ะธ ั.ะด.).

3. Plotly (Scatter Mapbox)
ะัะปะธ ะฒั ัะพัะธัะต ะธะฝัะตัะฐะบัะธะฒะฝัั ะบะฐััั (ะบะฐะบ ะฒ Folium), ะฝะพ ะฒ ััะธะปะต Plotly, ะธัะฟะพะปัะทัะนัะต plotly.express ั scatter_mapbox ะธะปะธ scatter_geo. ะะฐะฟัะธะผะตั:

python
ะะพะฟะธัะพะฒะฐัั
import plotly.express as px

fig = px.scatter_mapbox(
    top_city_businesses, 
    lat="latitude", 
    lon="longitude", 
    hover_name="business_name", 
    hover_data=["city", "business_id"],
    zoom=10,
    height=600
)

# ะัะฑะธัะฐะตะผ ััะธะปั ะบะฐััั. "open-street-map" ะฝะต ััะตะฑัะตั ะบะปััะตะน.
fig.update_layout(mapbox_style="open-street-map")

# ะฃะฑะธัะฐะตะผ ะปะธัะฝะธะต ะพััััะฟั
fig.update_layout(margin={"r":0,"t":0,"l":0,"b":0})

fig.show()
ะัะตะธะผััะตััะฒะฐ:

ะัะฐัะธะฒัะต ะธะฝัะตัะฐะบัะธะฒะฝัะต ะณัะฐัะธะบะธ Plotly ะฟััะผะพ ะฒ Jupyter Notebook ะธะปะธ ะฑัะฐัะทะตัะต.
ะะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ัะฐะทะฝัะต ััะธะปะธ ะบะฐัั (Mapbox, OpenStreetMap, Carto ะธ ั.ะด.).
ะะตะดะพััะฐัะบะธ:

ะะตะบะพัะพััะต ััะธะปะธ ะบะฐัั (ะฝะฐะฟัะธะผะตั, Mapbox) ะผะพะณัั ััะตะฑะพะฒะฐัั ะทะฐัะตะณะธัััะธัะพะฒะฐะฝะฝัะน ัะพะบะตะฝ (API key).
ะ ะพัะปะธัะธะต ะพั Folium, Plotly ะฝะต ัะฐะบ ะฟัะพััะพ ัะฐััะธัััั ะฟะปะฐะณะธะฝะฐะผะธ, ะฝะพ ะฒะพะทะผะพะถะฝะพััะตะน ั Plotly ัะพะถะต ะผะฝะพะณะพ.
ะะตะทัะผะต
Folium โ ะฟัะพััะพะต ัะตัะตะฝะธะต ะดะปั ะธะฝัะตัะฐะบัะธะฒะฝะพะน ะบะฐััั, ะฒัะฒะพะดะธั HTML (Leaflet).
GeoPandas + Contextily โ ยซะฟะธัะพะฝะธัะฝัะนยป ัะฟะพัะพะฑ ะดะปั ะณะตะพะดะฐะฝะฝัั: ะผะพะถะฝะพ ัะฐะฑะพัะฐัั ั ะฟัะพัััะฐะฝััะฒะตะฝะฝัะผะธ ะพะฟะตัะฐัะธัะผะธ, ะฐ ะทะฐัะตะผ ยซะฟะพะดะปะพะถะธััยป ัะฐะนะปั OSM.
Plotly โ ะธะฝัะตัะฐะบัะธะฒะฝัะต ะบะฐััั ะฒ ััะธะปะต Plotly, ะบัะฐัะธะฒะพ ะธ ะณะธะฑะบะพ.
ะัะฑะธัะฐะนัะต ะฟะพะดัะพะด ะฒ ะทะฐะฒะธัะธะผะพััะธ ะพั ัะพะณะพ, ะบะฐะบะพะน ััะฝะบัะธะพะฝะฐะป ะฒะฐะผ ะฝัะถะตะฝ ะธ ะณะดะต ะฒั ัะพะฑะธัะฐะตัะตัั ะดะตะผะพะฝัััะธัะพะฒะฐัั ะบะฐััั.






ะั ัะบะฐะทะฐะปะธ:
ะะพะฟัะพะฑะพะฒะฐะป ัะดะตะปะฐัั ัะฐะบ. ะะฐััะฐ ะพะบะฐะทะฐะปะฐัั ัะปะธัะบะพะผ ะฟะตัะตะณััะถะตะฝะฝะพะน, ััะพ ะณััะทะธััั ัะปะธัะบะพะผ ะดะพะปะณะพ ะธ ัะธะปัะฝะพ ะปะฐะณะฐะตั. ะขะฐะผ ะธัะฟะพะปัะทััััั ัะตะฝะธ ะดะปั ะผะฐัะบะตัะพะฒ. ะะพะถะตั, ะผะพะถะฝะพ ะธั ะธ ะตัะต ััะพ-ัะพ ัะฑัะฐัั, ััะพะฑั ะพะฟัะธะผะธะทะธัะพะฒะฐัั ะบะฐััั? 
ะะฐัััะถะดะฐะปะฐ ะดะปั 38 ัะตะบัะฝะด
ะะพะณะดะฐ ะฝะฐ ะบะฐััั ะฒ Folium ะฒัะฒะพะดะธััั ะพัะตะฝั ะผะฝะพะณะพ ะผะฐัะบะตัะพะฒ, ััะพ ะผะพะถะตั ะฟัะธะฒะตััะธ ะบ ะฟะตัะตะณััะทะบะต ะธ ะทะฐะผะตะดะปะตะฝะธั ะพัะพะฑัะฐะถะตะฝะธั, ะพัะพะฑะตะฝะฝะพ ะตัะปะธ ะธัะฟะพะปัะทัะตััั ะดะตัะพะปัะฝัะน Marker ั ัะตะฝัั. ะะธะถะต ะฝะตัะบะพะปัะบะพ ัะฟะพัะพะฑะพะฒ ะพะฟัะธะผะธะทะธัะพะฒะฐัั ะบะฐััั:

1. ะฃะฑัะฐัั ัะตะฝะธ ะธ ะธัะฟะพะปัะทะพะฒะฐัั ะฑะพะปะตะต ะปัะณะบะธะน ัะธะฟ ะผะฐัะบะตัะฐ
ะ Folium ะฟะพ ัะผะพะปัะฐะฝะธั Marker ะผะพะถะตั ะฒะบะปััะฐัั ัะตะฝั. ะงัะพะฑั ััะพะณะพ ะธะทะฑะตะถะฐัั, ะผะพะถะฝะพ:

ะัะฟะพะปัะทะพะฒะฐัั CircleMarker, ั ะบะพัะพัะพะณะพ ะฝะตั ะธะบะพะฝะบะธ ะธ ัะตะฝะธ (ะฒะธะทัะฐะปัะฝะพ โ ะฟัะพััะพ ะบััะณ).
ะะฐะดะฐัั ะธะบะพะฝะบั ะฑะตะท ัะตะฝะธ (ะฝะฐะฟัะธะผะตั, folium.Icon(icon='circle', prefix='fa', icon_color='white', color='blue')).
ะัะธะผะตั ั CircleMarker (ะบะฐะถะดะฐั ัะพัะบะฐ ะฑัะดะตั ะพัะพะฑัะฐะถะฐัััั ะบะฐะบ ะบััะณ):

python
ะะพะฟะธัะพะฒะฐัั
import folium

m = folium.Map(location=[start_lat, start_lon], zoom_start=10)

for idx, row in top_city_businesses.iterrows():
    folium.CircleMarker(
        location=[row['latitude'], row['longitude']],
        radius=4,            # ัะฐะดะธัั ะบััะณะฐ
        color='blue',        # ัะฒะตั ะพะฑะฒะพะดะบะธ
        fill=True,
        fill_color='blue',   # ัะฒะตั ะทะฐะปะธะฒะบะธ
        fill_opacity=0.5
    ).add_to(m)

m.save('my_map.html')
m
ะัะตะธะผััะตััะฒะฐ ััะพะณะพ ะฟะพะดัะพะดะฐ:
ะะตั ยซะธะบะพะฝะบะธยป ะธ ยซัะตะฝะธยป, ะฟะพััะพะผั ะพััะธัะพะฒะบะฐ ะฟัะพัะต ะธ ะฑััััะตะต.
ะัะธ ะฑะพะปััะพะผ ะบะพะปะธัะตััะฒะต ัะพัะตะบ ัะฐะบะฐั ะฒะธะทัะฐะปะธะทะฐัะธั ะทะฐัะฐัััั ะฒัะณะปัะดะธั ะฐะบะบััะฐัะฝะตะต, ัะตะผ ยซะณะฒะพะทะดะธะบะธยป Marker.
2. ะัะฟะพะปัะทะพะฒะฐัั MarkerCluster
ะัะปะธ ัะพัะตะบ ะดะตะนััะฒะธัะตะปัะฝะพ ะผะฝะพะณะพ, ััะพะธั ัะณััะฟะฟะธัะพะฒะฐัั ะธั ะฒ ะบะปะฐััะตัั (MarkerCluster). ะขะพะณะดะฐ ะฝะฐ ะฑะพะปััะธั ะผะฐัััะฐะฑะฐั (ะณะดะต ัะพัะตะบ ะฒะธะดะฝะพ ััะฐะทั ะผะฝะพะณะพ) ะฑัะดะตั ะพัะพะฑัะฐะถะฐัััั ะพะดะธะฝ ะบะปะฐััะตั, ะฐ ะฟัะธ ะฟัะธะฑะปะธะถะตะฝะธะธ โ ะพะฝ ะฑัะดะตั ัะฐัะบััะฒะฐัััั ะฒ ะพัะดะตะปัะฝัะต ัะพัะบะธ. ะญัะพ ัะธะปัะฝะพ ะพะฑะปะตะณัะฐะตั ัะตะฝะดะตัะธะฝะณ.

ะัะธะผะตั:

python
ะะพะฟะธัะพะฒะฐัั
import folium
from folium.plugins import MarkerCluster

m = folium.Map(location=[start_lat, start_lon], zoom_start=10)

marker_cluster = MarkerCluster().add_to(m)

for idx, row in top_city_businesses.iterrows():
    folium.Marker(
        location=[row['latitude'], row['longitude']],
        popup=row['business_name'],
        icon=folium.Icon(icon='circle', prefix='fa', color='blue', icon_color='white')
    ).add_to(marker_cluster)

m.save('my_map_cluster.html')
m
ะัะตะธะผััะตััะฒะฐ ััะพะณะพ ะฟะพะดัะพะดะฐ:
ะะผะตััะพ ััััั ะผะฐัะบะตัะพะฒ ะฝะฐ ัะบัะฐะฝะต ะฒั ะฒะธะดะธัะต ัะณััะฟะฟะธัะพะฒะฐะฝะฝัะต ะบะปะฐััะตัั.
ะัะพะฑัะฐะถะตะฝะธะต ัะฐะฑะพัะฐะตั ะฑััััะตะต, ั.ะบ. ะฟัะธ ะทัะผะต ะฟัะพะธััะพะดะธั ะดะธะฝะฐะผะธัะตัะบะพะต ัะฐัะฟัะตะดะตะปะตะฝะธะต ัะพัะตะบ.
ะะพะถะฝะพ ะฝะฐัััะพะธัั ะฒะฝะตัะฝะธะน ะฒะธะด ะบะปะฐััะตัะฐ, ะฒัะฟะปัะฒะฐััะธะต ะฟะพะดัะบะฐะทะบะธ ะธ ั.ะด.
3. ะััะณะธะต ัะฟะพัะพะฑั ะพะฟัะธะผะธะทะฐัะธะธ
HeatMap
ะัะปะธ ะฒะฐะถะฝะพ ะฟะพะบะฐะทะฐัั ยซะฟะปะพัะฝะพัััยป ัะฐัะฟะพะปะพะถะตะฝะธั, ะผะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั folium.plugins.HeatMap. ะขะพะณะดะฐ ะฝะฐ ะบะฐััะต ะฝะต ะฑัะดะตั ะพัะดะตะปัะฝัั ะผะฐัะบะตัะพะฒ, ะฐ ะปะธัั ยซัะตะฟะปะพะฒัะต ะฟััะฝะฐยป ะฟะปะพัะฝัั ัะบะพะฟะปะตะฝะธะน.

ะะณัะฐะฝะธัะตะฝะธะต ะบะพะปะธัะตััะฒะฐ ัะพัะตะบ
ะะฝะพะณะดะฐ ััะพะธั ะฟะพะดัะผะฐัั ะพ ัะธะปัััะฐัะธะธ ะดะฐะฝะฝัั ะธะปะธ ะฒัะฒะพะดะต ะปะธัั ัะฐััะธ ัะพัะตะบ (ะฝะฐะฟัะธะผะตั, ะตัะปะธ ั ะฒะฐั 100k+ ะทะฐะฟะธัะตะน, ะฒะพะทะผะพะถะฝะพ, ะธะผะตะตั ัะผััะป ะฒัะฒะพะดะธัั ะฒัะฑะพัะบั).

ะฃะผะตะฝััะตะฝะธะต ัะฐะดะธััะฐ/ัะฐะทะผะตัะฐ ะผะฐัะบะตัะพะฒ
ะััะฟะฝัะต ะผะฐัะบะตัั ะผะพะณัั ะผะตัะฐัั ะดััะณ ะดััะณั, ััะพะธั ัะดะตะปะฐัั ะธั ะฟะพะผะตะฝััะต.

ะัะพัะธะต ะฝะฐัััะพะนะบะธ Leaflet
Folium ะพะฑััะฝัั ะฝะฐะด Leaflet.js, ะฟะพััะพะผั ัะฐััั ะฝะธะทะบะพััะพะฒะฝะตะฒัั ะฝะฐัััะพะตะบ (ะฝะฐะฟัะธะผะตั, ะพัะบะปััะตะฝะธะต ัะตะฝะตะน) ะผะพะถะฝะพ ัะดะตะปะฐัั ัะตัะตะท ะฟะพะปัะทะพะฒะฐัะตะปััะบะธะต ะธะบะพะฝะบะธ ะธะปะธ Icon/CustomIcon.

ะัะฒะพะด
ะัะปะธ ะผะฐัะบะตัะพะฒ ะพัะตะฝั ะผะฝะพะณะพ, ะปัััะธะน ะฒะฐัะธะฐะฝั โ MarkerCluster ะธะปะธ HeatMap.
ะัะปะธ ะฝัะถะฝะพ ะผะฐะบัะธะผะฐะปัะฝะพ ะฟัะพััะพ, ะธัะฟะพะปัะทัะนัะต CircleMarker (ะฑะตะท ัะตะฝะตะน ะธ ะธะบะพะฝะพะบ), ััะพ ัะผะตะฝััะฐะตั ะฝะฐะณััะทะบั.
ะะพะดัะผะฐะนัะต ะพ ัะธะปัััะฐัะธะธ ะดะฐะฝะฝัั ะธะปะธ ะฒัะฑะพัะบะต ะฟะพะดะผะฝะพะถะตััะฒะฐ, ะตัะปะธ dataset ัะปะธัะบะพะผ ะฒะตะปะธะบ.
ะัะต ััะธ ะฟะพะดัะพะดั ะฟัะธะทะฒะฐะฝั ัะผะตะฝััะธัั ะฝะฐะณััะทะบั ะฝะฐ ัะตะฝะดะตัะธะฝะณ ะธ ัะปัััะธัั ะฟะพะปัะทะพะฒะฐัะตะปััะบะธะน ะพะฟัั ะฟัะธ ัะฐะฑะพัะต ั ะธะฝัะตัะฐะบัะธะฒะฝะพะน ะบะฐััะพะน.






ะั ัะบะฐะทะฐะปะธ:
ะฝะฐะฟะธัะธ ััะฝะบัะธั, ะบะพัะพัะฐั ะฒััะธัะปัะตั ัะฐัััะพัะฝะธะต ะผะตะถะดั ะดะฒัะผั ัะพัะบะฐะผะธ ะฟะพ ะดะพะปะณะพัะต ะธ ัะธัะพัะต 
ะะฐัััะถะดะฐะปะฐ ะดะปั 10 ัะตะบัะฝะด
ะะธะถะต ะฟัะธะฒะตะดะตะฝะฐ ััะฝะบัะธั, ะฒััะธัะปัััะฐั ัะฐัััะพัะฝะธะต ะผะตะถะดั ะดะฒัะผั ัะพัะบะฐะผะธ (ะฟะพ ะดะพะปะณะพัะต ะธ ัะธัะพัะต) ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ัะพัะผัะปั ะณะฐะฒะตััะธะฝััะพะฒ:

python
ะะพะฟะธัะพะฒะฐัั
import math

def haversine_distance(lat1, lon1, lat2, lon2):
    """
    ะััะธัะปัะตั ัะฐัััะพัะฝะธะต ะผะตะถะดั ะดะฒัะผั ัะพัะบะฐะผะธ ะฝะฐ ะฟะพะฒะตััะฝะพััะธ ะะตะผะปะธ,
    ะทะฐะดะฐะฝะฝัะผะธ ัะธัะพัะพะน ะธ ะดะพะปะณะพัะพะน, ะธัะฟะพะปัะทัั ัะพัะผัะปั ะณะฐะฒะตััะธะฝััะพะฒ.

    ะะฐัะฐะผะตััั:
        lat1, lon1: ัะธัะพัะฐ ะธ ะดะพะปะณะพัะฐ ะฟะตัะฒะพะน ัะพัะบะธ (ะฒ ะณัะฐะดััะฐั)
        lat2, lon2: ัะธัะพัะฐ ะธ ะดะพะปะณะพัะฐ ะฒัะพัะพะน ัะพัะบะธ (ะฒ ะณัะฐะดััะฐั)

    ะะพะทะฒัะฐัะฐะตั:
        ะะฐัััะพัะฝะธะต ะผะตะถะดั ัะพัะบะฐะผะธ ะฒ ะบะธะปะพะผะตััะฐั.
    """
    # ะัะตะพะฑัะฐะทัะตะผ ะณัะฐะดััั ะฒ ัะฐะดะธะฐะฝั
    lat1, lon1, lat2, lon2 = map(math.radians, [lat1, lon1, lat2, lon2])
    
    # ะััะธัะปัะตะผ ัะฐะทะฝะธัั ะผะตะถะดั ะบะพะพัะดะธะฝะฐัะฐะผะธ
    dlat = lat2 - lat1
    dlon = lon2 - lon1
    
    # ะคะพัะผัะปะฐ ะณะฐะฒะตััะธะฝััะพะฒ
    a = math.sin(dlat/2)**2 + math.cos(lat1) * math.cos(lat2) * math.sin(dlon/2)**2
    c = 2 * math.asin(math.sqrt(a))
    
    # ะะฐะดะธัั ะะตะผะปะธ ะฒ ะบะธะปะพะผะตััะฐั (ะฟัะธะผะตัะฝะพ 6371 ะบะผ)
    R = 6371
    return R * c

# ะัะธะผะตั ะธัะฟะพะปัะทะพะฒะฐะฝะธั:
distance = haversine_distance(55.7558, 37.6176, 59.9343, 30.3351)
print(f"ะะฐัััะพัะฝะธะต: {distance:.2f} ะบะผ")
ะะพััะฝะตะฝะธะต:
ะัะตะพะฑัะฐะทะพะฒะฐะฝะธะต ะณัะฐะดััะพะฒ ะฒ ัะฐะดะธะฐะฝั:
ะะปั ะฒััะธัะปะตะฝะธะน ะฒ ััะธะณะพะฝะพะผะตััะธัะตัะบะธั ััะฝะบัะธัั ะฝะตะพะฑัะพะดะธะผะพ ะฟะตัะตะฒะตััะธ ะทะฝะฐัะตะฝะธั ัะธัะพัั ะธ ะดะพะปะณะพัั ะธะท ะณัะฐะดััะพะฒ ะฒ ัะฐะดะธะฐะฝั.

ะคะพัะผัะปะฐ ะณะฐะฒะตััะธะฝััะพะฒ:
ะััะธัะปัะตั ัะตะฝััะฐะปัะฝัะน ัะณะพะป ะผะตะถะดั ะดะฒัะผั ัะพัะบะฐะผะธ ะฝะฐ ััะตัะต, ะฟะพัะปะต ัะตะณะพ ัะผะฝะพะถะฐะตััั ะฝะฐ ัะฐะดะธัั ะะตะผะปะธ, ััะพะฑั ะฟะพะปััะธัั ัะฐัััะพัะฝะธะต.

ะะฐะดะธัั ะะตะผะปะธ:
ะัะธะฝะธะผะฐะตััั ัะฐะฒะฝัะผ 6371 ะบะผ (ััะตะดะฝะตะต ะทะฝะฐัะตะฝะธะต).

ะ ัะตะทัะปััะฐัะต ััะฝะบัะธั ะฒะพะทะฒัะฐัะฐะตั ัะฐัััะพัะฝะธะต ะผะตะถะดั ะดะฒัะผั ัะพัะบะฐะผะธ ะฒ ะบะธะปะพะผะตััะฐั.






ะั ัะบะฐะทะฐะปะธ:
ััะพ ะฝะต ัะฐะบ 

top_city_businesses['dist'] = [haversine_distance(top_city_businesses['latitude'].iloc[i], top_city_businesses['longitude'].iloc[i]) for i in range(len(top_city_businesses['latitude']))]
top_city_businesses
ะะฐัััะถะดะฐะปะฐ ะดะปั 14 ัะตะบัะฝะด
ะัะพะฑะปะตะผะฐ ะฒ ัะพะผ, ััะพ ััะฝะบัะธั haversine_distance ะพะฟัะตะดะตะปะตะฝะฐ ะดะปั ัะฐััััะฐ ัะฐัััะพัะฝะธั ะผะตะถะดั ะดะฒัะผั ัะพัะบะฐะผะธ ะธ ััะตะฑัะตั ัะตัััะต ะฐัะณัะผะตะฝัะฐ:

lat1, lon1 โ ะบะพะพัะดะธะฝะฐัั ะฟะตัะฒะพะน ัะพัะบะธ
lat2, lon2 โ ะบะพะพัะดะธะฝะฐัั ะฒัะพัะพะน ัะพัะบะธ
ะ ะฒะฐัะตะผ ะบะพะดะต ะฒั ะฟะตัะตะดะฐััะต ัะพะปัะบะพ ะดะฒะฐ ะฐัะณัะผะตะฝัะฐ (ัะธัะพัั ะธ ะดะพะปะณะพัั ะธะท DataFrame), ะฟะพััะพะผั Python ะฒัะดะฐัั ะพัะธะฑะบั ะพ ะฝะตัะพะพัะฒะตัััะฒะธะธ ะบะพะปะธัะตััะฒะฐ ะฐัะณัะผะตะฝัะพะฒ.

ะงัะพะฑั ะธัะฟัะฐะฒะธัั ัะธััะฐัะธั, ะฝัะถะฝะพ ัะบะฐะทะฐัั ะบะพะพัะดะธะฝะฐัั ะฒัะพัะพะน ัะพัะบะธ. ะะฐะฟัะธะผะตั, ะตัะปะธ ะฒั ัะพัะธัะต ะฒััะธัะปะธัั ัะฐัััะพัะฝะธะต ะพั ะบะฐะถะดะพะน ัะพัะบะธ ะดะพ ะบะฐะบะพะน-ัะพ ัะธะบัะธัะพะฒะฐะฝะฝะพะน ัะพัะบะธ (ัะบะฐะถะตะผ, ะดะพ ัะตะฝััะฐ ะณะพัะพะดะฐ), ะทะฐะดะฐะนัะต ะตั ะบะพะพัะดะธะฝะฐัั, ะฝะฐะฟัะธะผะตั:

python
ะะพะฟะธัะพะฒะฐัั
# ะะพะพัะดะธะฝะฐัั ัะธะบัะธัะพะฒะฐะฝะฝะพะน ัะพัะบะธ (ะฟัะธะผะตั: ัะตะฝัั ะณะพัะพะดะฐ)
ref_lat = 55.7558  # ะฟัะธะผะตั: ัะธัะพัะฐ ะะพัะบะฒั
ref_lon = 37.6176  # ะฟัะธะผะตั: ะดะพะปะณะพัะฐ ะะพัะบะฒั

top_city_businesses['dist'] = [
    haversine_distance(
        top_city_businesses['latitude'].iloc[i],
        top_city_businesses['longitude'].iloc[i],
        ref_lat,
        ref_lon
    )
    for i in range(len(top_city_businesses))
]
ะัะปะธ ะถะต ะฒั ะฟะปะฐะฝะธััะตัะต ะฒััะธัะปััั ัะฐัััะพัะฝะธะต ะผะตะถะดั ะฟะฐัะพะน ัะพัะตะบ, ัะพ ะฒะฐะผ ะฝัะถะฝะพ ะฟัะฐะฒะธะปัะฝะพ ะพัะณะฐะฝะธะทะพะฒะฐัั ะฟะตัะตะดะฐัั ะดะฐะฝะฝัั ะดะปั ะพะฑะตะธั ัะพัะตะบ.

ะขะฐะบะถะต ััะพะธั ัะฐััะผะพััะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ะผะตัะพะดะฐ apply ะดะปั ะฑะพะปะตะต ยซะฟะธัะพะฝะธัะฝะพะณะพยป ัะตัะตะฝะธั:

python
ะะพะฟะธัะพะฒะฐัั
top_city_businesses['dist'] = top_city_businesses.apply(
    lambda row: haversine_distance(row['latitude'], row['longitude'], ref_lat, ref_lon),
    axis=1
)
ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะฝะตะพะฑัะพะดะธะผะพ ะดะพะฑะฐะฒะธัั ะฝะตะดะพััะฐััะธะต ะฐัะณัะผะตะฝัั (ะบะพะพัะดะธะฝะฐัั ะฒัะพัะพะน ัะพัะบะธ) ะฒ ะฒัะทะพะฒ ััะฝะบัะธะธ.






ะั ัะบะฐะทะฐะปะธ:
ะะตั, lat2, lon2 โ ะบะพะพัะดะธะฝะฐัั ะฒัะพัะพะน ัะพัะบะธ, ั ะผะตะฝั ะฒัััะฐะฒะปะตะฝั ะฟะพ ัะผะพะปัะฐะฝะธั, ะฟะพััะพะผั ะฝะตะพะฑัะทะฐัะตะปัะฝั. 

ะฏ ะพะฑัะฐัะฐั ะฒะฝะธะผะฐะฝะธะต ะฝะฐ ัะพ, ััะพ ะธะทะฝะฐัะฐะปัะฝะพ ััะพะปะฑัะฐ dist ะฒ ัะฐะฑะปะธัะต ะฝะต ะฑัะปะพ, ะธ ั ะฟััะฐััั ะตะณะพ ะดะพะฑะฐะฒะธัั, ัะฐะบ, ะฒ ัะตะผ ะถะต ะฟัะพะฑะปะตะผะฐ? 
ะะพะฟัะพั ะฒ ัะพะผ, ััะพ ะฒั ะธัะฟะพะปัะทัะตัะต `top_city_businesses['dist'] = [...]`, ััะพ ะฟััะฐะตััั ะดะพะฑะฐะฒะธัั ะฝะพะฒัะน ััะพะปะฑะตั ะฒ DataFrame, ะธ ะดะตะปะฐะตั ััะพ ัะตัะตะท ัะฟะธัะบะพะฒะพะต ะฒััะฐะถะตะฝะธะต (list comprehension). ะะดะฝะฐะบะพ pandas ะพะถะธะดะฐะตั, ััะพ ะฒั ะฑัะดะตัะต ัะฐะฑะพัะฐัั ั ัะตะปัะผะธ ััะพะปะฑัะฐะผะธ ะดะฐะฝะฝัั, ะฐ ะฝะต ัะฟะธัะบะฐะผะธ ั ะฒััะธัะปะตะฝะธัะผะธ. ะะพะณะดะฐ ะฒั ะดะพะฑะฐะฒะปัะตัะต ะฝะพะฒัะน ััะพะปะฑะตั ั ะฟะพะผะพััั ััะพะณะพ ัะฟะพัะพะฑะฐ, pandas ะฟััะฐะตััั ัะฒัะทะฐัั ะฒัะต ัะปะตะผะตะฝัั ะฟะพ ะธะฝะดะตะบัะฐะผ โ ะธ ะตัะปะธ ะธะฝะดะตะบัั ะฝะต ัะพะฒะฟะฐะดะฐัั ะธะปะธ ะตัะปะธ ััะพะปะฑะตั ะดะพะฑะฐะฒะปัะตััั ัะตัะตะท ัะฐะบัั ัะปะพะถะฝัั ะบะพะฝััััะบัะธั, ะผะพะณัั ะฒะพะทะฝะธะบะฐัั ะฟัะพะฑะปะตะผั ั ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพัััั ะธะปะธ ัะตะทัะปััะฐัะพะผ. ะะปั ัะพะณะพ ััะพะฑั ะบะพััะตะบัะฝะพ ะธ ัััะตะบัะธะฒะฝะพ ะดะพะฑะฐะฒะธัั ะฝะพะฒัะน ััะพะปะฑะตั ะฒ DataFrame, ะฟะพะฟัะพะฑัะนัะต ะธัะฟะพะปัะทะพะฒะฐัั ััะฝะบัะธั pandas **`apply()`**, ะบะพัะพัะฐั ะฟะพะทะฒะพะปัะตั ะฟัะธะผะตะฝะธัั ะฒะฐัั ััะฝะบัะธั ะฟะพ ะบะฐะถะดะพะน ัััะพะบะต (ะธะปะธ ััะพะปะฑัั). ะะพั ะฟัะธะผะตั ัะพะณะพ, ะบะฐะบ ััะพ ะผะพะถะฝะพ ัะดะตะปะฐัั: ```python # ะัะตะดะฟะพะปะฐะณะฐะตะผ, ััะพ haversine_distance ัะถะต ะพะฟัะตะดะตะปะตะฝะฐ # ะะพะพัะดะธะฝะฐัั ะฒัะพัะพะน ัะพัะบะธ (ะฝะฐะฟัะธะผะตั, ะบะฐะบะพะณะพ-ัะพ ะณะพัะพะดะฐ; ะทะฐะผะตะฝะธัะต ะฝะฐ ะฝัะถะฝัะต) ref_lat = 55.7558 # ะจะธัะพัะฐ (ะฝะฐะฟัะธะผะตั, ะะพัะบะฒั) ref_lon = 37.6176 # ะะพะปะณะพัะฐ (ะฝะฐะฟัะธะผะตั, ะะพัะบะฒั) # ะขะตะฟะตัั ะดะพะฑะฐะฒะปัะตะผ ะฝะพะฒัะน ััะพะปะฑะตั 'dist' ะฒ DataFrame top_city_businesses['dist'] = top_city_businesses.apply( lambda row: haversine_distance(row['latitude'], row['longitude'], ref_lat, ref_lon), axis=1 ) # ะะพัะผะพััะตัั ะพะฑะฝะพะฒะปะตะฝะฝัะน DataFrame print(top_city_businesses) ``` ### ะะพััะฝะตะฝะธะต: 1. **`apply()`** โ ััะพ ัะดะพะฑะฝัะน ะผะตัะพะด pandas ะดะปั ะฟัะธะผะตะฝะตะฝะธั ััะฝะบัะธะธ ะบ ะบะฐะถะดะพะน ัััะพะบะต ะธะปะธ ััะพะปะฑัั. 2. **`axis=1`** โ ะพะทะฝะฐัะฐะตั, ััะพ ััะฝะบัะธั ะฑัะดะตั ะฟัะธะผะตะฝััััั ะฟะพ ัััะพะบะฐะผ, ะณะดะต ะบะฐะถะดะฐั ัััะพะบะฐ ะฟะตัะตะดะฐะตััั ะบะฐะบ ะพะฑัะตะบั **Series**. 3. **`lambda row: haversine_distance(...)`** โ ััะพ ะตัะต ะพะดะฝะฐ ััะฝะบัะธั, ะบะพัะพัะฐั ะฟัะธะฝะธะผะฐะตั ัััะพะบั (`row`) ะธ ะธัะฟะพะปัะทัะตั ะตั ะบะพะพัะดะธะฝะฐัั ะดะปั ะฒััะธัะปะตะฝะธั ัะฐัััะพัะฝะธั. ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ััะพั ัะฟะพัะพะฑ ัะฒะปัะตััั ะฑะพะปะตะต ะฟะธัะพะฝะธัะฝัะผ ะธ ะฑัะดะตั ัะฐะฑะพัะฐัั ะฑััััะตะต, ัะตะผ ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ัะฟะธัะบะพะฒะพะณะพ ะฒััะฐะถะตะฝะธั, ะดะฐะถะต ะตัะปะธ ัะฐะฑะปะธัะฐ ะดะพะฒะพะปัะฝะพ ะฑะพะปััะฐั. ### ะะฐะถะฝะพะต ะทะฐะผะตัะฐะฝะธะต: - ะฃะฑะตะดะธัะตัั, ััะพ ะฒ ะฒะฐัะตะผ DataFrame **`top_city_businesses`** ะดะตะนััะฒะธัะตะปัะฝะพ ะตััั ััะพะปะฑัั `latitude` ะธ `longitude`. ะัะปะธ ะพะฝะธ ะตััั, ะบะพะด ะดะพะปะถะตะฝ ัะฐะฑะพัะฐัั ะฟัะฐะฒะธะปัะฝะพ. ะดะปั 41 ัะตะบัะฝะด
ะัะปะธ ััะฝะบัะธั haversine_distance ะดะตะนััะฒะธัะตะปัะฝะพ ะพะฟัะตะดะตะปะตะฝะฐ ัะฐะบ, ััะพ ั ะฝะตั ัะถะต ะตััั ะทะฝะฐัะตะฝะธั ะฟะพ ัะผะพะปัะฐะฝะธั ะดะปั lat2 ะธ lon2 (ะฝะฐะฟัะธะผะตั, ัะตัะตะท ะฟะฐัะฐะผะตััะธะทะฐัะธั defaultโะทะฝะฐัะตะฝะธัะผะธ), ัะพ ะฟัะพะฑะปะตะผ ั ัะธัะปะพะผ ะฐัะณัะผะตะฝัะพะฒ ะฑััั ะฝะต ะดะพะปะถะฝะพ. ะ ััะพะผ ัะปััะฐะต ะฒะฐั ะบะพะด

python
ะะพะฟะธัะพะฒะฐัั
top_city_businesses['dist'] = [
    haversine_distance(top_city_businesses['latitude'].iloc[i],
                       top_city_businesses['longitude'].iloc[i])
    for i in range(len(top_city_businesses['latitude']))
]
ะดะพะปะถะตะฝ ัะฐะฑะพัะฐัั, ะตัะปะธ:

ะกัะพะปะฑัั 'latitude' ะธ 'longitude' ะดะตะนััะฒะธัะตะปัะฝะพ ัััะตััะฒััั ะฒ DataFrame ะธ ัะพะดะตัะถะฐั ัะธัะปะพะฒัะต ะทะฝะฐัะตะฝะธั (ัะธะฟ float ะธะปะธ int).

DataFrame top_city_businesses ะฝะต ัะฒะปัะตััั "ะบะพะฟะธะตะน" ั ัะตะฟะพัะตัะฝัะผ ะธะฝะดะตะบัะธัะพะฒะฐะฝะธะตะผ (ััะพ ะผะพะถะตั ะฒัะทะฒะฐัั ะฟัะตะดัะฟัะตะถะดะตะฝะธั ะธะปะธ ะฝะตะฟัะตะดัะบะฐะทัะตะผะพะต ะฟะพะฒะตะดะตะฝะธะต). ะัะปะธ ะฒั ะฟะพะปััะธะปะธ ะฟัะตะดัะฟัะตะถะดะตะฝะธะต ะฒะธะดะฐ SettingWithCopyWarning, ะฟะพะฟัะพะฑัะนัะต ัะฝะฐัะฐะปะฐ ัะดะตะปะฐัั ัะฒะฝัั ะบะพะฟะธั:

python
ะะพะฟะธัะพะฒะฐัั
top_city_businesses = top_city_businesses.copy()
ะะฝะฐัะตะฝะธั ะฒ ััะพะปะฑัะฐั ะดะตะนััะฒะธัะตะปัะฝะพ ะบะพััะตะบัะฝั ะธ ะฝะต ัะพะดะตัะถะฐั, ะฝะฐะฟัะธะผะตั, ัััะพะบ, ะบะพัะพััะต ะฝะตะปัะทั ะฟัะตะพะฑัะฐะทะพะฒะฐัั ะฒ ัะธัะปะฐ.

ะะฐะบ ะฒะฐัะธะฐะฝั, ัะฐััะพ ะฑะพะปะตะต ะธะดะธะพะผะฐัะธัะฝะพ ะธ ัััะตะบัะธะฒะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ะผะตัะพะด apply ะดะปั ะฟะพะดะพะฑะฝะพะณะพ ะฟะพัััะพัะฝะพะณะพ ะฒััะธัะปะตะฝะธั. ะะฐะฟัะธะผะตั:

python
ะะพะฟะธัะพะฒะฐัั
top_city_businesses['dist'] = top_city_businesses.apply(
    lambda row: haversine_distance(row['latitude'], row['longitude']), axis=1
)
ะขะฐะบะพะน ะฟะพะดัะพะด:

ะะทะฑะตะณะฐะตั ัะฒะฝะพะณะพ ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะธะฝะดะตะบัะพะฒ ัะตัะตะท iloc,
ะะพะถะตั ะฑััั ัััั ะฟัะพัะต ะดะปั ะฟะพะฝะธะผะฐะฝะธั,
ะ ัะฐััะพ ัะฐะฑะพัะฐะตั ะฑััััะตะต ะดะปั ะฝะตะฑะพะปััะธั DataFrame.
ะัะปะธ ะฟะพัะปะต ััะธั ะฟัะพะฒะตัะพะบ ะฟัะพะฑะปะตะผะฐ ัะพััะฐะฝัะตััั, ัะฑะตะดะธัะตัั, ััะพ:

ะคัะฝะบัะธั haversine_distance ะดะตะนััะฒะธัะตะปัะฝะพ ะพะฟัะตะดะตะปะตะฝะฐ ั ะฟะฐัะฐะผะตััะฐะผะธ ะฟะพ ัะผะพะปัะฐะฝะธั ะดะปั ะฒัะพัะพะน ัะพัะบะธ, ะฝะฐะฟัะธะผะตั:
python
ะะพะฟะธัะพะฒะฐัั
def haversine_distance(lat1, lon1, lat2=55.7558, lon2=37.6176):
    # ะบะพะด ัะฐััะตัะฐ
ะะตั ะพะฟะตัะฐัะพะบ ะฒ ะฝะฐะทะฒะฐะฝะธัั ััะพะปะฑัะพะฒ.
ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะฟัะพะฑะปะตะผะฐ ะผะพะถะตั ะฑััั ัะฒัะทะฐะฝะฐ ะปะธะฑะพ ั ะธะผะตะฝะฐะผะธ ััะพะปะฑัะพะฒ, ะปะธะฑะพ ั ะพัะพะฑะตะฝะฝะพัััะผะธ ะบะพะฟะธัะพะฒะฐะฝะธั DataFrame, ะฐ ะฝะต ั ัะฐะผะธะผ ะดะพะฑะฐะฒะปะตะฝะธะตะผ ะฝะพะฒะพะณะพ ััะพะปะฑัะฐ.






ะั ัะบะฐะทะฐะปะธ:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
ะะฐัััะถะดะฐะปะฐ ะดะปั 11 ัะตะบัะฝะด
ะญัะพ ะฟัะตะดัะฟัะตะถะดะตะฝะธะต (SettingWithCopyWarning) ะพะทะฝะฐัะฐะตั, ััะพ ะฒั ะฟััะฐะตัะตัั ะธะทะผะตะฝะธัั DataFrame, ะบะพัะพััะน ัะฒะปัะตััั ััะตะทะพะผ (view) ะดััะณะพะณะพ DataFrame. ะ ัะฐะบะพะผ ัะปััะฐะต ะธะทะผะตะฝะตะฝะธั ะผะพะณัั ะฝะต ะฟัะธะผะตะฝะธัััั ะบ ะธััะพะดะฝะพะผั DataFrame, ะธะปะธ ะพะฝะธ ะผะพะณัั ะฑััั ะฝะตะฟัะตะดัะบะฐะทัะตะผัะผะธ.

ะงัะพะฑั ะธะทะฑะตะถะฐัั ััะพะน ะฟัะพะฑะปะตะผั, ะผะพะถะฝะพ ัะดะตะปะฐัั ัะฒะฝัั ะบะพะฟะธั DataFrame ะธะปะธ ะธัะฟะพะปัะทะพะฒะฐัั ะผะตัะพะด .loc ะดะปั ะฟัะธัะฒะฐะธะฒะฐะฝะธั. ะะพั ะดะฒะฐ ัะฟะพัะพะฑะฐ ัะตัะตะฝะธั:

1. ะกะดะตะปะฐัั ัะฒะฝัั ะบะพะฟะธั DataFrame:

python
ะะพะฟะธัะพะฒะฐัั
top_city_businesses = top_city_businesses.copy()

top_city_businesses['dist'] = top_city_businesses.apply(
    lambda row: haversine_distance(row['latitude'], row['longitude']),
    axis=1
)
ะะดะตัั ะผั ัะฝะฐัะฐะปะฐ ัะพะทะดะฐัะผ ะฝะตะทะฐะฒะธัะธะผัั ะบะพะฟะธั top_city_businesses, ะธ ะทะฐัะตะผ ะฑะตะทะพะฟะฐัะฝะพ ะดะพะฑะฐะฒะปัะตะผ ะฝะพะฒัะน ััะพะปะฑะตั.

2. ะัะฟะพะปัะทะพะฒะฐัั .loc ะดะปั ัััะฐะฝะพะฒะบะธ ะทะฝะฐัะตะฝะธะน:

python
ะะพะฟะธัะพะฒะฐัั
top_city_businesses.loc[:, 'dist'] = top_city_businesses.apply(
    lambda row: haversine_distance(row['latitude'], row['longitude']),
    axis=1
)
ะะตัะพะด .loc ะฟะพะทะฒะพะปัะตั ัะพัะฝะพ ัะบะฐะทะฐัั, ััะพ ะฒั ัะพัะธัะต ะธะทะผะตะฝะธัั ะฒะตัั ััะพะปะฑะตั 'dist'. ะญัะพ ะฟะพะผะพะณะฐะตั Pandas ะฟะพะฝััั, ััะพ ะธะทะผะตะฝะตะฝะธะต ะฒัะฟะพะปะฝัะตััั ะฝะฐะผะตัะตะฝะฝะพ ะธ ะฝะฐ ัะตะฐะปัะฝะพะผ DataFrame, ะฐ ะฝะต ะฝะฐ ะตะณะพ ััะตะทะต.

ะะฑะฐ ัะฟะพัะพะฑะฐ ะฟะพะผะพะณัั ััััะฐะฝะธัั ะฟัะตะดัะฟัะตะถะดะตะฝะธะต ะธ ะพะฑะตัะฟะตัะธัั ะบะพััะตะบัะฝะพะต ะดะพะฑะฐะฒะปะตะฝะธะต ััะพะปะฑัะฐ ั ะฒััะธัะปะตะฝะฝัะผะธ ะทะฝะฐัะตะฝะธัะผะธ ัะฐัััะพัะฝะธั.






ะั ัะบะฐะทะฐะปะธ:
ะะฐะบ ัะดะฐะปะธัั ะฒัะต ะฒัะฑัะพัั: ัะต ัััะพะบะธ, ะฒ ะบะพัะพััั dist ะฑะพะปััะต 95 ะฟัะพัะตะฝัะธะปะธ 
ะะฐัััะถะดะฐะปะฐ ะดะปั 9 ัะตะบัะฝะด
ะงัะพะฑั ัะดะฐะปะธัั ะธะท DataFrame ะฒัะต ัััะพะบะธ, ะฒ ะบะพัะพััั ะทะฝะฐัะตะฝะธะต ััะพะปะฑัะฐ dist ะฑะพะปััะต 95-ะณะพ ะฟัะพัะตะฝัะธะปั, ะฒัะฟะพะปะฝะธัะต ัะปะตะดัััะธะต ัะฐะณะธ:

ะััะธัะปะธัะต 95-ะน ะฟัะพัะตะฝัะธะปั ะดะปั ััะพะปะฑัะฐ dist ั ะฟะพะผะพััั ะผะตัะพะดะฐ .quantile(0.95).
ะััะธะปััััะนัะต DataFrame, ะพััะฐะฒะธะฒ ัะพะปัะบะพ ัััะพะบะธ, ะณะดะต dist ะผะตะฝััะต ะธะปะธ ัะฐะฒะตะฝ ััะพะผั ะฟะพัะพะณะพะฒะพะผั ะทะฝะฐัะตะฝะธั.
ะัะธะผะตั ะบะพะดะฐ:

python
ะะพะฟะธัะพะฒะฐัั
# ะััะธัะปัะตะผ 95-ะน ะฟัะพัะตะฝัะธะปั
threshold = top_city_businesses['dist'].quantile(0.95)

# ะคะธะปััััะตะผ DataFrame, ะพััะฐะฒะปัั ัััะพะบะธ ั dist <= threshold
top_city_businesses = top_city_businesses[top_city_businesses['dist'] <= threshold]

# ะัะฒะพะดะธะผ ะพะฑะฝะพะฒะปัะฝะฝัะน DataFrame
print(top_city_businesses)
ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะฒัะต ะฒัะฑัะพัั, ะณะดะต dist ะฑะพะปััะต 95-ะณะพ ะฟัะพัะตะฝัะธะปั, ะฑัะดัั ัะดะฐะปะตะฝั ะธะท DataFrame.






ะั ัะบะฐะทะฐะปะธ:
how to inner join two dataframes 
ะะฐัััะถะดะฐะปะฐ ะดะปั 4 ัะตะบัะฝะด
You can use the pandas merge function to perform an inner join on two DataFrames. An inner join returns only the rows that have matching keys in both DataFrames.

Here's an example:

python
ะะพะฟะธัะพะฒะฐัั
import pandas as pd

# Example DataFrames
df1 = pd.DataFrame({
    'id': [1, 2, 3, 4],
    'value_df1': ['A', 'B', 'C', 'D']
})

df2 = pd.DataFrame({
    'id': [3, 4, 5, 6],
    'value_df2': ['X', 'Y', 'Z', 'W']
})

# Perform inner join on the 'id' column
merged_df = pd.merge(df1, df2, on='id', how='inner')

print(merged_df)
In this example, only rows with matching id values in both DataFrames are kept (i.e., rows where id is 3 and 4).






ะั ัะบะฐะทะฐะปะธ:
ะัะฐะฒะธะปัะฝะพ ะปะธ ััะพ ? 


ะ ะฟะพะดะณััะถะตะฝะฝะพะน ัะฐะฑะปะธัะต ะพัะตะฝะพะบ ะพััะฐะฒััะต ัะพะปัะบะพ ะบะพะผะฟะฐะฝะธะธ ะณะพัะพะดะฐ N. ะะปั ััะพะณะพ ัััะฐะฝะพะฒะธัะต ะทะฝะฐัะตะฝะธั business_id ะฒ ะบะฐัะตััะฒะต ะธะฝะดะตะบัะฐ ั ัะฐะฑะปะธัั ะพัะตะฝะพะบ ะธ ะฒะพัะฟะพะปัะทัะนัะตัั ะผะตัะพะดะพะผ loc.

best_city_reviews = pd.merge(reviews, top_city_businesses, on='business_id', how='inner')
best_city_reviews
ะะฐัััะถะดะฐะปะฐ ะดะปั 9 ัะตะบัะฝะด
ะะฐั ะบะพะด ะฒัะฟะพะปะฝัะตั inner join, ะพะฑัะตะดะธะฝัั ัะฐะฑะปะธัั ะฟะพ business_id, ะธ ะฒ ัะตะทัะปััะฐัะต ะพััะฐัััั ัะพะปัะบะพ ัะต ะทะฐะฟะธัะธ, ั ะบะพัะพััั ะตััั ัะพะฒะฟะฐะดะตะฝะธั ะฒ ะพะฑะตะธั ัะฐะฑะปะธัะฐั. ะญัะพ ัะตัะฝะธัะตัะบะธ ะฒะตัะฝะพ ะธ ะดะฐัั ะฝัะถะฝัะน ัะตะทัะปััะฐั.

ะะดะฝะฐะบะพ, ัะพะณะปะฐัะฝะพ ััะปะพะฒะธั, ััะตะฑัะตััั ัะฝะฐัะฐะปะฐ ัััะฐะฝะพะฒะธัั ััะพะปะฑะตั business_id ะฒ ะบะฐัะตััะฒะต ะธะฝะดะตะบัะฐ ั ัะฐะฑะปะธัั ะพัะตะฝะพะบ (ะฝะฐะฟัะธะผะตั, DataFrame reviews), ะฐ ะทะฐัะตะผ ั ะฟะพะผะพััั ะผะตัะพะดะฐ loc ะพััะฐะฒะธัั ัะพะปัะบะพ ัะต ัััะพะบะธ, ะบะพัะพััะต ัะพะพัะฒะตัััะฒััั ะบะพะผะฟะฐะฝะธัะผ ะธะท ะณะพัะพะดะฐ N (ัะพ ะตััั ัะต, ะบะพัะพััะต ะฟัะธัััััะฒััั ะฒ DataFrame top_city_businesses).

ะะฐะฟัะธะผะตั, ะผะพะถะฝะพ ัะดะตะปะฐัั ัะฐะบ:

python
ะะพะฟะธัะพะฒะฐัั
# ะฃััะฐะฝะฐะฒะปะธะฒะฐะตะผ 'business_id' ะบะฐะบ ะธะฝะดะตะบั ะฒ ัะฐะฑะปะธัะต ะพัะตะฝะพะบ
reviews_indexed = reviews.set_index('business_id')

# ะคะธะปััััะตะผ ัััะพะบะธ ั ะฟะพะผะพััั loc: ะฒัะฑะธัะฐะตะผ ัะต business_id, ะบะพัะพััะต ะตััั ะฒ top_city_businesses['business_id']
# ะัะตะดะฟะพะปะฐะณะฐะตััั, ััะพ ะฒ top_city_businesses business_id ัะฒะปััััั ัะฝะธะบะฐะปัะฝัะผะธ ะธ ะผะพะณัั ะฑััั ะธัะฟะพะปัะทะพะฒะฐะฝั ะดะปั ัะธะปัััะฐัะธะธ
best_city_reviews = reviews_indexed.loc[reviews_indexed.index.isin(top_city_businesses['business_id'])]

# ะัะปะธ ะฝัะถะฝะพ ะฒะตัะฝััั business_id ะบะฐะบ ััะพะปะฑะตั, ะผะพะถะฝะพ ัะดะตะปะฐัั reset_index()
best_city_reviews = best_city_reviews.reset_index()
ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะฒะฐั ะฒะฐัะธะฐะฝั ั pd.merge ัะฐะฑะพัะฐะตั ะบะพััะตะบัะฝะพ, ะฝะพ ะฝะต ัะพะพัะฒะตัััะฒัะตั ััะตะฑะพะฒะฐะฝะธั ะธัะฟะพะปัะทะพะฒะฐัั set_index ะธ loc. ะัะปะธ ะทะฐะดะฐัะฐ ััะตะฑัะตั ะธะผะตะฝะฝะพ ัะฐะบะพะณะพ ะฟะพะดัะพะดะฐ, ัะพ ะฟัะธะฒะตะดัะฝะฝัะน ะฟัะธะผะตั ะฒััะต ะฑัะดะตั ะฑะพะปะตะต ะฟะพะดัะพะดััะธะผ.






ะั ัะบะฐะทะฐะปะธ:
ะบะฐะบ ะธัะฟัะฐะฒะธัั 

companies_average_stars = best_city_reviews.groupby('business_id').aggregate([np.mean, np.size])

The provided callable <function mean at 0x000002979C19AF20> is currently using SeriesGroupBy.mean. In a future version of pandas, the provided callable will be used directly. To keep current behavior pass the string "mean" instead.

C:\Users\GlebAdmin\AppData\Local\Temp\ipykernel_45744\38187526.py:1: FutureWarning:

The provided callable <function mean at 0x000002979C19AF20> is currently using SeriesGroupBy.mean. In a future version of pandas, the provided callable will be used directly. To keep current behavior pass the string "mean" instead.
ะะฐัััะถะดะฐะปะฐ ะดะปั 18 ัะตะบัะฝะด
ะงัะพะฑั ะธะทะฑะตะถะฐัั ะฟัะตะดัะฟัะตะถะดะตะฝะธั FutureWarning, ะฝัะถะฝะพ ะฟะตัะตะดะฐะฒะฐัั ะฝะฐะทะฒะฐะฝะธั ะฐะณัะตะณะธััััะธั ััะฝะบัะธะน ะฒ ะฒะธะดะต ัััะพะบ, ะฐ ะฝะต ะธั ะพะฑัะตะบัะพะฒ. ะขะพ ะตััั, ะฒะผะตััะพ:

python
ะะพะฟะธัะพะฒะฐัั
companies_average_stars = best_city_reviews.groupby('business_id').aggregate([np.mean, np.size])
ะธัะฟะพะปัะทัะนัะต:

python
ะะพะฟะธัะพะฒะฐัั
companies_average_stars = best_city_reviews.groupby('business_id').aggregate(['mean', 'size'])
ะญัะพ ัะพััะฐะฝะธั ัะตะบััะตะต ะฟะพะฒะตะดะตะฝะธะต ะธ ััััะฐะฝะธั ะฟัะตะดัะฟัะตะถะดะตะฝะธะต, ะฟะพัะบะพะปัะบั pandas ะฒ ะฑัะดััะตะผ ะฑัะดะตั ะฟัะธะผะตะฝััั ะฟะตัะตะดะฐะฝะฝัะต callables ะฝะฐะฟััะผัั.






ะั ัะบะฐะทะฐะปะธ:

ะงัะพ ัะฐะบะพะต 0 mean ะธ 0 size ััะพะปะฑัั 
ะะฐ ะพัะฝะพะฒะต ะฒะฐัะตะณะพ ะพะฟะธัะฐะฝะธั ะธ ะธะทะพะฑัะฐะถัะฝะฝะพะณะพ ะฒะพะฟัะพัะฐ ะพ ััะพะปะฑัะฐั **`0 mean`** ะธ **`0 size`** ะฟะพัะปะต ะฒัะฟะพะปะฝะตะฝะธั ะพะฟะตัะฐัะธะธ ะฐะณัะตะณะธัะพะฒะฐะฝะธั, ะฒะตัะพััะฝะพ, ัะตัั ะธะดะตั ะพ ัะพะผ, ะบะฐะบ pandas ะพะฑัะฐะฑะฐััะฒะฐะตั ััะฝะบัะธั **`aggregate`** ะฟัะธ ะณััะฟะฟะพะฒะพะผ ะฟัะธะผะตะฝะตะฝะธะธ. ### ะะฐะถะฝะพะต ะทะฐะผะตัะฐะฝะธะต: ะะพะณะดะฐ ะฒั ะธัะฟะพะปัะทัะตัะต ัะฐะบะธะต ะฐะณัะตะณะธััััะธะต ััะฝะบัะธะธ, ะบะฐะบ **`mean`** ะธ **`size`**, **`mean`** ะฒััะธัะปัะตั ััะตะดะฝะตะต ะทะฝะฐัะตะฝะธะต ะดะปั ะบะฐะถะดะพะน ะณััะฟะฟั, ะฐ **`size`** โ ะบะพะปะธัะตััะฒะพ ัะปะตะผะตะฝัะพะฒ ะฒ ะบะฐะถะดะพะน ะณััะฟะฟะต. ะัะปะธ ััะพะปะฑะตั Aggregate ะดะปั `business_id` ัะพะดะตัะถะธั ะทะฝะฐัะตะฝะธั, ะณะดะต ะพะดะฝะพ ะธะท ะทะฝะฐัะตะฝะธะน ะพััััััะฒัะตั ะดะปั ะฝะฐะฑะปัะดะตะฝะธั, ะธะปะธ ะถะต ะดะฐะฝะฝัะต ะณััะฟะฟะธัััััั ะฝะตะบะพััะตะบัะฝะพ, ัะพ pandas ะฑัะดะตั ัะพะทะดะฐะฒะฐัั ััะพะปะฑัั ะดะปั ััะธั ััะฝะบัะธะน ั ะธะผะตะฝะฐะผะธ **`0 mean`** ะธ **`0 size`**, ะบะพัะพััะต ะผะพะณัั ัะบะฐะทัะฒะฐัั ะฝะฐ ะฟัะพะฑะปะตะผั ั ะฟััััะผะธ ะทะฝะฐัะตะฝะธัะผะธ ะธะปะธ ะถะต ะฝะฐ ะฝะตะฟัะฐะฒะธะปัะฝัะผ ะดะตะปะตะฝะธะตะผ ะดะฐะฝะฝัั. ### ะงัะพ ัะปะตะดัะตั ะฟัะพะฒะตัะธัั: 1. **ะัะพะฟััะตะฝะฝัะต ะทะฝะฐัะตะฝะธั:** ะะพะทะผะพะถะฝะพ, ะฟะพัะปะต ะณััะฟะฟะธัะพะฒะบะธ ะทะฝะฐัะตะฝะธั ะฒ ััะพะปะฑัะฐั ัะพะดะตัะถะฐั **NaN**, ััะพ ะฟัะธะฒะพะดะธั ะบ ะฝะตะพะถะธะดะฐะฝะฝัะผ ัะตะทัะปััะฐัะฐะผ ะดะปั **mean** ะธ **size** - ะั ะผะพะถะตัะต ะธัะฟะพะปัะทะพะฒะฐัั `dropna()` ััะพะฑั ัะดะฐะปะธัั ัััะพะบะธ ั ะฟััััะผะธ ะทะฝะฐัะตะฝะธัะผะธ ะธะท ะฐะฝะฐะปะธะทะฐ. 2. **ะะตะบะพััะตะบัะฝะพะต ะฟัะธะผะตะฝะตะฝะธะต ะฐะณัะตะณะธัะพะฒะฐะฝะฝัั ััะฝะบัะธะน (aggregate):** ะฃะฑะตะดะธัะตัั, ััะพ ะพะฟะตัะฐัะธะธ ะธ ะฒัะฑะพั ะดะฐะฝะฝัั ะฒัะฟะพะปะฝััััั ะบะพััะตะบัะฝะพ ะฟะพ ะฝะตะพะฑัะพะดะธะผัะผ ััะพะปะฑัะฐะผ. ะะฐะฟัะธะผะตั, ะพัะธะฑะบะฐ ะผะพะถะตั ะฒะพะทะฝะธะบะฝััั, ะตัะปะธ ััะพะปะฑัั ะฝะตัััะบะพ ะพะฟัะตะดะตะปะตะฝั ะดะปั ะฟะพะดััััะฐ ััะผะผั ะธะปะธ ะดััะณะธะต ะพะฟะตัะฐัะธะธ. ### ะะพะฟัะพะฑัะนัะต ะธัะฟัะฐะฒะธัั ัะฐะบ: ```python companies_average_stars = best_city_reviews.groupby('business_id').aggregate({'rating': ['mean', 'size']}) ``` ะฃะฑะตะดะธัะตัั ะฒ ัะพะผ, ััะพ ััะพะปะฑัั ะธ ะฐะณัะตะณะฐัะฝัะต ััะฝะบัะธะธ ะฟัะธะผะตะฝััััั ะบะพััะตะบัะฝะพ, ะธ ััะพ ะฒะฐัะธ ะดะฐะฝะฝัะต ะฒ ะบะพัะพััั ะฒะพะทะฒัะฐัะฐัััั ััะผะผั, ะดะธัะบะฒะฐะปะธัะธะบะฐัะธะธ ัะพัะฝะพ ัะตัะธะผ ะดะปั 52 ัะตะบัะฝะด
ะ ัะตะทัะปััะฐัะต ะณััะฟะฟะธัะพะฒะบะธ ะธ ะฐะณัะตะณะธัะพะฒะฐะฝะธั ะฟะพ ัะผะพะปัะฐะฝะธั pandas ะฟััะฐะตััั ะฟัะธะผะตะฝะธัั ััะฝะบัะธะธ ะบะพ ะฒัะตะผ ัะธัะปะพะฒัะผ ััะพะปะฑัะฐะผ. ะัะปะธ ะฒ ะฒะฐัะตะผ DataFrame ะตััั ััะพะปะฑะตั ะฑะตะท ะธะผะตะฝะธ ะธะปะธ ั ะธะผะตะฝะตะผ, ะฝะฐะฟัะธะผะตั, 0 ะธะปะธ Unnamed: 0, ัะพ ะฟัะธ ะฐะณัะตะณะธัะพะฒะฐะฝะธะธ ะพะฝ ะฟะพัะฒะธััั ะบะฐะบ 0 mean / 0 size (ะธะปะธ Unnamed: 0 mean / Unnamed: 0 size). ะัะพัะต ะณะพะฒะพัั, ััะพ ััะฐัะธััะธะบะธ (ััะตะดะฝะตะต ะธ ัะฐะทะผะตั) ะดะปั ััะพะปะฑัะฐ, ั ะบะพัะพัะพะณะพ ะฝะตั ะฝะพัะผะฐะปัะฝะพะณะพ ะฝะฐะทะฒะฐะฝะธั.

ะงะฐัะต ะฒัะตะณะพ ัะฐะบะฐั ัะธััะฐัะธั ะฒะพะทะฝะธะบะฐะตั ะฟัะธ ััะตะฝะธะธ CSV-ัะฐะนะปะพะฒ, ะบะพะณะดะฐ ะฒ ะดะฐะฝะฝัั ะตััั ยซะปะธัะฝะธะนยป ััะพะปะฑะตั ะธะปะธ ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะพะทะดะฐัััั ััะพะปะฑะตั ั ะธะฝะดะตะบัะพะผ, ะบะพัะพััะน pandas ะฟะพะผะตัะฐะตั ะบะฐะบ Unnamed: 0. ะงัะพะฑั ััะพ ะธัะฟัะฐะฒะธัั, ะผะพะถะฝะพ:

ะฃะดะฐะปะธัั ะธะปะธ ะฟะตัะตะธะผะตะฝะพะฒะฐัั ยซะปะธัะฝะธะนยป ััะพะปะฑะตั ะฟะตัะตะด ะณััะฟะฟะธัะพะฒะบะพะน. ะะฐะฟัะธะผะตั:

python
ะะพะฟะธัะพะฒะฐัั
# ะัะปะธ ะฒั ัะฒะตัะตะฝั, ััะพ 'Unnamed: 0' ะฝะต ะฝัะถะตะฝ:
df = df.drop(columns='Unnamed: 0')
# ะะปะธ ะฟะตัะตะธะผะตะฝะพะฒะฐัั:
df = df.rename(columns={'Unnamed: 0': 'my_index'})
ะฏะฒะฝะพ ัะบะฐะทะฐัั ััะพะปะฑัั, ะบะพัะพััะต ัะพัะธัะต ะฐะณัะตะณะธัะพะฒะฐัั. ะะฐะฟัะธะผะตั, ะตัะปะธ ะฒะฐั ะธะฝัะตัะตััะตั ัะพะปัะบะพ ััะพะปะฑะตั stars, ะฝะฐะฟะธัะธัะต:

python
ะะพะฟะธัะพะฒะฐัั
companies_average_stars = best_city_reviews.groupby('business_id')['stars'].agg(['mean', 'size'])
ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ยซ0 meanยป ะธ ยซ0 sizeยป โ ััะพ ัะตะทัะปััะฐัั ะฐะณัะตะณะธัะพะฒะฐะฝะธั ะดะปั ััะพะปะฑัะฐ, ั ะบะพัะพัะพะณะพ ะปะธะฑะพ ะฝะตั ะฝะฐะทะฒะฐะฝะธั, ะปะธะฑะพ ะพะฝะพ ะทะฐะดะฐะฝะพ ะบะฐะบ 0/Unnamed: 0.






ะั ัะบะฐะทะฐะปะธ:

ะะฐะดะฐะฝะธะต ัะฝะธะทั. ะะฐะบ ัะตัะธัั? 

ะะฐัััะถะดะฐะปะฐ ะดะปั ะฟะฐัะฐ ัะตะบัะฝะด
ะัั ัะตัะตะฝะธะต ะดะปั ะทะฐะดะฐะฝะธั ัะฝะธะทั.

ะัั ัะฟะพัะพะฑ ัะตัะตะฝะธั ะทะฐะดะฐะฝะธั.






ะั ัะบะฐะทะฐะปะธ:
ะะตัะธ ะทะฐะดะฐัั 

1/2


ะะฐัััะถะดะฐะปะฐ ะดะปั ะฟะฐัะฐ ัะตะบัะฝะด
ะัะฒะตั ะฝะฐ ะทะฐะฟัะพั

ะััะฐััั ัะฐะทะพะฑัะฐัััั ั ะทะฐะดะฐัะตะน? ะงัะพะฑั ะฒัะฑะตัะธัะต ะพะฟัะธะผะฐะปัะฝัะน ะฟะพะดัะพะด.

ะะฟัะตะดะตะปะตะฝะธะต ะทะฐะดะฐัะธ

ะะฐะทะฑะธัะฐััั ั ะทะฐะฟัะพัะพะผ: ะบะฐะบะพะผั ะธะท ะฒะฐัะธะฐะฝัะพะฒ โ ัะตัะตะฝะธั ะฟัะพะฑะปะตะผั ะธะปะธ ะฒะพะฟัะพัั ะพ ะผะตัะพะดะธะบะต โ ั ะดะพะปะถะตะฝ ัะดะตะปะธัั ะฒะฝะธะผะฐะฝะธะต.

ะะพะฟัะพั ะฒ ะธะทะพะฑัะฐะถะตะฝะธะธ ะพัะฝะพัะธััั ะบ ะฟะตัะตะธะผะตะฝะพะฒะฐะฝะธั ััะพะปะฑัะพะฒ ัะฐะฑะปะธัั ั ะดะฐะฝะฝัะผะธ ะฒ pandas ะดะปั ัะดะพะฑััะฒะฐ ะธ ัะธัะฐะตะผะพััะธ. ะะฑััะฝะพ, ััะพะฑั ะฟะตัะตะธะผะตะฝะพะฒะฐัั ััะพะปะฑัั, ะฝัะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ะผะตัะพะด .rename(), ะฟะตัะตะดะฐะฒ ะฒ ะฝะตะณะพ ัะปะพะฒะฐัั, ะณะดะต ะบะปััะธ โ ััะพ ัะตะบััะธะต ะธะผะตะฝะฐ ััะพะปะฑัะพะฒ, ะฐ ะทะฝะฐัะตะฝะธั โ ะฝะพะฒัะต ะธะผะตะฝะฐ.

ะะฐะดะฐะฝะธะต:
ะะตัะตะธะผะตะฝะพะฒะฐัั ััะพะปะฑัั ัะฐะฑะปะธัั ัะฐะบ, ััะพะฑั ะพะฝะธ ะธะผะตะปะธ ะฑะพะปะตะต ัะธัะฐะตะผัะต ะธ ะฟะพะฝััะฝัะต ะฝะฐะทะฒะฐะฝะธั.

ะัะธะผะตั ะบะพะดะฐ ะดะปั ะฟะตัะตะธะผะตะฝะพะฒะฐะฝะธั:
ะัะตะดะฟะพะปะพะถะธะผ, ััะพ ัะตะบััะธะต ะธะผะตะฝะฐ ััะพะปะฑัะพะฒ ะฒ ัะฐะฑะปะธัะต โ Unnamed: 0, 0 mean, stars mean, stars size. ะั ัะพัะธะผ ะฟะตัะตะธะผะตะฝะพะฒะฐัั ะธั ะฒ ะฑะพะปะตะต ัะดะพะฑะฝัะต ะธะผะตะฝะฐ.

python
ะะพะฟะธัะพะฒะฐัั
# ะะตัะตะธะผะตะฝัะตะผ ััะพะปะฑัั
companies_average_stars = companies_average_stars.rename(columns={
    'Unnamed: 0': 'business_id',  # ะฟัะตะดะฟะพะปะฐะณะฐะตะผ, ััะพ ััะพ ััะพะปะฑะตั ั business_id
    '0 mean': 'stars_average',  # ะฟะตัะตะธะผะตะฝะพะฒัะฒะฐะตะผ ััะพะปะฑะตั ั ัััะตะดะฝะตะฝะฝัะผะธ ะทะฝะฐัะตะฝะธัะผะธ
    'stars mean': 'stars_average',  # ะฝะฐะฟัะธะผะตั, ะตัะปะธ ััะพั ััะพะปะฑะตั ัะฐะบะถะต ัะฒัะทะฐะฝ ั ัััะตะดะฝะตะฝะฝัะผะธ ะทะฝะฐัะตะฝะธัะผะธ
    'stars size': 'num_reviews'  # ะบะพะปะธัะตััะฒะพ ะพัะทัะฒะพะฒ
})

# ะัะพะฒะตััะตะผ ัะตะทัะปััะฐั
print(companies_average_stars.head())
ะะพััะฝะตะฝะธะต:
ะั ะฟะตัะตะธะผะตะฝะพะฒัะฒะฐะตะผ ััะพะปะฑัั ั ะฟะพะผะพััั ะผะตัะพะดะฐ .rename(), ะณะดะต ะบะฐะถะดัะน ัะตะบััะธะน ััะพะปะฑะตั ะทะฐะผะตะฝัะตััั ะฝะฐ ะฝะพะฒัะน.
ะัะฟะพะปัะทัะตะผ ัะปะพะฒะฐัั, ััะพะฑั ัะบะฐะทะฐัั ััะฐััะต ะธะผะตะฝะฐ ััะพะปะฑัะพะฒ ะธ ัะพะพัะฒะตัััะฒัััะธะต ะฝะพะฒัะต ะฝะฐะทะฒะฐะฝะธั.
ะั ะผะพะถะตัะต ะธะทะผะตะฝะธัั ะฝะฐะทะฒะฐะฝะธั ััะพะปะฑัะพะฒ ะฝะฐ ัะฐะบะธะต, ะบะพัะพััะต ะฑัะดัั ะฝะฐะธะฑะพะปะตะต ัะดะพะฑะฝั ะดะปั ะฒะฐั ะธะปะธ ะฒะฐัะตะน ะบะพะผะฐะฝะดั.
ะะฐะบ ะธัะฟะพะปัะทะพะฒะฐัั:
ะัะพััะพ ะทะฐะผะตะฝะธัะต ััะฐััะต ะธะผะตะฝะฐ ััะพะปะฑัะพะฒ ะฝะฐ ะฐะบััะฐะปัะฝัะต ะฒ ะฒะฐัะตะผ DataFrame ะฒ ัะพะพัะฒะตัััะฒะธะธ ั ะทะฐะดะฐะฝะธะตะผ.





ะั ัะบะฐะทะฐะปะธ:
ะฝั ะฒะพั ั ะฟััะฐััั, ะฝะพ ั ะผะตะฝั ะฝะต ะฟะพะปััะฐะตััั
companies_average_stars.rename(columns={"stars mean": "avg rating"}, inplace=True)

ะะฐัััะถะดะฐะปะฐ ะดะปั 5 ัะตะบัะฝะด
ะะทะผะตะฝะตะฝะธะต ะฝะฐะทะฒะฐะฝะธะน

ะฏ ะดัะผะฐั ะพ ัะพะผ, ะบะฐะบ ะฟะตัะตะธะผะตะฝะพะฒะฐัั ััะพะปะฑัั ะฒ DataFrame, ััะพะฑั ัะปัััะธัั ะธั ัะธัะฐะตะผะพััั. ะะฐะผะตัะฐะตััั ะฟะปะฐะฝ ะดะตะนััะฒะธะน.

ะะตัะตะธะผะตะฝะพะฒะฐะฝะธะต ะธ ะพัะธััะบะฐ

ะะปะฐะฝะธััั ะธะทะผะตะฝะธัั ะฝะฐะทะฒะฐะฝะธั ััะพะปะฑัะพะฒ ะฒ DataFrame ะธ ะพัะธััะธัั ะดะฐะฝะฝัะต, ััะพะฑั ัะปัััะธัั ะธั ััััะบัััั ะธ ัะธัะฐะตะผะพััั. ะญัะพ ะฟะพะดะฝะธะผะฐะตั ะฒะพะฟัะพัั ะพะฑ ัััะตะบัะธะฒะฝะพััะธ ััะฐะฝะตะฝะธั ะธะฝัะพัะผะฐัะธะธ.

ะฃัะพัะฝัั ะทะฐะฟัะพั

ะขะตะฟะตัั ั ัะผะพััั ะฝะฐ ััะพัะฝะตะฝะธะต ะทะฐะฟัะพัะฐ: ะฝัะถะฝะพ ะฟะพะฝััั, ะฟะพัะตะผั "ัะธัะปะพ ะดะพััะธะณะฝััะพ" ะฝะต ัะพะฒะฟะฐะดะฐะตั ั ัะตะทัะปััะฐัะพะผ "ัะธัะปะพ ะฝะฐะบะพะฟะปะตะฝะพ".

ะะตัะตะธะผะตะฝะพะฒะฐะฝะธะต ััะพะปะฑัะพะฒ

ะฏ ัะฑะธัะฐั ะพัะตะฝะบั ะทะฒะตะทะด ัะฐะบ, ะบะฐะบ ััะพ ะฝัะถะฝะพ. ะขะตะฟะตัั ั ะดัะผะฐั ะพ ะฒัะดะตะปะตะฝะธะธ ะดะฒัั ัะปะพะฒ ะฒ ะธะฝะดะตะบัะฐั ะดะปั ัะฟัะพัะตะฝะธั ะฐะฝะฐะปะธะทะฐ.

ะฃัะพัะฝัั ะฝะฐะทะฒะฐะฝะธะต

ะฏ ััะฐะฝะพะฒะปััั ัะฒะตัะตะฝะฝะตะต, ััะพ ะดะปั ะดะฐะฝะฝัั ะปัััะต ะพะฟัะตะดะตะปะธัั ะบะพะฝะบัะตัะฝะพะต ะธะผั, ะฝะตะถะตะปะธ ััะฐะฒะธัั "undefined". ะญัะพ ะฟะพะผะพะณะฐะตั ัะพัะฝะตะต ัะพัะผะธัะพะฒะฐัั ะทะฐะฟัะพัั ะดะปั ะฐะฝะฐะปะธะทะฐ.

ะัะตะพะฑัะฐะทัั ะดะฐะฝะฝัะต

ะฏ ะพะฑะดัะผัะฒะฐั ะธะทะผะตะฝะตะฝะธะต ะฝะฐะทะฒะฐะฝะธะน ััะพะปะฑัะพะฒ ะฒ DataFrame ะดะปั ะธั ัะปัััะตะฝะธั. ะญัะพั ัะฐะณ ะฟะพะผะพะณะฐะตั ััะฝะตะต ะฒะธะดะตัั ััััะบัััั ะดะฐะฝะฝัั.

ะัะธะฑะบะฐ ะผะพะถะตั ะฒะพะทะฝะธะบะฝััั ะฟะพ ะฝะตัะบะพะปัะบะธะผ ะฟัะธัะธะฝะฐะผ. ะะพั ะฝะตัะบะพะปัะบะพ ัะฐะณะพะฒ, ััะพะฑั ัะฐะทะพะฑัะฐัััั ะธ ัะตัะธัั ะฟัะพะฑะปะตะผั:

1. ะฃะฑะตะดะธัะตัั, ััะพ ััะพะปะฑะตั "stars mean" ะดะตะนััะฒะธัะตะปัะฝะพ ัััะตััะฒัะตั.
ะัะปะธ ััะพะปะฑะตั ัะพะดะตัะถะธั ะฟัะพะฑะตะปั ะฒ ะฝะฐัะฐะปะต ะธะปะธ ะฒ ะบะพะฝัะต, ะธะปะธ ะตัะปะธ ะตะณะพ ะธะผั ะฝะตะผะฝะพะณะพ ะพัะปะธัะฐะตััั (ะฝะฐะฟัะธะผะตั, ะดะพะฟะพะปะฝะธัะตะปัะฝัะน ัะธะผะฒะพะป), ััะพ ะผะพะถะตั ะฟัะธะฒะตััะธ ะบ ะพัะธะฑะบะต. ะั ะผะพะถะตัะต ะฒัะฒะตััะธ ัะฟะธัะพะบ ััะพะปะฑัะพะฒ ั ะฟะพะผะพััั:

python
ะะพะฟะธัะพะฒะฐัั
print(companies_average_stars.columns)
ะญัะพ ะฟะพะบะฐะถะตั ะฒะฐะผ ัะพัะฝัะต ะธะผะตะฝะฐ ััะพะปะฑัะพะฒ. ะฃะฑะตะดะธัะตัั, ััะพ ะธะผั "stars mean" ะฒ ะฒะฐัะตะผ DataFrame ัะพะฒะฟะฐะดะฐะตั ั ัะตะผ, ััะพ ะฒั ะฟะตัะตะดะฐะตัะต ะฒ ะผะตัะพะด rename().

2. ะฃะฑะตะดะธัะตัั, ััะพ ะธัะฟะพะปัะทัะตัะต ะฟัะฐะฒะธะปัะฝัะน ัะธะฝัะฐะบัะธั.
ะัะปะธ ะฒั ัะฒะตัะตะฝั, ััะพ ััะพะปะฑะตั ะตััั, ัะพ ะฒะฐั ะบะพะด ะดะพะปะถะตะฝ ัะฐะฑะพัะฐัั ะบะพััะตะบัะฝะพ. ะะดะฝะฐะบะพ, ะตัะปะธ ะฒั ะฒัะต ัะฐะฒะฝะพ ะฟะพะปััะฐะตัะต ะพัะธะฑะบั, ะฟะพะฟัะพะฑัะนัะต ัะปะตะดัััะตะต:

python
ะะพะฟะธัะพะฒะฐัั
companies_average_stars.rename(columns={"stars mean": "avg rating"}, inplace=True)
ะญัะพั ะบะพะด ะดะพะปะถะตะฝ ะทะฐะผะตะฝะธัั ััะพะปะฑะตั "stars mean" ะฝะฐ "avg rating" ะฒ ะผะตััะต (ัะพ ะตััั, ะฑะตะท ัะพะทะดะฐะฝะธั ะฝะพะฒะพะณะพ ะพะฑัะตะบัะฐ).

3. ะัะธะผะตั ั ะดะพะฟะพะปะฝะธัะตะปัะฝะพะน ะฟัะพะฒะตัะบะพะน:
ะะพะฟัะพะฑัะนัะต ัะปะตะดัััะธะน ะบะพะด ั ะดะพะฟะพะปะฝะธัะตะปัะฝะพะน ะฟัะพะฒะตัะบะพะน ะฝะฐ ะฒัะฒะพะด ััะพะปะฑัะพะฒ ะดะพ ะธ ะฟะพัะปะต ะฟะตัะตะธะผะตะฝะพะฒะฐะฝะธั:

python
ะะพะฟะธัะพะฒะฐัั
# ะัะพะฒะตััะตะผ ะธะผะตะฝะฐ ััะพะปะฑัะพะฒ ะฟะตัะตะด ะฟะตัะตะธะผะตะฝะพะฒะฐะฝะธะตะผ
print("Before renaming:", companies_average_stars.columns)

# ะะตัะตะธะผะตะฝะพะฒัะฒะฐะตะผ ััะพะปะฑะตั
companies_average_stars.rename(columns={"stars mean": "avg rating"}, inplace=True)

# ะัะพะฒะตััะตะผ ะธะผะตะฝะฐ ััะพะปะฑัะพะฒ ะฟะพัะปะต ะฟะตัะตะธะผะตะฝะพะฒะฐะฝะธั
print("After renaming:", companies_average_stars.columns)
4. ะะพะทะผะพะถะฝะฐั ะพัะธะฑะบะฐ ะฒ inplace=True:
ะัะปะธ ะฝะต ะฟะพะปััะธะปะพัั ะธะทะผะตะฝะธัั ััะพะปะฑะตั ะฝะฐ ะผะตััะต ั ะฟะพะผะพััั inplace=True, ะฟะพะฟัะพะฑัะนัะต ัะพะทะดะฐัั ะฝะพะฒัะน ะพะฑัะตะบั:

python
ะะพะฟะธัะพะฒะฐัั
companies_average_stars = companies_average_stars.rename(columns={"stars mean": "avg rating"})
ะญัะพั ะฟะพะดัะพะด ัะพะทะดะฐัั ะฝะพะฒัะน DataFrame ั ะฟะตัะตะธะผะตะฝะพะฒะฐะฝะฝัะผะธ ััะพะปะฑัะฐะผะธ.

ะัะปะธ ััะธ ัะฐะณะธ ะฝะต ัะตัะฐั ะฟัะพะฑะปะตะผั, ะฟะพะถะฐะปัะนััะฐ, ััะพัะฝะธัะต, ะบะฐะบะฐั ะพัะธะฑะบะฐ ะฟะพัะฒะปัะตััั, ะธ ั ะฟะพะผะพะณั ะฒะฐะผ ะดะฐะปััะต.






ะั ัะบะฐะทะฐะปะธ:
ะฒะพั ััะพ ะฟะพะปััะฐะตััั 
MultiIndex([('Unnamed: 0', 'mean'),
            ('Unnamed: 0', 'size'),
            (     'stars', 'mean'),
            (     'stars', 'size')],
           )

ะะฐัััะถะดะฐะปะฐ ะดะปั ะฟะฐัะฐ ัะตะบัะฝะด
ะัั ะฟะพะดัะพะด

ะะบะตะน, ั ัะฐััะผะฐััะธะฒะฐั ะทะฐะฟัะพั ะฟะพะปัะทะพะฒะฐัะตะปั, ะบะพัะพััะน ะบะฐัะฐะตััั ะผัะปััะธะธะฝะดะตะบัะฐ pandas ั ะผะตัะบะฐะผะธ 'Unnamed: 0' ะธ 'size'. Hะตะพะฑัะพะดะธะผะพ ะฟะพะฝััั, ะบะฐะบ ัะพัะผัะปั pd.pivot_table ะธ pd.merge ะผะพะณัั ะฑััั ะธัะฟะพะปัะทะพะฒะฐะฝั ะดะปั ััะตะฑัะตะผัั ัะฐััะตัะพะฒ.

ะัั ะฟะพะดัะพะด

ะฏ ะดัะผะฐั ะพ ะผัะปััะธะธะฝะดะตะบัะต pandas ะธ ะบะฐะบ ะธัะฟะพะปัะทะพะฒะฐะป pd.pivot_table ะธะปะธ pd.merge ะดะปั ะฒััะธัะปะตะฝะธะน. ะญัะพ ะฟะพะดัะฐะปะบะธะฒะฐะตั ะผะตะฝั ัะฐััะผะฐััะธะฒะฐัั ัััะตะบัะธะฒะฝะพะต ะพะฑัะตะดะธะฝะตะฝะธะต ะดะฐะฝะฝัั.

ะะฟัะตะดะตะปะตะฝะธะต ะบะปััะตะฒัั ะพะฟะตัะฐัะธะน

ะะพะดัะผะฐะนัะต ะพ ัะพะผ, ะบะฐะบ ะธัะฟะพะปัะทะพะฒะฐัั pd.pivot_table ะธ pd.merge ะดะปั ะผัะปััะธะธะฝะดะตะบัะฐ pandas: ััะพ ะฝะตะพะฑัะพะดะธะผะพ ะดะปั ะฒััะธัะปะตะฝะธะน, ะพะฑัะตะดะธะฝัััะธั ะพะฑะฐ ััะพะปะฑัะฐ.

ะัะพะฑะปะตะผะฐ ะฒะพะทะฝะธะบะฐะตั ะธะท-ะทะฐ ัะพะณะพ, ััะพ ั ะฒะฐั MultiIndex ะฒ ััะพะปะฑัะฐั. ะญัะพ ะทะฝะฐัะธั, ััะพ ะบะฐะถะดัะน ััะพะปะฑะตั ะฒ DataFrame ะธะผะตะตั ะดะฒะฐ ััะพะฒะฝั: ะพะดะธะฝ ะดะปั ะบะฐัะตะณะพัะธะน, ะฝะฐะฟัะธะผะตั, "Unnamed: 0" ะธะปะธ "stars", ะธ ะดััะณะพะน ะดะปั ััะฐัะธััะธะบะธ, ัะฐะบะพะน ะบะฐะบ "mean" ะธะปะธ "size". ะะพััะพะผั, ะฟัะธ ะฟะตัะตะธะผะตะฝะพะฒะฐะฝะธะธ, ะฒะฐะผ ะฝัะถะฝะพ ัะฐะฑะพัะฐัั ั ะพะฑะพะธะผะธ ััะพะฒะฝัะผะธ.

ะงัะพะฑั ะฟะตัะตะธะผะตะฝะพะฒะฐัั ััะพะปะฑัั ะฒ MultiIndex, ะฒั ะผะพะถะตัะต ะธัะฟะพะปัะทะพะฒะฐัั ะผะตัะพะด rename() ั ะฟะฐัะฐะผะตััะพะผ level, ัะบะฐะทัะฒะฐั ััะพะฒะตะฝั ะธะฝะดะตะบัะฐ, ะบะพัะพััะน ัะพัะธัะต ะธะทะผะตะฝะธัั. ะะปะธ, ะตัะปะธ ะฒั ัะพัะธัะต ะธะทะผะตะฝะธัั ะพะฑะฐ ััะพะฒะฝั (ะบะฐัะตะณะพัะธั ะธ ััะฐัะธััะธะบะฐ), ะฒะฐะผ ะฝัะถะฝะพ ะฑัะดะตั ะฟัะฐะฒะธะปัะฝะพ ะพะฑัะฐัะฐัััั ั ะพะฑะพะธะผะธ ััะพะฒะฝัะผะธ.

ะัะธะผะตั:
ะงัะพะฑั ะฟะตัะตะธะผะตะฝะพะฒะฐัั ะฒัะต ััะพะปะฑัั ะฝะฐ ะพะดะฝะพะผ ััะพะฒะฝะต, ะผะพะถะฝะพ ัะดะตะปะฐัั ััะพ ัะฐะบ:
python
ะะพะฟะธัะพะฒะฐัั
# ะะตัะตะธะผะตะฝะพะฒัะฒะฐะตะผ ะฒัะพัะพะน ััะพะฒะตะฝั MultiIndex (ะฝะฐะฟัะธะผะตั, ะดะปั mean ะธ size)
companies_average_stars.columns = companies_average_stars.columns.set_levels(
    ['avg rating', 'num_reviews'], level=1
)

print(companies_average_stars)
ะ ััะพะผ ะฟัะธะผะตัะต ะผั ะฟะตัะตะธะผะตะฝะพะฒัะฒะฐะตะผ ะฒัะพัะพะน ััะพะฒะตะฝั MultiIndex (ะณะดะต ะฝะฐัะพะดัััั mean ะธ size), ะฝะฐ ะทะฝะฐัะตะฝะธั avg rating ะธ num_reviews.

2. ะะปั ะธะทะผะตะฝะตะฝะธั ะธ ะฟะตัะฒะพะณะพ ััะพะฒะฝั, ะธ ะฒัะพัะพะณะพ ััะพะฒะฝั, ะผะพะถะฝะพ ัะดะตะปะฐัั ัะฐะบ:
python
ะะพะฟะธัะพะฒะฐัั
companies_average_stars.columns = pd.MultiIndex.from_tuples(
    [('business_id', 'mean'), ('business_id', 'size'),
     ('stars', 'mean'), ('stars', 'size')],
    names=['business_id', 'statistic']
)

# ะะพัะปะต ััะพะณะพ ะผะพะถะฝะพ ะฟะตัะตะธะผะตะฝะพะฒัะฒะฐัั:
companies_average_stars.columns = companies_average_stars.columns.set_levels(
    ['avg rating', 'num_reviews'], level=1
)

print(companies_average_stars)
ะะดะตัั ะผั ัะฝะฐัะฐะปะฐ ัะพะทะดะฐัะผ ะฝะพะฒัะน MultiIndex ั ะฝัะถะฝัะผะธ ะฝะฐะทะฒะฐะฝะธัะผะธ ััะพะฒะฝะตะน ะธ ะฟะตัะตะธะผะตะฝะพะฒัะฒะฐะตะผ ะธั ะฒ ะฝัะถะฝัะน ัะพัะผะฐั.

ะะพััะฝะตะฝะธะต:
set_levels() ะฟะพะทะฒะพะปัะตั ะธะทะผะตะฝััั ัะพะปัะบะพ ะพะดะธะฝ ััะพะฒะตะฝั ะธะฝะดะตะบัะฐ.
MultiIndex ัะพััะพะธั ะธะท ะดะฒัั ััะพะฒะฝะตะน, ะธ ะฒะฐะผ ะฝัะถะฝะพ ะพะฟัะตะดะตะปะธัั, ะบะฐะบะพะน ััะพะฒะตะฝั ัะพัะธัะต ะธะทะผะตะฝะธัั: level=0 ะธะปะธ level=1.
ะะพะฟัะพะฑัะนัะต ััะธ ะผะตัะพะดั, ััะพะฑั ะฐะดะฐะฟัะธัะพะฒะฐัั ะฒะฐั ะบะพะด, ะธ ััะพ ะดะพะปะถะฝะพ ะฟะพะผะพัั ัะตัะธัั ะฒะฐัั ะทะฐะดะฐัั ั ะฟะตัะตะธะผะตะฝะพะฒะฐะฝะธะตะผ ััะพะปะฑัะพะฒ!






ะั ัะบะฐะทะฐะปะธ:
ะ ะบะฐะบ ะผะฝะต ัะดะฐะปะธัั ััะพะปะฑะตั business_id (ะพะฑะฐ, ะบัะพะผะต business_id statistics )

ะะฐัััะถะดะฐะปะฐ ะดะปั 6 ัะตะบัะฝะด
ะะทััะฐั ะทะฐะฟัะพั

ะกะตะนัะฐั ั ัะฐะทะฑะธัะฐััั ะฒ ะทะฐะฟัะพัะต ะฟะพะปัะทะพะฒะฐัะตะปั ะพ ัะดะฐะปะตะฝะธะธ ััะพะปะฑัะฐ business_id, ะธัะบะปััะฐั ััะพะปะฑะตั business_id statistics. ะญัะพ ะฟะพะดะฝะธะผะฐะตั ะฒะพะฟัะพั ะพะฑัะฐะฑะพัะบะธ ะดะฐะฝะฝัั ะธ ััััะบัััะธัะพะฒะฐะฝะธั ะพัะฒะตัะพะฒ. ะะฝัะตัะตัะฝะพ, ะบะฐะบ ััะพ ัะฟะพัะพะฑััะฒัะตั ัะปัััะตะฝะฝะพะผั ะฟะพะฝะธะผะฐะฝะธั ััะตะฑะพะฒะฐะฝะธะน.

ะัะตะผ ัะฟะพัะพะฑ

ะขะตะฟะตัั ั ะดัะผะฐั ะพ ัะพะผ, ะบะฐะบ ัััะตะบัะธะฒะฝะพ ัะดะฐะปะธัั ััะพะปะฑะตั business_id, ะธัะบะปััะฐั ััะพะปะฑะตั business_id statistics. ะญัะพ ััะตะฑัะตั ะฟะพะฝะธะผะฐะฝะธั ัะฟะตัะธัะธะบะธ ะทะฐะดะฐัะธ ะธ ัะผะตะฝะธั ัะพัะผัะปะธัะพะฒะฐัั ัะพัะฝัะต ะธะฝััััะบัะธะธ.

ะัั ัะตัะตะฝะธะต

ะกะตะนัะฐั ั ะธะทััะฐั ะทะฐะฟัะพั ะฟะพะปัะทะพะฒะฐัะตะปั ะพ ัะพะผ, ะบะฐะบ ัะดะฐะปะธัั ััะพะปะฑะตั business_id, ะธัะบะปััะฐั business_id statistics. ะญัะพ ะทะฐััะฐะฒะปัะตั ะผะตะฝั ะดัะผะฐัั ะพ ัะพะผ, ะบะฐะบ ัััะตะบัะธะฒะฝะพ ัะพััะฐะฒะธัั ะธะฝััััะบัะธั ะดะปั ะฒัะฟะพะปะฝะตะฝะธั ััะพะน ะทะฐะดะฐัะธ.

ะัั ะพะฟัะธะผะฐะปัะฝัะน ะฟััั

ะฏ ะดัะผะฐั ะพ ะทะฐะฟัะพัะต ะฟะพะปัะทะพะฒะฐัะตะปั ะฟะพ ัะดะฐะปะตะฝะธั ััะพะปะฑัะฐ business_id, ะธัะบะปััะฐั business_id statistics. ะะฐะถะฝะพ ัััะตะบัะธะฒะฝะพ ััะพัะผัะปะธัะพะฒะฐัั ะธะฝััััะบัะธั, ััะพะฑั ะทะฐะดะฐัะฐ ะฑัะปะฐ ะฒัะฟะพะปะฝะตะฝะฐ ะบะพััะตะบัะฝะพ.

ะัั ะพะฟัะธะผะฐะปัะฝะพะต ัะตัะตะฝะธะต

ะัะฐะบ, ั ะฟะตัะตะฑะธัะฐั ะฒะพะทะผะพะถะฝัะต ัะฟะพัะพะฑะฐะผ ัะดะฐะปะธัั ััะพะปะฑะตั business_id, ะธัะบะปััะฐั business_id statistics, ััะพะฑั ะฝะฐะนัะธ ะฝะฐะธะปัััะธะน ะฟะพะดัะพะด ะดะปั ะฒัะฟะพะปะฝะตะฝะธั ััะพะณะพ ะทะฐะฟัะพัะฐ.

ะัั ะพะฟัะธะผะฐะปัะฝัะต ัะตัะตะฝะธั

ะฏ ัะฐะทะฑะธัะฐััั ะฒ ะทะฐะฟัะพัะต ะฟะพะปัะทะพะฒะฐัะตะปั ะพ ัะพะผ, ะบะฐะบ ัะดะฐะปะธัั ััะพะปะฑะตั business_id, ะธัะบะปััะฐั business_id statistics, ะธ ะดัะผะฐั ะพ ะฝะฐะธะปัััะธั ัะฟะพัะพะฑะฐั ะดะปั ะฒัะฟะพะปะฝะตะฝะธั ััะพะน ะทะฐะดะฐัะธ.

ะงัะพะฑั ัะดะฐะปะธัั ััะพะปะฑัั ะฒ MultiIndex DataFrame, ะฒั ะผะพะถะตัะต ะธัะฟะพะปัะทะพะฒะฐัั ะผะตัะพะด drop ะดะปั ัะดะฐะปะตะฝะธั ะพะฟัะตะดะตะปัะฝะฝัั ััะพะฒะฝะตะน ะธะปะธ ััะพะปะฑัะพะฒ. ะ ะฒะฐัะตะผ ัะปััะฐะต, ะตัะปะธ ะฒั ัะพัะธัะต ัะดะฐะปะธัั ะฒัะต ััะพะปะฑัั, ะบัะพะผะต ัะตั, ะบะพัะพััะต ะพัะฝะพััััั ะบ business_id (ะบะฐะบ ะธะฝะดะตะบั) ะธ statistics, ะฒะพั ะบะฐะบ ััะพ ะผะพะถะฝะพ ัะดะตะปะฐัั:

ะัะธะผะตั:
ะฃะดะฐะปะธัั ะฒัะต ััะพะปะฑัั, ะบัะพะผะต ัะตั, ะบะพัะพััะต ะพัะฝะพััััั ะบ business_id ะธ statistics:
python
ะะพะฟะธัะพะฒะฐัั
# ะฃะดะฐะปัะตะผ ะฒัะต ััะพะปะฑัั, ะบัะพะผะต ัะตั, ะบะพัะพััะต ะพัะฝะพััััั ะบ 'business_id' ะธ 'statistics'
companies_average_stars = companies_average_stars.loc[:, companies_average_stars.columns.get_level_values(0) == 'business_id']

# ะัะพะฒะตััะตะผ ัะตะทัะปััะฐั
print(companies_average_stars)
ะะดะตัั:

get_level_values(0) ะฒะพะทะฒัะฐัะฐะตั ะทะฝะฐัะตะฝะธั ะฟะตัะฒะพะณะพ ััะพะฒะฝั ะธะฝะดะตะบัะฐ (ัะพ ะตััั business_id), ะธ ะผั ะฒัะฑะธัะฐะตะผ ัะพะปัะบะพ ัะต ััะพะปะฑัั, ะบะพัะพััะต ัะพะพัะฒะตัััะฒััั ััะพะผั ะทะฝะฐัะตะฝะธั.
ะัะปะธ ะฒั ัะพัะธัะต ัะดะฐะปััั ะบะพะฝะบัะตัะฝัะต ััะพะปะฑัั ะฝะฐ ััะพะฒะฝะต MultiIndex, ะธัะฟะพะปัะทัะนัะต drop:
python
ะะพะฟะธัะพะฒะฐัั
# ะฃะดะฐะปัะตะผ ััะพะปะฑัั ั ััะพะฒะฝัะผะธ, ะบะพัะพััะต ะฝะต ะฝัะถะฝั
companies_average_stars = companies_average_stars.drop(columns=[('Unnamed: 0', 'mean'), ('Unnamed: 0', 'size')])

# ะัะพะฒะตััะตะผ ัะตะทัะปััะฐั
print(companies_average_stars)
ะะดะตัั ะผั ะธัะฟะพะปัะทัะตะผ ะผะตัะพะด drop ั ัะบะฐะทะฐะฝะธะตะผ ัะพัะฝัั ะทะฝะฐัะตะฝะธะน ะฝะฐ ะพะฑะพะธั ััะพะฒะฝัั ะธะฝะดะตะบัะฐ ('Unnamed: 0', 'mean' ะธ 'size'), ััะพะฑั ัะดะฐะปะธัั ััะธ ััะพะปะฑัั.

ะะพััะฝะตะฝะธะต:
get_level_values(0): ะฒัะฑะธัะฐะตั ััะพะปะฑัั ั ะบะพะฝะบัะตัะฝัะผ ะทะฝะฐัะตะฝะธะตะผ ะฝะฐ ััะพะฒะฝะต 0 (ะฒ ะดะฐะฝะฝะพะผ ัะปััะฐะต, ะดะปั business_id).
drop(columns=[...]): ัะดะฐะปัะตั ัะบะฐะทะฐะฝะฝัะต ััะพะปะฑัั ะฟะพ ัะพัะฝัะผ ะทะฝะฐัะตะฝะธัะผ ะธั ะธะฝะดะตะบัะพะฒ ะฒ MultiIndex.
ะัะฟะพะปัะทัั ััะธ ะผะตัะพะดั, ะฒั ะผะพะถะตัะต ัะดะฐะปะธัั ะฝะตะฝัะถะฝัะต ััะพะปะฑัั ะธ ะพััะฐะฒะธัั ัะพะปัะบะพ ัะต, ะบะพัะพััะต ะฒะฐะผ ะฝะตะพะฑัะพะดะธะผั.






ะั ัะบะฐะทะฐะปะธ:
ะะฐะบ ัะฑัะฐัั ััะพะฒะฝะธ ะฒ ััะพะปะฑัะฐั ะธ ะฟัะพััะพ ะดะฐัั ะธะผ ะฝะฐะทะฒะฐะฝะธะต? 

ะะฐัััะถะดะฐะปะฐ ะดะปั 6 ัะตะบัะฝะด
ะะฐะทะผััะปัั ะฝะฐะด ะทะฐะฟัะพัะพะผ
ะะฐััะผะฐััะธะฒะฐั ะทะฐะฟัะพั ะฟะพะปัะทะพะฒะฐัะตะปั ะฟะพ ัะดะฐะปะตะฝะธั ััะพะฒะฝะตะน ะฒ ััะพะปะฑัะฐั ะธ ะทะฐะผะตะฝะต ะธั ะฝะฐะทะฒะฐะฝะธัะผะธ, ััะพะฑั ะฟะพะฝััั, ะบะฐะบ ะพัะฒะตัะธัั ัััะตะบัะธะฒะฝะพ.

ะะฐััะผะฐััะธะฒะฐั ะทะฐะฟัะพั
ะฏ ะดัะผะฐั ะพ ะทะฐะฟัะพัะต ะฟะพะปัะทะพะฒะฐัะตะปั ะฟะพ ัะดะฐะปะตะฝะธั ััะพะฒะฝะตะน ะฒ ััะพะปะฑัะฐั ะธ ะทะฐะผะตะฝะต ะธั ะฝะฐะทะฒะฐะฝะธัะผะธ, ััะพะฑั ะฟะพะฝััั, ะบะฐะบ ะพัะฒะตัะธัั ะฑะพะปะตะต ัััะตะบัะธะฒะฝะพ.

ะะฐััะผะฐััะธะฒะฐั ะทะฐะฟัะพั
ะฏ ะธััะปะตะดัั ะทะฐะฟัะพั ะฟะพะปัะทะพะฒะฐัะตะปั ะฟะพ ัะดะฐะปะตะฝะธั ััะพะฒะฝะตะน ะฒ ััะพะปะฑัะฐั ะธ ะทะฐะผะตะฝะต ะธั ะฝะฐะทะฒะฐะฝะธัะผะธ, ััะพะฑั ะฟะพะฝััั, ะบะฐะบ ะพัะฒะตัะธัั ะฑะพะปะตะต ัััะตะบัะธะฒะฝะพ.

ะะฐััะผะฐััะธะฒะฐั ะทะฐะฟัะพั
ะัะตะฝะธะฒะฐั ะทะฐะฟัะพั ะฟะพะปัะทะพะฒะฐัะตะปั ะฟะพ ัะดะฐะปะตะฝะธั ััะพะฒะฝะตะน ะฒ ััะพะปะฑัะฐั ะธ ะทะฐะผะตะฝะต ะธั ะฝะฐะทะฒะฐะฝะธัะผะธ, ััะพะฑั ะพะฟัะตะดะตะปะธัั ะฝะฐะธะปัััะธะน ัะฟะพัะพะฑ ะพัะฒะตัะธัั.

ะะฐััะผะฐััะธะฒะฐั ะทะฐะฟัะพั
ะัะตะฝะธะฒะฐั ะทะฐะฟัะพั ะฟะพะปัะทะพะฒะฐัะตะปั ะฟะพ ัะดะฐะปะตะฝะธั ััะพะฒะฝะตะน ะฒ ััะพะปะฑัะฐั ะธ ะทะฐะผะตะฝะต ะธั ะฝะฐะทะฒะฐะฝะธัะผะธ, ััะพะฑั ะฝะฐะนัะธ ะฝะฐะธะปัััะธะน ัะฟะพัะพะฑ ะพัะฒะตัะฐ.

ะะฐะทะผััะปัั ะฝะฐะด ะทะฐะฟัะพัะพะผ
ะฏ ะดัะผะฐั ะพ ะทะฐะฟัะพัะต ะฟะพะปัะทะพะฒะฐัะตะปั ะฟะพ ัะดะฐะปะตะฝะธั ััะพะฒะฝะตะน ะฒ ััะพะปะฑัะฐั ะธ ะทะฐะผะตะฝะต ะธั ะฝะฐะทะฒะฐะฝะธัะผะธ, ััะพะฑั ะฟะพะดะพะนัะธ ะบ ััะพะผั ัััะตะบัะธะฒะฝะพ ะธ ะพัะพะทะฝะฐะฝะฝะพ.

ะงัะพะฑั ัะฑัะฐัั ััะพะฒะฝะธ ะฒ ััะพะปะฑัะฐั MultiIndex ะธ ะฟัะพััะพ ะฟัะตะพะฑัะฐะทะพะฒะฐัั ะธั ะฒ ะพะฑััะฝัะต ััะพะปะฑัั ั ะพะดะฝะพััะพะฒะฝะตะฒัะผะธ ะธะผะตะฝะฐะผะธ, ะผะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ะผะตัะพะด reset_index() ะธะปะธ ะพะฑัะตะดะธะฝะธัั ััะพะฒะฝะธ ะธะฝะดะตะบัะฐ ะฒ ะพะดะธะฝ ัััะพะบะพะฒัะน ัะพัะผะฐั ั ะฟะพะผะพััั ะผะตัะพะดะฐ map.

ะจะฐะณะธ:
ะะฑัะตะดะธะฝะธัั ััะพะฒะฝะธ ะธะฝะดะตะบัะฐ ะฒ ะพะดะฝะพะผ ััะพะปะฑัะต.
ะัะตะพะฑัะฐะทะพะฒะฐัั MultiIndex ะฒ ะพะฑััะฝัะน ะธะฝะดะตะบั.
ะะพั ะฟัะธะผะตั, ะบะฐะบ ััะพ ะผะพะถะฝะพ ัะดะตะปะฐัั:

ะัะธะผะตั:
python
ะะพะฟะธัะพะฒะฐัั
# ะัะตะพะฑัะฐะทัะตะผ MultiIndex ััะพะปะฑัะพะฒ ะฒ ะพะฑััะฝัะน, ะบะพะผะฑะธะฝะธััั ััะพะฒะฝะธ
companies_average_stars.columns = ['_'.join(col) for col in companies_average_stars.columns]

# ะัะพะฒะตััะตะผ ัะตะทัะปััะฐั
print(companies_average_stars)
ะะพััะฝะตะฝะธะต:
ะ ััะพะผ ะฟัะธะผะตัะต ะผั ะฟัะพัะพะดะธะผ ะฟะพ ะฒัะตะผ ััะพะปะฑัะฐะผ ะธ ะพะฑัะตะดะธะฝัะตะผ ะทะฝะฐัะตะฝะธั ะธะท ะพะฑะพะธั ััะพะฒะฝะตะน ั ะฟะพะผะพััั '_'.join(col). ะญัะพ ะฟัะตะฒัะฐัะฐะตั MultiIndex ะฒ ะพะดะธะฝ ััะพะฒะตะฝั, ะณะดะต ะฝะฐะทะฒะฐะฝะธั ััะพะปะฑัะพะฒ ะฑัะดัั ะฒัะณะปัะดะตัั, ะฝะฐะฟัะธะผะตั, ะบะฐะบ 'business_id_mean', 'business_id_size', 'stars_mean', 'stars_size'.
ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะฒั ะฟะพะปััะธัะต DataFrame, ะณะดะต ะบะฐะถะดัะน ััะพะปะฑะตั ะฑัะดะตั ะธะผะตัั ะพะดะฝะพััะพะฒะฝะตะฒะพะต ะธะผั, ะพะฑัะตะดะธะฝัะฝะฝะพะต ะธะท ะดะฒัั ััะพะฒะฝะตะน.

ะะพะฟะพะปะฝะธัะตะปัะฝะพ:
ะัะปะธ ะฒะฐะผ ะฝัะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ะดััะณะธะต ัะฐะทะดะตะปะธัะตะปะธ (ะฝะฐะฟัะธะผะตั, ะฟัะพะฑะตะป ะธะปะธ ะดะตัะธั), ะฟัะพััะพ ะธะทะผะตะฝะธัะต '_'.join(col) ะฝะฐ ะฝัะถะฝัะน ัะฐะทะดะตะปะธัะตะปั:

python
ะะพะฟะธัะพะฒะฐัั
companies_average_stars.columns = ['-'.join(col) for col in companies_average_stars.columns]
ะขะตะฟะตัั ะฒัะต ััะพะปะฑัั ะฑัะดัั ะฑะตะท ะผะฝะพะณะพะบัะฐัะฝัั ััะพะฒะฝะตะน ะธะฝะดะตะบัะฐ ะธ ั ะฑะพะปะตะต ะฟะพะฝััะฝัะผะธ ะธะผะตะฝะฐะผะธ.






ะั ัะบะฐะทะฐะปะธ:
ะะฐะบ ัะดะตะปะฐัั ะณัะฐะดะฐัะธั RGB ัะฒะตัะฐ ัะพะพัะฒะตัััะฒะตะฝะฝะพ ะพัะตะฝะบะธ ะพั 1 ะดะพ 5 ?

ะะฐัััะถะดะฐะปะฐ ะดะปั 5 ัะตะบัะฝะด
ะัั ัะตัะตะฝะธั

ะฏ ะดัะผะฐั ะพ ะณะตะฝะตัะฐัะธะธ ะณัะฐะดะฐัะธะธ RGB ัะฒะตัะฐ ะดะปั ะพัะตะฝะพะบ ะพั 1 ะดะพ 5, ััะพะฑั ะฒะธะทัะฐะปะธะทะธัะพะฒะฐัั ะธั.

ะัะตะผ ะฟะพะดัะพะด

ะฏ ัะฐะฑะพัะฐั ะฝะฐะด ะทะฐะดะฐัะตะน ะณัะฐะดะฐัะธะธ RGB ัะฒะตัะฐ ะดะปั ะพัะตะฝะพะบ ะพั 1 ะดะพ 5, ััะพะฑั ัััะตะบัะธะฒะฝะพ ะฒะธะทัะฐะปะธะทะธัะพะฒะฐัั ะบะฐะถะดัั ะพัะตะฝะบั.

ะกะพะทะดะฐะฝะธะต ะณัะฐะดะฐัะธะธ RGB

ะฏ ะธััะปะตะดัั ะฟะพะดัะพะดั ะบ ัะพะทะดะฐะฝะธั RGB ะณัะฐะดะฐัะธะธ ะดะปั ะพัะตะฝะพะบ ะพั 1 ะดะพ 5, ััะพะฑั ะพะฑะตัะฟะตัะธัั ะธั ะฒะธะทัะฐะปัะฝัั ัะฝะธะบะฐะปัะฝะพััั ะธ ะฒะพัะฟัะธะฝะธะผะฐะตะผัั ะทะฝะฐัะธะผะพััั.

ะกะพะทะดะฐั ัะฝะธะบะฐะปัะฝัะต ะณัะฐะดะฐัะธะธ

ะฏ ัะฐะฑะพัะฐั ะฝะฐะด ัะฐะทะฒะธัะธะตะผ ัะฝะธะบะฐะปัะฝัั ะณัะฐะดะฐัะธะน RGB ะดะปั ะบะฐะถะดะพะน ะพัะตะฝะบะธ ะพั 1 ะดะพ 5, ััะพะฑั ัะดะตะปะฐัั ะบะฐะถะดัั ะฒะธะทัะฐะปัะฝะพ ัะฐะทะปะธัะธะผะพะน ะธ ะทะฝะฐัะธะผะพะน.

ะกะพะทะดะฐั ะณัะฐะดะฐัะธั

ะฏ ัะพัะผะธััั ะณัะฐะดะฐัะธั RGB ะดะปั ะพัะตะฝะพะบ ะพั 1 ะดะพ 5, ััะพะฑั ะพะฑะตัะฟะตัะธัั ะฒะธะทัะฐะปัะฝะพะต ัะฐะทะปะธัะธะต ะธ ัะพะพัะฒะตัััะฒะธะต. ะญัะพ ัะฐะณ, ะฝะฐะฟัะฐะฒะปะตะฝะฝัะน ะฝะฐ ะฟัะตะพะฑัะฐะถะตะฝะธะต ะดะฐะฝะฝัั ะฒ ะฟัะพััะพะน ะธ ะฟะพะฝััะฝัะน ัะพัะผะฐั.

ะัั ะฟะพะดัะพะดั

ะฏ ะธััะปะตะดัั ัะฟะพัะพะฑั ัะพะทะดะฐะฝะธั ะณัะฐะดะฐัะธะธ RGB ะดะปั ะพัะตะฝะพะบ ะพั 1 ะดะพ 5, ััะพะฑั ะพะฑะตัะฟะตัะธัั ะธั ะฒะธะทัะฐะปัะฝะพะต ัะฐะทะปะธัะธะต ะธ ัะพะพัะฒะตัััะฒะธะต, ััะพ ะฟะพะผะพะณะฐะตั ะปัััะต ะฟะพะฝััั ะดะฐะฝะฝัะต.

ะะปั ัะพะทะดะฐะฝะธั ะณัะฐะดะฐัะธะธ ัะฒะตัะฐ ะฒ ัะพัะผะฐัะต RGB ะฝะฐ ะพัะฝะพะฒะต ะทะฝะฐัะตะฝะธะน ะพั 1 ะดะพ 5 (ะฝะฐะฟัะธะผะตั, ะดะปั ะพัะพะฑัะฐะถะตะฝะธั ะพัะตะฝะพะบ ะพั 1 ะดะพ 5), ะฒั ะผะพะถะตัะต ะธัะฟะพะปัะทะพะฒะฐัั ะปะธะฝะตะนะฝัั ะธะฝัะตัะฟะพะปััะธั ะผะตะถะดั ะดะฒัะผั ัะฒะตัะฐะผะธ (ะฝะฐะฟัะธะผะตั, ะผะตะถะดั ะบัะฐัะฝัะผ ะดะปั 1 ะธ ะทะตะปัะฝัะผ ะดะปั 5).

ะะปั ััะพะณะพ ะผะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ััะฝะบัะธั, ะบะพัะพัะฐั ะฑัะดะตั ะณะตะฝะตัะธัะพะฒะฐัั ะทะฝะฐัะตะฝะธั RGB ะฒ ะทะฐะฒะธัะธะผะพััะธ ะพั ะพัะตะฝะบะธ. ะัะธะผะตั:

ะัะธะผะตั:
python
ะะพะฟะธัะพะฒะฐัั
import numpy as np
import matplotlib.pyplot as plt

def rating_to_rgb(rating):
    """
    ะัะตะพะฑัะฐะทัะตั ะพัะตะฝะบั ะพั 1 ะดะพ 5 ะฒ RGB ัะฒะตั:
    1 -> ะัะฐัะฝัะน (rgb(255, 0, 0))
    5 -> ะะตะปัะฝัะน (rgb(0, 255, 0))
    ะัะตะฝะบะธ ะผะตะถะดั ะฝะธะผะธ ะฟะปะฐะฒะฝะพ ะธะฝัะตัะฟะพะปะธัััั ะผะตะถะดั ะบัะฐัะฝัะผ ะธ ะทะตะปัะฝัะผ.
    """
    # ะัะพะฒะตััะตะผ, ััะพะฑั ะพัะตะฝะบะฐ ะฑัะปะฐ ะฒ ะฟัะตะดะตะปะฐั ะพั 1 ะดะพ 5
    rating = np.clip(rating, 1, 5)
    
    # ะะฝัะตัะฟะพะปะธััะตะผ ะผะตะถะดั ะบัะฐัะฝัะผ (255, 0, 0) ะธ ะทะตะปัะฝัะผ (0, 255, 0)
    red = int((5 - rating) * 255 / 4)  # ะัะฐัะฝัะน ะบะพะผะฟะพะฝะตะฝั
    green = int((rating - 1) * 255 / 4)  # ะะตะปัะฝัะน ะบะพะผะฟะพะฝะตะฝั
    blue = 0  # ะกะธะฝะธะน ะบะพะผะฟะพะฝะตะฝั ะฒัะตะณะดะฐ 0

    return (red, green, blue)

# ะัะธะผะตั ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะดะปั ะฒะธะทัะฐะปะธะทะฐัะธะธ
ratings = [1, 2, 3, 4, 5]  # ะัะตะฝะบะธ ะพั 1 ะดะพ 5
colors = [rating_to_rgb(rating) for rating in ratings]

# ะะธะทัะฐะปะธะทะฐัะธั
plt.figure(figsize=(10, 2))
for i, rating in enumerate(ratings):
    plt.bar(i, 1, color=np.array(colors[i])/255)  # ะะพัะผะฐะปะธะทัะตะผ ัะฒะตัะฐ ะดะปั ะพัะพะฑัะฐะถะตะฝะธั
plt.xticks(range(len(ratings)), ratings)
plt.title("ะัะฐะดะฐัะธั ัะฒะตัะพะฒ ะดะปั ะพัะตะฝะพะบ ะพั 1 ะดะพ 5")
plt.show()
ะะพััะฝะตะฝะธะต:
ะคัะฝะบัะธั rating_to_rgb:

ะั ะธะฝัะตัะฟะพะปะธััะตะผ ะผะตะถะดั ะบัะฐัะฝัะผ ัะฒะตัะพะผ ะดะปั ะพัะตะฝะบะธ 1 ะธ ะทะตะปัะฝัะผ ัะฒะตัะพะผ ะดะปั ะพัะตะฝะบะธ 5. ะะปั ะทะฝะฐัะตะฝะธะน ะผะตะถะดั ััะธะผะธ ะพัะตะฝะบะฐะผะธ ัะฒะตั ะฟะปะฐะฒะฝะพ ะผะตะฝัะตััั ะพั ะบัะฐัะฝะพะณะพ ะบ ะทะตะปัะฝะพะผั.
ะะปั ััะพะณะพ ะผั ะฒััะธัะปัะตะผ ะบะพะผะฟะพะฝะตะฝัั ะบัะฐัะฝะพะณะพ (red) ะธ ะทะตะปัะฝะพะณะพ (green) ะฝะฐ ะพัะฝะพะฒะต ัะตะบััะตะน ะพัะตะฝะบะธ, ะธัะฟะพะปัะทัั ะปะธะฝะตะนะฝัั ะธะฝัะตัะฟะพะปััะธั:
red = int((5 - rating) * 255 / 4)
green = int((rating - 1) * 255 / 4)
ะกะธะฝะธะน ะบะพะผะฟะพะฝะตะฝั ะพััะฐะฒะปัะตะผ ัะฐะฒะฝัะผ ะฝัะปั.
ะัะพะฑัะฐะถะตะฝะธะต ัะฒะตัะฐ:

ะั ัะพะทะดะฐัะผ ะฟัะพััะพะน ะณัะฐัะธะบ, ะณะดะต ะบะฐะถะดะฐั ะพัะตะฝะบะฐ ะพั 1 ะดะพ 5 ะพัะพะฑัะฐะถะฐะตััั ั ัะพะพัะฒะตัััะฒัััะธะผ ัะฒะตัะพะผ. ะฆะฒะตั ะฟะปะฐะฒะฝะพ ะผะตะฝัะตััั ะพั ะบัะฐัะฝะพะณะพ ะดะพ ะทะตะปัะฝะพะณะพ.
ะะพัะผะฐะปะธะทะฐัะธั:

ะั ะดะตะปะธะผ ะทะฝะฐัะตะฝะธั ัะฒะตัะฐ ะฝะฐ 255 ะดะปั ะบะพััะตะบัะฝะพะณะพ ะพัะพะฑัะฐะถะตะฝะธั ะฒ Matplotlib, ัะฐะบ ะบะฐะบ ะพะฝะฐ ะพะถะธะดะฐะตั ะทะฝะฐัะตะฝะธั ัะฒะตัะฐ ะฒ ะดะธะฐะฟะฐะทะพะฝะต ะพั 0 ะดะพ 1.
ะญัะพั ะฟะพะดัะพะด ัะพะทะดะฐัั ะฟะปะฐะฒะฝัั ะณัะฐะดะฐัะธั ัะฒะตัะฐ ะดะปั ะพัะตะฝะพะบ ะพั 1 ะดะพ 5 ะฒ ัะพัะผะฐัะต RGB.






ะั ัะบะฐะทะฐะปะธ:
ะกะตะนัะฐั ั ะผะตะฝั ะฟะพัะตะผั ัะพ ะฒัะต ัะตัะฝะพะต. ะะฐะดะพ ะฟะพะฝะธะผะฐัั, ััะพ ะฝะตะพะฑัะพะดะธะผะพ ัะฐะทะปะธัะฐัั ะปัััะต ะฒัะตะณะพ ะผะตะถะดั ะพัะผะตัะบะฐะผะธ 3 ะธ 5, ะฟะพัะพะผั ััะพ ะฝะธะถะต, ะพัะตะฒะธะดะฝะพ, ะพัะตะฝั ะผะฐะปะพ. 

ะฏ ัััะพั ะบะฐััั. 

# ะฑะปะธะฝ, ั ะดะพ ััะพะณะพ ะธ ัะฐะบ ะฟะพัััะพะธะป ะธะฝัะตัะฐะบัะธะฒะฝัั ะบะฐััั, ะฝะต ะดะพัะธัะฐะฒ ะดะพ ะบะพะฝัะฐ.

m = folium.Map(location=[top_city_businesses['latitude'].mean(), top_city_businesses['longitude'].mean()],
               zoom_start=10)


def rating_to_rgb(rating):
    """
    ะัะตะพะฑัะฐะทัะตั ะพัะตะฝะบั ะพั 1 ะดะพ 5 ะฒ RGB ัะฒะตั:
    1 -> ะัะฐัะฝัะน (rgb(255, 0, 0))
    5 -> ะะตะปัะฝัะน (rgb(0, 255, 0))
    ะัะตะฝะบะธ ะผะตะถะดั ะฝะธะผะธ ะฟะปะฐะฒะฝะพ ะธะฝัะตัะฟะพะปะธัััั ะผะตะถะดั ะบัะฐัะฝัะผ ะธ ะทะตะปัะฝัะผ.
    """
    # ะัะพะฒะตััะตะผ, ััะพะฑั ะพัะตะฝะบะฐ ะฑัะปะฐ ะฒ ะฟัะตะดะตะปะฐั ะพั 1 ะดะพ 5
    rating = np.clip(rating, 1, 5)

    # ะะฝัะตัะฟะพะปะธััะตะผ ะผะตะถะดั ะบัะฐัะฝัะผ (255, 0, 0) ะธ ะทะตะปัะฝัะผ (0, 255, 0)
    red = int((5 - rating) * 255 / 4)  # ะัะฐัะฝัะน ะบะพะผะฟะพะฝะตะฝั
    green = int((rating - 1) * 255 / 4)  # ะะตะปัะฝัะน ะบะพะผะฟะพะฝะตะฝั
    blue = 0  # ะกะธะฝะธะน ะบะพะผะฟะพะฝะตะฝั ะฒัะตะณะดะฐ 0

    return red, green, blue


for idx, row in best_city_reviews_expanded.iterrows():
    if idx % 5 == 0:
        folium.CircleMarker(
            location=[row['latitude'], row['longitude']],
            radius=4,
            color=rating_to_rgb(row['avg_rating']),
            fill=True,
            fill_opacity=0.3
        ).add_to(m)

m.save('my_map3.html')
m


ะัะปะธ ั ะผะตะฝั ััะพ-ัะพ ะฝะต ัะฐะบ, ะฝะฐะฟะธัะธ. ะะพ ะผะฝะต, ะฝะฐะฒะตัะฝะพ, ะฟัะพััะพ ะฝัะถะฝะฐ ะดััะณะฐั ััะฝะบัะธั ะธะทะผะฝะตะฝะธั ัะฒะตัะฐ 

ะะฐัััะถะดะฐะปะฐ ะดะปั 7 ัะตะบัะฝะด
ะัััะฝะตะฝะธะต ะฟัะธัะธะฝั ะฟัะพะฑะปะตะผั

ะกะตะนัะฐั ะฒัั ัะตัะฝะพะต. ะะฐะฒะฐะนัะต ัะฐะทะฑะตัะตะผัั, ััะพ ะผะพะถะตั ะฑััั ะฟัะธัะธะฝะพะน.

ะะฐะทะผััะปัั ะฝะฐะด ะฟัะธัะธะฝะฐะผะธ

ะะพะดัะผะฐะน ะพ ะฟัะธัะธะฝะฐั ะฟะพัะฒะปะตะฝะธั ัะตะผะฝะพะณะพ ัะบัะฐะฝะฐ. ะะฐะถะฝะพ ัะฐะทะพะฑัะฐัััั, ะบะฐะบ ัะฐะทะปะธัะฐัั ะธ ััะพ ะธะผะตะตั ะทะฝะฐัะตะฝะธะต.

ะัะบะปััะฐะตะผ ะฒะฝะตัะฝะธะต ัะฐะบัะพัั

ะััะปะตะดัั ะฒะฝะตัะฝะธะต ะฟัะธัะธะฝั, ะบะฐะบ ะฝะธะทะบะฐั ะพัะฒะตัะตะฝะฝะพััั ะธะปะธ ะฟะพะฒัะตะถะดะตะฝะธั ัะบัะฐะฝะฐ. ะกะผะตัะฐั ัะพะบัั ะฝะฐ ะฐะฟะฟะฐัะฐัะฝัะต ะฟัะพะฑะปะตะผั ะธ ะฝะฐัััะพะนะบะธ.

ะัะฟัะฐะฒะปะตะฝะธะต ะฝะฐัััะพะตะบ ะธ ะพะฑะฝะพะฒะปะตะฝะธะต

ะัะพะฒะตััั ะฝะฐัััะพะนะบะธ ัะบัะฐะฝะฐ ะธ ะะก, ััะพะฑั ะฟะพะฝััั ะฟัะธัะธะฝั. ะะฑะฝะพะฒะปัั ะดัะฐะนะฒะตัั ะธ ัะธััะตะผั, ะฝะฐะดะตััั ะฝะฐ ัะปัััะตะฝะธะต.

ะัะพะฒะตััั ะดะตัะฐะปะธ

ะะทััะฐั ะดะธัะฟะปะตะน ะฝะฐ ะฟัะตะดะผะตั ะฟะพะฒัะตะถะดะตะฝะธะน ะธะปะธ ะฟััะตะฝ. ะกัะฐะฒะฝะธะฒะฐั ะธะทะพะฑัะฐะถะตะฝะธะต ั ะบะฐัะตััะฒะตะฝะฝัะผ ะผะฐัะตัะธะฐะปะพะฒ, ััะพะฑั ะฟะพะฝััั, ััะพ ะธะผะตะฝะฝะพ ะฒะปะธัะตั ะฝะฐ ะฒะพัะฟัะธััะธะต.

ะะพะฝะธะผะฐะฝะธะต ัะฐะทะปะธัะตะฝะธะน

ะัะตะดะปะฐะณะฐั ะพะฑัััะฝะธัั ะฟะพะปัะทะพะฒะฐัะตะปั, ะบะฐะบ ะฟัะฐะฒะธะปัะฝะพ ัะฐะทะปะธัะฐัั ะฒะฐะถะฝัะต ะพัะผะตัะบะธ.

ะัะตะผ ะฟัะธัะธะฝั

ะะฐะทะฑะธัะฐั ะฟัะธัะธะฝั ัะตะผะฝะพะณะพ ัะบัะฐะฝะฐ: ะฝะฐัััะพะนะบะฐ ััะบะพััะธ, ะฟัะพะณัะฐะผะผะฝัะต ะธ ะฐะฟะฟะฐัะฐัะฝัะต ะฟัะพะฑะปะตะผั, ะฟะพะฒัะตะถะดะตะฝะธั ัะบัะฐะฝะฐ ะธะปะธ ะพัะฒะตัะตะฝะฝะพััั.

ะัั ะฟัะธัะธะฝั

ะัะพะฒะตััั ะฝะฐัััะพะนะบะธ ัะบัะฐะฝะฐ ะธ ะก, ะพะฑะฝะพะฒะปัั ะดัะฐะนะฒะตัั, ััะพะฑั ััััะฐะฝะธัั ัะตะผะฝัะน ัะบัะฐะฝ. ะัะปะธ ะฝะต ะฟะพะผะพะณะฐะตั, ะฟะพะดะพะทัะตะฒะฐั ะฐะฟะฟะฐัะฐัะฝัะต ะธะปะธ ะฟัะพะณัะฐะผะผะฝัะต ัะฑะพะธ.

ะัะพะฑะปะตะผะฐ, ัะบะพัะตะต ะฒัะตะณะพ, ะทะฐะบะปััะฐะตััั ะฒ ัะพะผ, ะบะฐะบ ะฟัะพะธััะพะดะธั ะธะฝัะตัะฟะพะปััะธั ะผะตะถะดั ะบัะฐัะฝัะผ ะธ ะทะตะปัะฝัะผ ัะฒะตัะฐะผะธ. ะะฐัะตะน ะทะฐะดะฐัะตะน ัะฒะปัะตััั ัะพะทะดะฐัั ะฑะพะปะตะต ะทะฐะผะตัะฝัั ัะฐะทะฝะธัั ะผะตะถะดั ะพัะตะฝะบะฐะผะธ 3 ะธ 5, ััะพ ััะตะฑัะตั ะฑะพะปะตะต ัััะบะพะน ะณัะฐะดะฐัะธะธ ะดะปั ััะธั ะทะฝะฐัะตะฝะธะน.

ะะตัะตะฝะธะต: ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะดััะณะพะน ััะฝะบัะธะธ ะดะปั ะธะทะผะตะฝะตะฝะธั ัะฒะตัะฐ
ะะผะตััะพ ะปะธะฝะตะนะฝะพะน ะธะฝัะตัะฟะพะปััะธะธ, ะบะพัะพัะฐั ะดะฐัั ะพัะตะฝั ะฟะปะฐะฒะฝัะน ะฟะตัะตัะพะด ะผะตะถะดั ัะฒะตัะฐะผะธ, ะฒั ะผะพะถะตัะต ะธัะฟะพะปัะทะพะฒะฐัั ะฝะตะฟััะผัั (ะฝะฐะฟัะธะผะตั, ะบะฒะฐะดัะฐัะธัะฝัั ะธะปะธ ัะบัะฟะพะฝะตะฝัะธะฐะปัะฝัั) ะธะฝัะตัะฟะพะปััะธั, ััะพะฑั ัะฒะตะปะธัะธัั ะบะพะฝััะฐัั ะผะตะถะดั ะพะฟัะตะดะตะปัะฝะฝัะผะธ ะทะฝะฐัะตะฝะธัะผะธ. ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ัะฐะทะฝะธัะฐ ะผะตะถะดั ะพัะตะฝะบะฐะผะธ 3 ะธ 5 ััะฐะฝะตั ะฑะพะปะตะต ะทะฐะผะตัะฝะพะน.

1. ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะบะฒะฐะดัะฐัะธัะฝะพะน ะธะฝัะตัะฟะพะปััะธะธ:
python
ะะพะฟะธัะพะฒะฐัั
import folium
import numpy as np

m = folium.Map(location=[top_city_businesses['latitude'].mean(), top_city_businesses['longitude'].mean()],
               zoom_start=10)

def rating_to_rgb(rating):
    """
    ะัะตะพะฑัะฐะทัะตั ะพัะตะฝะบั ะพั 1 ะดะพ 5 ะฒ RGB ัะฒะตั ั ัะปัััะตะฝะฝะพะน ะณัะฐะดะฐัะธะตะน ะดะปั ะทะฝะฐัะตะฝะธะน ะพั 3 ะดะพ 5.
    1 -> ะัะฐัะฝัะน (rgb(255, 0, 0))
    5 -> ะะตะปัะฝัะน (rgb(0, 255, 0))
    ะัะตะฝะบะธ ะผะตะถะดั ะฝะธะผะธ ะฟะปะฐะฒะฝะพ ะธะฝัะตัะฟะพะปะธัััั ั ัะฒะตะปะธัะตะฝะฝัะผ ะบะพะฝััะฐััะพะผ ะพั 3 ะดะพ 5.
    """
    # ะัะพะฒะตััะตะผ, ััะพะฑั ะพัะตะฝะบะฐ ะฑัะปะฐ ะฒ ะฟัะตะดะตะปะฐั ะพั 1 ะดะพ 5
    rating = np.clip(rating, 1, 5)

    # ะัะธะผะตะฝัะตะผ ะบะฒะฐะดัะฐัะธัะฝัั ะธะฝัะตัะฟะพะปััะธั ะดะปั ัะฒะตะปะธัะตะฝะธั ะบะพะฝััะฐััะฐ ะผะตะถะดั 3 ะธ 5
    norm_rating = (rating - 1) / 4  # ะะพัะผะฐะปะธะทัะตะผ ะทะฝะฐัะตะฝะธะต ะพั 0 ะดะพ 1
    norm_rating = norm_rating ** 2  # ะัะธะผะตะฝัะตะผ ะบะฒะฐะดัะฐัะธัะฝัั ััะฝะบัะธั ะดะปั ัะฒะตะปะธัะตะฝะธั ะบะพะฝััะฐััะฐ

    # ะะฝัะตัะฟะพะปะธััะตะผ ะผะตะถะดั ะบัะฐัะฝัะผ (255, 0, 0) ะธ ะทะตะปัะฝัะผ (0, 255, 0)
    red = int((1 - norm_rating) * 255)  # ะัะฐัะฝัะน ะบะพะผะฟะพะฝะตะฝั
    green = int(norm_rating * 255)  # ะะตะปัะฝัะน ะบะพะผะฟะพะฝะตะฝั
    blue = 0  # ะกะธะฝะธะน ะบะพะผะฟะพะฝะตะฝั ะฒัะตะณะดะฐ 0

    return red, green, blue

for idx, row in best_city_reviews_expanded.iterrows():
    if idx % 5 == 0:
        folium.CircleMarker(
            location=[row['latitude'], row['longitude']],
            radius=4,
            color=rating_to_rgb(row['avg_rating']),
            fill=True,
            fill_opacity=0.3
        ).add_to(m)

# ะกะพััะฐะฝะตะฝะธะต ะบะฐััั
m.save('my_map3.html')
m
ะะพััะฝะตะฝะธะต:
ะะพัะผะฐะปะธะทะฐัะธั: ะั ะฝะพัะผะฐะปะธะทัะตะผ ะพัะตะฝะบั, ััะพะฑั ะฟัะธะฒะตััะธ ะตั ะบ ะดะธะฐะฟะฐะทะพะฝั [0, 1], ะทะฐัะตะผ ะฟัะธะผะตะฝัะตะผ ะบะฒะฐะดัะฐัะธัะฝัั ะธะฝัะตัะฟะพะปััะธั ั ะฟะพะผะพััั norm_rating ** 2. ะญัะพ ััะธะปะธะฒะฐะตั ะบะพะฝััะฐัั ะฒ ัะฐะนะพะฝะต ะฑะพะปะตะต ะฒััะพะบะธั ะทะฝะฐัะตะฝะธะน (3-5).

ะฆะฒะตัะพะฒะฐั ะณัะฐะดะฐัะธั: ะั ัะตะฟะตัั ัะพะทะดะฐัะผ ะฑะพะปะตะต ะฒััะฐะถะตะฝะฝัั ัะฐะทะฝะธัั ะผะตะถะดั ะบัะฐัะฝัะผ ะธ ะทะตะปัะฝัะผ ัะฒะตัะพะผ. ะญัะพ ะพัะพะฑะตะฝะฝะพ ะฟะพะผะพะณะฐะตั ัะดะตะปะฐัั ัะฐะทะฝะธัั ะผะตะถะดั ะทะฝะฐัะตะฝะธัะผะธ 3 ะธ 5 ะฑะพะปะตะต ะทะฐะผะตัะฝะพะน.

ะัะฐะดะธะตะฝั: ะัะธ ััะพะผ ะดะปั ะพัะตะฝะพะบ ะฑะปะธะถะต ะบ 5 ัะฐะทะฝะธัะฐ ััะฐะฝะพะฒะธััั ะณะพัะฐะทะดะพ ะฑะพะปะตะต ััะบะพ ะฒััะฐะถะตะฝะฝะพะน, ะฒ ะพัะปะธัะธะต ะพั ััะฐะฝะดะฐััะฝะพะน ะปะธะฝะตะนะฝะพะน ะธะฝัะตัะฟะพะปััะธะธ.

2. ะะฐะปัะฝะตะนัะฐั ะฝะฐัััะพะนะบะฐ:
ะัะปะธ ะฒั ัะพัะธัะต ะตัั ะฑะพะปััะต ััะธะปะธัั ะบะพะฝััะฐัั ะผะตะถะดั ะพัะตะฝะบะฐะผะธ 3 ะธ 5, ะผะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ัะบัะฟะพะฝะตะฝัะธะฐะปัะฝัั ะธะฝัะตัะฟะพะปััะธั, ะฝะฐะฟัะธะผะตั:

python
ะะพะฟะธัะพะฒะฐัั
norm_rating = (rating - 1) / 4
norm_rating = np.exp(norm_rating) / np.exp(1)  # ะญะบัะฟะพะฝะตะฝัะธะฐะปัะฝะฐั ะธะฝัะตัะฟะพะปััะธั
ะญัะพ ะผะพะถะตั ัะพะทะดะฐัั ะตัั ะฑะพะปะตะต ะฒััะฐะถะตะฝะฝัะต ัะฐะทะปะธัะธั ะผะตะถะดั ะทะฝะฐัะตะฝะธัะผะธ.

ะะฐะบะปััะตะฝะธะต:
ะก ะฟะพะผะพััั ััะธั ะธะทะผะตะฝะตะฝะธะน, ัะตะฟะตัั ะฒะฐัะฐ ะบะฐััะฐ ะฑัะดะตั ะพัะพะฑัะฐะถะฐัั ะฑะพะปะตะต ัััะบะพะต ัะฐะทะปะธัะธะต ะผะตะถะดั ะพัะตะฝะบะฐะผะธ, ะพัะพะฑะตะฝะฝะพ ะฒ ะดะธะฐะฟะฐะทะพะฝะต ะพั 3 ะดะพ 5, ะฟัะธ ััะพะผ ัะปัััะฐั ะฒะพัะฟัะธััะธะต ะดะปั ะฟะพะปัะทะพะฒะฐัะตะปะตะน, ะฐะฝะฐะปะธะทะธััััะธั ะดะฐะฝะฝัะต ะฝะฐ ะบะฐััะต.






ะั ัะบะฐะทะฐะปะธ:

ะัั ะบะฐััะฐ ั ัะตัะฝัะผะธ ัะพัะบะฐะผะธ. ะ ัะตะผ ะฟัะพะฑะปะตะผะฐ ? 

ะะฐัััะถะดะฐะปะฐ ะดะปั ะฟะฐัะฐ ัะตะบัะฝะด
ะะตัััั ะทะฐ ะฟัะพะฑะปะตะผั

ะะฐะดะฐัะฐ ะฟะพะปัะทะพะฒะฐัะตะปั: ะฟะพะฝััั, ััะพ ะฝะฐัะธัะพะฒะฐะฝะพ ะฝะฐ ะบะฐััะต. ะะพะทะผะพะถะฝะพ, ัะตััะพะฒัะบะธ ะธะฝัะตัะตัะฝะพ, ะธะฝัะตัะตัะฝะพ ะธะปะธ ะฟะพะปะตะทะฝะพ. ะงะตัะตะท ะฝะตัะบะพะปัะบะพ ัะฐะณะพะฒ ะฒัะนะดั ะฝะฐ ะฒะตัะฝะพะต ัะตัะตะฝะธะต.

ะัั ะบะพัะตะฝั ะฟัะพะฑะปะตะผั

ะัะผะฐั ะพ ัะตัะฝัั ัะพัะบะฐั ะฝะฐ ะบะฐััะต, ะฐะฝะฐะปะธะทะธััั ะธั ะฒะปะธัะฝะธะต ะฝะฐ ะบะฐัะตััะฒะพ ะธ ะธัะฟะพะปัะทัะตะผะพะต ะพะฑะพััะดะพะฒะฐะฝะธะต. ะญัะพ ะฟะพะดะฝะธะผะฐะตั ะฒะพะฟัะพัั ะพ ะฟะปะพัะฝะพััะธ ะธ ัะพัะฝะพััะธ ัะตัะตัะตะฝั-ะฐะนะบะพะฝะพะบ.

ะัั ัะตัะตะฝะธะต

ะะพะถะตะปะฐะฝะธะต ะฟะพะปัะทะพะฒะฐัะตะปั ะธะทััะธัั ะบะฐััั ั ัะตัะฝัะผะธ ัะพัะบะฐะผะธ. ะะฝะฐะปะธะทะธััั ะฟัะพะฑะปะตะผั, ะฟัะตะดะปะฐะณะฐั ัะปัััะตะฝะธั ะดะปั ัะปัััะตะฝะธั ะฒะธะทัะฐะปะธะทะธัะพะฒะฐะฝะฝะพะณะพ ะพะฟััะฐ.

ะัะพะฑะปะตะผะฐ, ะฒะตัะพััะฝะพ, ะทะฐะบะปััะฐะตััั ะฒ ัะพะผ, ััะพ ะฒะฐัะธ ัะฒะตัะฐ ะดะปั ะผะฐัะบะตัะพะฒ ะฝะต ะพัะพะฑัะฐะถะฐัััั ะบะพััะตะบัะฝะพ, ะธ ะฒะผะตััะพ ะพะถะธะดะฐะตะผัั ะณัะฐะดะฐัะธะน (ะบัะฐัะฝะพะณะพ, ะถัะปัะพะณะพ, ะทะตะปัะฝะพะณะพ) ะฒัะต ะผะฐัะบะตัั ะพัะพะฑัะฐะถะฐัััั ัััะฝัะผะธ.

ะกะบะพัะตะต ะฒัะตะณะพ, ััะพ ัะฒัะทะฐะฝะพ ั ัะตะผ, ััะพ ััะฝะบัะธั rating_to_rgb ะฒะพะทะฒัะฐัะฐะตั ะทะฝะฐัะตะฝะธั RGB, ะฝะพ ะฒ folium ะทะฝะฐัะตะฝะธั ัะฒะตัะพะฒ ะดะพะปะถะฝั ะฑััั ะฒ ะฒะธะดะต ัััะพะบ ะฒ ัะพัะผะฐัะต #RRGGBB ะธะปะธ ะถะต ะฒ ะฒะธะดะต ะบะพััะตะถะฐ ั ะฝะพัะผะธัะพะฒะฐะฝะฝัะผะธ ะทะฝะฐัะตะฝะธัะผะธ ะพั 0 ะดะพ 1 (ะดะปั ะบะฐะถะดะพะณะพ ะบะพะผะฟะพะฝะตะฝัะฐ). ะะฐั ัะตะบััะธะน ะฟะพะดัะพะด ั ะฟะตัะตะดะฐัะตะน ัะตะปัั ัะธัะตะป ะดะปั ะบะพะผะฟะพะฝะตะฝัะพะฒ RGB ะผะพะถะตั ะฑััั ะฟัะธัะธะฝะพะน ะฟัะพะฑะปะตะผั.

ะะฐะบ ะธัะฟัะฐะฒะธัั:
ะัะตะพะฑัะฐะทะพะฒะฐัั ะทะฝะฐัะตะฝะธั RGB ะฒ ัะพัะผะฐั, ะบะพัะพััะน ะฟัะธะฝะธะผะฐะตั folium.
ะฃะฑะตะดะธัะตัั, ััะพ ะฒะฐัะธ ะทะฝะฐัะตะฝะธั ะฝะพัะผะฐะปะธะทะพะฒะฐะฝั (ะพั 0 ะดะพ 1), ะตัะปะธ ะฟะตัะตะดะฐะตัะต ะธั ะบะฐะบ ะบะพััะตะถ.
ะัะฟัะฐะฒะปะตะฝะฝัะน ะบะพะด ะดะปั rating_to_rgb:
python
ะะพะฟะธัะพะฒะฐัั
import folium
import numpy as np

# ะคัะฝะบัะธั ะดะปั ะบะพะฝะฒะตััะฐัะธะธ ัะตะนัะธะฝะณะฐ ะฒ RGB
def rating_to_rgb(rating):
    """
    ะัะตะพะฑัะฐะทัะตั ะพัะตะฝะบั ะพั 1 ะดะพ 5 ะฒ RGB ัะฒะตั ั ัะปัััะตะฝะฝะพะน ะณัะฐะดะฐัะธะตะน ะดะปั ะทะฝะฐัะตะฝะธะน ะพั 3 ะดะพ 5.
    1 -> ะัะฐัะฝัะน (rgb(255, 0, 0))
    5 -> ะะตะปัะฝัะน (rgb(0, 255, 0))
    ะัะตะฝะบะธ ะผะตะถะดั ะฝะธะผะธ ะฟะปะฐะฒะฝะพ ะธะฝัะตัะฟะพะปะธัััั ั ัะฒะตะปะธัะตะฝะฝัะผ ะบะพะฝััะฐััะพะผ ะพั 3 ะดะพ 5.
    """
    # ะัะพะฒะตััะตะผ, ััะพะฑั ะพัะตะฝะบะฐ ะฑัะปะฐ ะฒ ะฟัะตะดะตะปะฐั ะพั 1 ะดะพ 5
    rating = np.clip(rating, 1, 5)

    # ะัะธะผะตะฝัะตะผ ะบะฒะฐะดัะฐัะธัะฝัั ะธะฝัะตัะฟะพะปััะธั ะดะปั ัะฒะตะปะธัะตะฝะธั ะบะพะฝััะฐััะฐ ะผะตะถะดั 3 ะธ 5
    norm_rating = (rating - 1) / 4  # ะะพัะผะฐะปะธะทัะตะผ ะทะฝะฐัะตะฝะธะต ะพั 0 ะดะพ 1
    norm_rating = norm_rating ** 2  # ะัะธะผะตะฝัะตะผ ะบะฒะฐะดัะฐัะธัะฝัั ััะฝะบัะธั ะดะปั ัะฒะตะปะธัะตะฝะธั ะบะพะฝััะฐััะฐ

    # ะะฝัะตัะฟะพะปะธััะตะผ ะผะตะถะดั ะบัะฐัะฝัะผ (255, 0, 0) ะธ ะทะตะปัะฝัะผ (0, 255, 0)
    red = int((1 - norm_rating) * 255)  # ะัะฐัะฝัะน ะบะพะผะฟะพะฝะตะฝั
    green = int(norm_rating * 255)  # ะะตะปัะฝัะน ะบะพะผะฟะพะฝะตะฝั
    blue = 0  # ะกะธะฝะธะน ะบะพะผะฟะพะฝะตะฝั ะฒัะตะณะดะฐ 0

    # ะะพะทะฒัะฐัะฐะตะผ ะทะฝะฐัะตะฝะธะต ะบะฐะบ ัััะพะบั ะฒ ัะพัะผะฐัะต #RRGGBB ะดะปั folium
    return f"#{red:02x}{green:02x}{blue:02x}"

# ะัะธะผะตั ะบะฐััั
m = folium.Map(location=[top_city_businesses['latitude'].mean(), top_city_businesses['longitude'].mean()],
               zoom_start=10)

# ะัะฟะพะปัะทัะตะผ ะธัะฟัะฐะฒะปะตะฝะฝัั ััะฝะบัะธั ะดะปั ะดะพะฑะฐะฒะปะตะฝะธั ะผะฐัะบะตัะพะฒ
for idx, row in best_city_reviews_expanded.iterrows():
    if idx % 5 == 0:
        folium.CircleMarker(
            location=[row['latitude'], row['longitude']],
            radius=4,
            color=rating_to_rgb(row['avg_rating']),  # ะขะตะฟะตัั ะฒะพะทะฒัะฐัะฐะตััั ัััะพะบะฐ ั ัะฒะตัะพะผ
            fill=True,
            fill_opacity=0.3
        ).add_to(m)

# ะกะพััะฐะฝะตะฝะธะต ะบะฐััั
m.save('my_map3.html')
m
ะะฑัััะฝะตะฝะธะต:
ะั ะธะทะผะตะฝะธะปะธ ััะฝะบัะธั rating_to_rgb, ััะพะฑั ะพะฝะฐ ะฒะพะทะฒัะฐัะฐะปะฐ ัะฒะตั ะฒ ะฒะธะดะต ัััะพะบะธ #RRGGBB, ะบะฐะบ ััะพ ะพะถะธะดะฐะตั folium.
ะัะฟะพะปัะทัะตะผ ะบะฒะฐะดัะฐัะธัะฝัั ะธะฝัะตัะฟะพะปััะธั ะดะปั ัะปัััะตะฝะธั ะบะพะฝััะฐััะฐ ะผะตะถะดั ะทะฝะฐัะตะฝะธัะผะธ (ะพัะพะฑะตะฝะฝะพ ะดะปั ะพัะตะฝะบะธ ะพั 3 ะดะพ 5).
ะขะตะฟะตัั, ะบะพะณะดะฐ ะฒั ะฟะพัััะพะธัะต ะบะฐััั ั ััะธะผ ะบะพะดะพะผ, ะผะฐัะบะตัั ะดะพะปะถะฝั ะฑััั ะฟัะฐะฒะธะปัะฝะพ ะพะบัะฐัะตะฝั ะฒ ะทะฐะฒะธัะธะผะพััะธ ะพั ะพัะตะฝะบะธ, ะฐ ะฝะต ะฒัะต ัะตัะฝัะต.






ะั ัะบะฐะทะฐะปะธ:

ะกะปะธัะบะพะผ ะบะพะฝััะฐััะฝะพ. ะะฐะดะพ ัะดะตะปะฐัั ะณัะฐะดะธะตะฝั ะบัะฐัะธะฒะตะต. ะะพะทะผะพะถะฝะพ, ััะพ ะฝะต ะฑัะดะตั ะปะธะฝะตะนะฝะพะน ะทะฐะฒะธัะธะผะพัััั. ะะพะดัะผะฐะน ัะพัะพัะพ. ะะพะถะตัั ะฟะพะธัะบะฐัั ะฒ ะธะฝัะตัะตะฝะตัะต

ะะฐัััะถะดะฐะปะฐ ะดะปั 5 ัะตะบัะฝะด
ะัะตะดะปะฐะณะฐั ะธะทะผะตะฝะตะฝะธั

ะะบะตะน, ะดะฐะฒะฐะนัะต ะฒะทะณะปัะฝะตะผ ะฝะฐ ัะปัััะตะฝะธะต ะณัะฐะดะธะตะฝัะฐ, ัะดะตะปะฐะฒ ะตะณะพ ะผะตะฝะตะต ะบะพะฝััะฐััะฝัะผ ะธ ะฑะพะปะตะต ะธะทััะฝัะผ. ะัะฑัะต ะธะดะตะธ, ะบะฐะบ ััะพ ะปัััะต ัะดะตะปะฐัั?

ะัะตะดะปะฐะณะฐั ัะปัััะตะฝะธะต

ะะบะตะน, ะดะฐะฒะฐะนัะต ัะดะตะปะฐะตะผ ะณัะฐะดะธะตะฝั ะผะตะฝะตะต ััะบะธะผ ะธ ะฑะพะปะตะต ะณะปะฐะดะบะธะผ, ะธะทะฑะตะณะฐั ะปะธะฝะตะนะฝะพะน ะทะฐะฒะธัะธะผะพััะธ, ััะพะฑั ัะพะทะดะฐัั ะฑะพะปะตะต ะบัะฐัะธะฒัะน ะธ ะฟัะธะณะปััะตะฝะฝัะน ัััะตะบั.

ะัะตะดะปะฐะณะฐั ัะปัััะตะฝะธะต

ะะบะตะน, ะดะฐะฒะฐะนัะต ัะดะตะปะฐะตะผ ะณัะฐะดะธะตะฝั ะผะตะฝะตะต ะบะพะฝััะฐััะฝัะผ ะธ ะฑะพะปััะต ะฟะปะฐะฒะฝัะผ, ะธะทะฑะตะณะฐั ะปะธะฝะตะนะฝะพะน ะทะฐะฒะธัะธะผะพััะธ, ััะพะฑั ัะพะทะดะฐัั ะฑะพะปะตะต ะบัะฐัะธะฒัะน ะธ ะณะฐัะผะพะฝะธัะฝัะน ัััะตะบั.

ะัะตะดะปะฐะณะฐั ะพะฟัะธะผะธะทะฐัะธั

ะะทะฒะธะฝะธัะต, ะฝะพ ะฒะฐั ะทะฐะฟัะพั, ะฟะพ ะฒัะตะน ะฒะธะดะธะผะพััะธ, ะฟะพะฒัะพััะตััั ะฝะตัะบะพะปัะบะพ ัะฐะท, ััะพ ะทะฐัััะดะฝัะตั ะฟะพะฝะธะผะฐะฝะธะต. ะะพะฟัะพะฑัะนัะต ะฟะตัะตัะพัะผัะปะธัะพะฒะฐัั ะธะปะธ ััะพัะฝะธัั ะฒะฐั ะทะฐะฟัะพั ะดะปั ะฑะพะปะตะต ัะพัะฝะพะณะพ ะพัะฒะตัะฐ.

ะัะตะดะปะฐะณะฐั ะพะฟัะธะผะธะทะฐัะธั

ะัะตะดะปะฐะณะฐั ัะดะตะปะฐัั ะณัะฐะดะธะตะฝั ะผะตะฝะตะต ะบะพะฝััะฐััะฝัะผ ะธ ะฑะพะปะตะต ะฟะปะฐะฒะฝัะผ, ะธะทะฑะตะณะฐั ะปะธะฝะตะนะฝะพะน ะทะฐะฒะธัะธะผะพััะธ, ััะพะฑั ัะพะทะดะฐัั ะฑะพะปะตะต ะบัะฐัะธะฒัะน ะธ ะณะฐัะผะพะฝะธัะฝัะน ัััะตะบั. ะญัะพ ะฟะพะผะพะถะตั ัะฑะฐะปะฐะฝัะธัะพะฒะฐัั ะฒะธะทัะฐะปัะฝัะต ัะปะตะผะตะฝัั ะดะธะทะฐะนะฝะฐ.

ะัะตะดะปะฐะณะฐั ัะดะตะปะฐัั ะณัะฐะดะธะตะฝั ะผะตะฝะตะต ะบะพะฝััะฐััะฝัะผ ะธ ะฑะพะปะตะต ะฟะปะฐะฒะฝัะผ, ะธะทะฑะตะณะฐั ะปะธะฝะตะนะฝะพะน ะทะฐะฒะธัะธะผะพััะธ, ััะพะฑั ัะพะทะดะฐัั ะบัะฐัะธะฒัะน ะธ ะณะฐัะผะพะฝะธัะฝัะน ัััะตะบั.

ะะปั ัะปัััะตะฝะธั ะฒะธะทัะฐะปะธะทะฐัะธะธ ัะฒะตัะฐ ะฝะฐ ะบะฐััะต, ั ัะตะบะพะผะตะฝะดัั ะธัะฟะพะปัะทะพะฒะฐัั ะฝะต ะปะธะฝะตะนะฝัั ะธะฝัะตัะฟะพะปััะธั, ะฐ, ะฝะฐะฟัะธะผะตั, ะปะพะณะฐัะธัะผะธัะตัะบัั ะธะปะธ ะบะพัะธะฝััะฝัั ะทะฐะฒะธัะธะผะพััั, ััะพะฑั ัะปัััะธัั ะฟะปะฐะฒะฝะพััั ะณัะฐะดะธะตะฝัะฐ. ะญัะพ ะฟะพะผะพะถะตั ัะผะตะฝััะธัั ะบะพะฝััะฐัั ะผะตะถะดั ะฝะธะทะบะธะผะธ ะพัะตะฝะบะฐะผะธ, ะบะพัะพััะต ะฝะต ัะฐะบ ะธะฝัะตัะตัะฝั ะดะปั ะฐะฝะฐะปะธะทะฐ, ะธ ะฒััะพะบะธะผ ะดะธะฐะฟะฐะทะพะฝะพะผ ะพัะตะฝะพะบ, ะณะดะต ะฒะฐะถะฝะพ ะฑะพะปะตะต ัััะบะพ ัะฐะทะปะธัะฐัั ะทะฝะฐัะตะฝะธั.

ะะปั ัะปัััะตะฝะฝะพะน ะฒะธะทัะฐะปะธะทะฐัะธะธ ะผะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ัะฒะตัะพะฒัั ะฟะฐะปะธััั, ะบะพัะพัะฐั ะฑัะดะตั ะฟะปะฐะฒะฝะพ ะธะทะผะตะฝััััั ะธ ะปัััะต ัะฐะทะปะธัะฐัั ััะตะดะฝะธะต ะทะฝะฐัะตะฝะธั. ะฏ ะฟัะตะดะปะพะถั ัะตัะตะฝะธะต ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ะปะพะณะฐัะธัะผะธัะตัะบะพะน ัะบะฐะปั ะดะปั ะธะทะผะตะฝะตะฝะธั ัะฒะตัะฐ.

ะะฐะบ ััะพ ัะดะตะปะฐัั?
ะั ะฑัะดะตะผ ะธัะฟะพะปัะทะพะฒะฐัั ะปะพะณะฐัะธัะผะธัะตัะบัั ัะบะฐะปั ะดะปั ะฑะพะปะตะต ะฟะปะฐะฒะฝะพะณะพ ะฟะตัะตัะพะดะฐ ะผะตะถะดั ัะฒะตัะฐะผะธ, ะฐ ัะฐะบะถะต ะฟัะธะผะตะฝะธะผ ะบัะฐัะธะฒัั ัะฒะตัะพะฒัั ะฟะฐะปะธััั, ัะฐะบัั ะบะฐะบ coolwarm ะธะปะธ RdYlGn, ะบะพัะพัะฐั ะฑัะดะตั ัะดะพะฑะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ะดะปั ัะฐะบะธั ะทะฐะดะฐั.

ะะพั ะฟัะธะผะตั ะบะพะดะฐ, ะบะพัะพััะน ะดะพะปะถะตะฝ ัะปัััะธัั ะณัะฐะดะฐัะธั:

python
ะะพะฟะธัะพะฒะฐัั
import folium
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.colors import Normalize
from matplotlib.cm import ScalarMappable

# ะคัะฝะบัะธั ะฟัะตะพะฑัะฐะทะพะฒะฐะฝะธั ัะตะนัะธะฝะณะฐ ะฒ RGB, ะธัะฟะพะปัะทัั ะปะพะณะฐัะธัะผะธัะตัะบัั ัะบะฐะปั ะดะปั ะฟะปะฐะฒะฝะพะน ะณัะฐะดะฐัะธะธ
def rating_to_rgb(rating):
    """
    ะัะตะพะฑัะฐะทัะตั ะพัะตะฝะบั ะพั 1 ะดะพ 5 ะฒ RGB ัะฒะตั ั ัะปัััะตะฝะฝะพะน ะณัะฐะดะฐัะธะตะน ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ะปะพะณะฐัะธัะผะธัะตัะบะพะน ัะบะฐะปั.
    1 -> ะัะฐัะฝัะน (rgb(255, 0, 0))
    5 -> ะะตะปัะฝัะน (rgb(0, 255, 0))
    """
    # ะะพัะผะฐะปะธะทัะตะผ ะทะฝะฐัะตะฝะธะต ะพัะตะฝะบะธ ะพั 1 ะดะพ 5 ะฒ ะปะพะณะฐัะธัะผะธัะตัะบัั ัะบะฐะปั
    norm_rating = np.log(rating) / np.log(5)  # ะะพะณะฐัะธัะผะธัะตัะบะฐั ะฝะพัะผะฐะปะธะทะฐัะธั

    # ะัะธะผะตะฝัะตะผ ััะฐะฝะดะฐััะฝัั ะฟะฐะปะธััั
    cmap = plt.get_cmap('RdYlGn')  # ะะฐะปะธััะฐ ะพั ะบัะฐัะฝะพะณะพ ะดะพ ะทะตะปัะฝะพะณะพ
    norm = Normalize(vmin=0, vmax=1)
    sm = ScalarMappable(cmap=cmap, norm=norm)

    # ะะพะปััะฐะตะผ ัะฒะตั ะฒ ัะพัะผะฐัะต RGB
    rgba = sm.to_rgba(norm_rating)  # ะัะตะพะฑัะฐะทัะตะผ ะฒ RGBA
    return f'#{int(rgba[0]*255):02x}{int(rgba[1]*255):02x}{int(rgba[2]*255):02x}'  # ะัะตะพะฑัะฐะทัะตะผ ะฒ #RRGGBB

# ะกะพะทะดะฐัะผ ะบะฐััั
m = folium.Map(location=[top_city_businesses['latitude'].mean(), top_city_businesses['longitude'].mean()],
               zoom_start=10)

# ะัะฟะพะปัะทัะตะผ ะธัะฟัะฐะฒะปะตะฝะฝัั ััะฝะบัะธั ะดะปั ะดะพะฑะฐะฒะปะตะฝะธั ะผะฐัะบะตัะพะฒ ั ัะปัััะตะฝะฝะพะน ะณัะฐะดะฐัะธะตะน
for idx, row in best_city_reviews_expanded.iterrows():
    if idx % 5 == 0:
        folium.CircleMarker(
            location=[row['latitude'], row['longitude']],
            radius=4,
            color=rating_to_rgb(row['avg_rating']),  # ะขะตะฟะตัั ะธัะฟะพะปัะทัะตััั ัะปัััะตะฝะฝะฐั ะณัะฐะดะฐัะธั
            fill=True,
            fill_opacity=0.6
        ).add_to(m)

# ะกะพััะฐะฝะตะฝะธะต ะบะฐััั
m.save('my_map3_enhanced.html')
m
ะะพััะฝะตะฝะธะต:
ะะพะณะฐัะธัะผะธัะตัะบะฐั ะฝะพัะผะฐะปะธะทะฐัะธั:

ะั ะธัะฟะพะปัะทัะตะผ ะปะพะณะฐัะธัะผ ะดะปั ะฝะพัะผะฐะปะธะทะฐัะธะธ ะทะฝะฐัะตะฝะธะน ัะตะนัะธะฝะณะฐ. ะญัะพ ะฟะพะผะพะณะฐะตั ัะฝะธะทะธัั ะบะพะฝััะฐัั ะผะตะถะดั ะฝะธะทะบะธะผะธ ะพัะตะฝะบะฐะผะธ ะธ ััััะต ะพัะพะฑัะฐะถะฐัั ะฒััะพะบะธะต (ะฝะฐะฟัะธะผะตั, ะผะตะถะดั 3 ะธ 5).
ะคะพัะผัะปะฐ np.log(rating) / np.log(5) ะฟะพะทะฒะพะปัะตั ะฒัะฟะพะปะฝะธัั ะฝะพัะผะฐะปะธะทะฐัะธั, ะฟัะธ ััะพะผ ะทะฝะฐัะตะฝะธั ะธะท ะดะธะฐะฟะฐะทะพะฝะฐ 1-5 ะฑัะดัั ะฟัะตะพะฑัะฐะทะพะฒะฐะฝั ะฒ ัะบะฐะปั ะพั 0 ะดะพ 1.
ะฆะฒะตัะพะฒะฐั ะฟะฐะปะธััะฐ:

ะัะฟะพะปัะทัะตััั ะฟะฐะปะธััะฐ RdYlGn, ะบะพัะพัะฐั ะฟะตัะตัะพะดะธั ะพั ะบัะฐัะฝะพะณะพ (ะดะปั ะฝะธะทะบะธั ะพัะตะฝะพะบ) ะบ ะทะตะปัะฝะพะผั (ะดะปั ะฒััะพะบะธั).
ะั ะฟัะธะผะตะฝัะตะผ ะตั ัะตัะตะท ScalarMappable, ะบะพัะพััะน ะฟัะตะพะฑัะฐะทัะตั ะฝะพัะผะฐะปะธะทะพะฒะฐะฝะฝะพะต ะทะฝะฐัะตะฝะธะต ะฒ RGB-ัะฒะตั.
ะะฐัััะพะนะบะฐ ะผะฐัะบะตัะพะฒ:

ะั ะดะพะฑะฐะฒะปัะตะผ ะผะฐัะบะตัั ะฝะฐ ะบะฐััั, ะธัะฟะพะปัะทัั ัะฐัััะธัะฐะฝะฝัะน ัะฒะตั, ะบะพัะพััะน ะฑัะดะตั ะฑะพะปะตะต ะฟะปะฐะฒะฝะพ ะพัะพะฑัะฐะถะฐัั ัะตะนัะธะฝะณะธ.
ะะตะทัะปััะฐั:
ะขะตะฟะตัั ะผะฐัะบะตัั ะฝะฐ ะบะฐััะต ะฑัะดัั ะพัะพะฑัะฐะถะฐัััั ั ะฟะปะฐะฒะฝะพะน ะณัะฐะดะฐัะธะตะน ัะฒะตัะพะฒ, ะธ ัะฐะทะฝะธัะฐ ะผะตะถะดั ะทะฝะฐัะตะฝะธัะผะธ, ะพัะพะฑะตะฝะฝะพ ะผะตะถะดั 3 ะธ 5, ะฑัะดะตั ะทะฐะผะตัะฝะตะต ะธ ะผะตะฝะตะต ะบะพะฝััะฐััะฝะพะน.






ะั ัะบะฐะทะฐะปะธ:
ะะฐะบ ะธะทะผะตะฝััั ะทะฝะฐัะตะฝะธั ะฒ ะบะฐะถะดะพะน ะบะปะตัะบะต ะบะฐะบะพะณะพ-ัะพ ััะพะปะฑัะฐ. ะะฐะฟัะธะผะตั, ั ะบ ะบะฐะถะดะพะน ะบะปะตัะบะต ััะพะปะฑัะฐ avg_rating ัะพัั ะดะพะฑะฐะฒะธัั 1

ะะฐัััะถะดะฐะปะฐ ะดะปั ะฝะตัะบะพะปัะบะพ ัะตะบัะฝะด
ะะทะผะตะฝะตะฝะธะต ะทะฝะฐัะตะฝะธะน ะฒ ะบะฐะถะดะพะน ะบะปะตัะบะต ััะพะปะฑัะฐ avg_rat?

ะะทะผะตะฝะตะฝะธะต ะทะฝะฐัะตะฝะธะน ะฒ ะบะฐะถะดะพะน ะบะปะตัะบะต ััะพะปะฑัะฐ avg_rat.

ะะทะผะตะฝะตะฝะธะต ะทะฝะฐัะตะฝะธะน ะฒ ะบะฐะถะดะพะน ะบะปะตัะบะต ััะพะปะฑัะฐ avg_rat?

ะะทะผะตะฝะตะฝะธะต ะทะฝะฐัะตะฝะธะน ะฒ ะบะฐะถะดะพะน ะบะปะตัะบะต ััะพะปะฑัะฐ avg_rat.

ะงัะพะฑั ะธะทะผะตะฝะธัั ะทะฝะฐัะตะฝะธั ะฒ ััะพะปะฑัะต ะธ ะดะพะฑะฐะฒะธัั ัะธัะปะพ ะบ ะบะฐะถะดะพะผั ัะปะตะผะตะฝัั, ะผะพะถะฝะพ ะฒะพัะฟะพะปัะทะพะฒะฐัััั ะฟัะพัััะผะธ ะพะฟะตัะฐัะธัะผะธ ั pandas. ะ ะฒะฐัะตะผ ัะปััะฐะต, ััะพะฑั ะดะพะฑะฐะฒะธัั 1 ะบ ะบะฐะถะดะพะผั ะทะฝะฐัะตะฝะธั ะฒ ััะพะปะฑัะต avg_rating, ะธัะฟะพะปัะทัะนัะต ัะปะตะดัััะธะน ะบะพะด:

ะัะธะผะตั:
python
ะะพะฟะธัะพะฒะฐัั
# ะะพะฑะฐะฒะปัะตะผ 1 ะบะพ ะฒัะตะผ ะทะฝะฐัะตะฝะธัะผ ะฒ ััะพะปะฑัะต 'avg_rating'
best_city_reviews_expanded['avg_rating'] = best_city_reviews_expanded['avg_rating'] + 1

# ะัะพะฒะตััะตะผ ัะตะทัะปััะฐั
print(best_city_reviews_expanded[['avg_rating']].head())
ะะพััะฝะตะฝะธะต:
ะ ััะพะผ ะฟัะธะผะตัะต ะผั ะฝะฐะฟััะผัั ะธะทะผะตะฝัะตะผ ะทะฝะฐัะตะฝะธั ะฒ ััะพะปะฑัะต avg_rating. ะั ะดะพะฑะฐะฒะปัะตะผ 1 ะบะพ ะฒัะตะผ ัะปะตะผะตะฝัะฐะผ ััะพะปะฑัะฐ ั ะฟะพะผะพััั ะฒััะฐะถะตะฝะธั best_city_reviews_expanded['avg_rating'] + 1.
ะญัะพ ัะฐะฑะพัะฐะตั ะฟะพัะพะผั, ััะพ pandas ะฟะพะดะดะตัะถะธะฒะฐะตั ะฒะตะบัะพัะฝัะต ะพะฟะตัะฐัะธะธ, ะธ ัะฐะบะฐั ะพะฟะตัะฐัะธั ะฑัะดะตั ะฒัะฟะพะปะฝะตะฝะฐ ะดะปั ะบะฐะถะดะพะณะพ ัะปะตะผะตะฝัะฐ ะฒ ััะพะปะฑัะต.
ะะปััะตัะฝะฐัะธะฒะฝัะน ัะฟะพัะพะฑ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ apply:
ะัะปะธ ะฒะฐะผ ะฝัะถะฝะพ ะฟัะธะผะตะฝะธัั ะฑะพะปะตะต ัะปะพะถะฝัั ััะฝะบัะธั ะดะปั ะธะทะผะตะฝะตะฝะธั ะทะฝะฐัะตะฝะธะน (ะฝะฐะฟัะธะผะตั, ะดะพะฑะฐะฒะปััั 1 ัะพะปัะบะพ ะบ ะทะฝะฐัะตะฝะธัะผ ะฑะพะปััะต 3), ะฒั ะผะพะถะตัะต ะธัะฟะพะปัะทะพะฒะฐัั ะผะตัะพะด apply:

python
ะะพะฟะธัะพะฒะฐัั
best_city_reviews_expanded['avg_rating'] = best_city_reviews_expanded['avg_rating'].apply(lambda x: x + 1)

# ะัะพะฒะตััะตะผ ัะตะทัะปััะฐั
print(best_city_reviews_expanded[['avg_rating']].head())
ะะดะตัั apply ะฟัะธะผะตะฝัะตั ััะฝะบัะธั ะบะพ ะฒัะตะผ ะทะฝะฐัะตะฝะธัะผ ะฒ ััะพะปะฑัะต, ะฐ lambda x: x + 1 ะดะพะฑะฐะฒะปัะตั 1 ะบ ะบะฐะถะดะพะผั ะทะฝะฐัะตะฝะธั.

ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะผะพะถะฝะพ ะปะตะณะบะพ ะธะทะผะตะฝััั ะทะฝะฐัะตะฝะธั ะฒ ะปัะฑะพะผ ััะพะปะฑัะต ะฒะฐัะตะณะพ DataFrame.






ะั ัะบะฐะทะฐะปะธ:
ะะฐะฟะธัะธ ะผะฝะต, ััะพ ะดะตะปะฐะตั pd.pivot_table 

ะะฐัััะถะดะฐะปะฐ ะดะปั ะฟะฐัะฐ ัะตะบัะฝะด
ะัั ะพะฟัะธะผะฐะปัะฝะพะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต

ะฏ ะฟะพััะฝัั ััะบะฝัะธั pd.pivot_table, ัะฐะทะฑะธัะฐัั ะตะต ะฒะพะทะผะพะถะฝะพััั ะฐะณัะตะณะธัะพะฒะฐัั ะดะฐะฝะฝัะต, ะณััะฟะฟะธัะพะฒะฐัั ะธั ะธ ะฒะทะฐะธะผะพะดะตะนััะฒะพะฒะฐัั ั ะฝะธะผะธ ะดะปั ะฐะฝะฐะปะธะทะฐ ััะฐัะธััะธัะตัะบะธั ะดะฐะฝะฝัั.

ะัะฟะพะปัะทัั pd.pivot_table

ะฏ ะธะทััะฐั pd.pivot_table, ะบะพัะพัะฐั ะฟะพะผะพะณะฐะตั ะพะฑัะตะดะธะฝะธัั ะดะฐะฝะฝัะต ะธะท ัะฐะทะฝัั ััะพะปะฑัะพะฒ, ััะพะฑั ะฝะฐะธะฑะพะปะตะต ัััะตะบัะธะฒะฝะพ ะธะพะถะธัั ััะฐัะธััะธัะตัะบะธะน ะฐะฝะฐะปะธะท.

ะะตัะพะด pd.pivot_table ะฒ pandas ะธัะฟะพะปัะทัะตััั ะดะปั ัะพะทะดะฐะฝะธั ัะฒะพะดะฝัั ัะฐะฑะปะธั (pivot tables), ะบะพัะพััะต ะฟะพะทะฒะพะปััั ะฐะณัะตะณะธัะพะฒะฐัั ะดะฐะฝะฝัะต ะฒ ะทะฐะฒะธัะธะผะพััะธ ะพั ะทะฝะฐัะตะฝะธะน ะฒ ะพะดะฝะพะผ ะธะปะธ ะฝะตัะบะพะปัะบะธั ััะพะปะฑัะฐั.

ะัะฝะพะฒะฝะฐั ัะตะปั pivot_table โ ััะพ ะฟัะตะพะฑัะฐะทะพะฒะฐะฝะธะต ะดะฐะฝะฝัั ะธะท ะดะปะธะฝะฝะพะณะพ ัะพัะผะฐัะฐ ะฒ ะฑะพะปะตะต ะบะพะผะฟะฐะบัะฝัะน ะธ ัะดะพะฑะฝัะน ะดะปั ะฐะฝะฐะปะธะทะฐ ะฒะธะด, ั ะฟัะธะผะตะฝะตะฝะธะตะผ ะฐะณัะตะณะธััััะธั ััะฝะบัะธะน ะดะปั ัะฐะทะปะธัะฝัั ะณััะฟะฟ.

ะัะฝะพะฒะฝะพะน ัะธะฝัะฐะบัะธั:
python
ะะพะฟะธัะพะฒะฐัั
pd.pivot_table(data, values=None, index=None, columns=None, aggfunc='mean', fill_value=None, margins=False, dropna=True)
ะะฐัะฐะผะตััั:
data: DataFrame, ะบะพัะพััะน ะฒั ัะพัะธัะต ะฟัะตะพะฑัะฐะทะพะฒะฐัั.
values: ะกัะพะปะฑะตั ะธะปะธ ัะฟะธัะพะบ ััะพะปะฑัะพะฒ, ะดะปั ะบะพัะพััั ะฝัะถะฝะพ ะฟัะธะผะตะฝะธัั ะฐะณัะตะณะธัััััั ััะฝะบัะธั. ะัะปะธ ะฝะต ัะบะฐะทะฐะฝะพ, ะฐะณัะตะณะธัััััั ะฒัะต ัะธัะปะพะฒัะต ััะพะปะฑัั.
index: ะกัะพะปะฑะตั ะธะปะธ ัะฟะธัะพะบ ััะพะปะฑัะพะฒ, ะฟะพ ะบะพัะพััะผ ะฝัะถะฝะพ ะณััะฟะฟะธัะพะฒะฐัั ัััะพะบะธ.
columns: ะกัะพะปะฑะตั ะธะปะธ ัะฟะธัะพะบ ััะพะปะฑัะพะฒ, ะฟะพ ะบะพัะพััะผ ะฝัะถะฝะพ ะณััะฟะฟะธัะพะฒะฐัั ััะพะปะฑัั.
aggfunc: ะะณัะตะณะธััััะฐั ััะฝะบัะธั (ะฟะพ ัะผะพะปัะฐะฝะธั mean). ะะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ะดััะณะธะต ััะฝะบัะธะธ, ะฝะฐะฟัะธะผะตั, sum, count, min, max, ะธะปะธ ะฟะตัะตะดะฐัั ัะฒะพั ะฟะพะปัะทะพะฒะฐัะตะปััะบัั ััะฝะบัะธั.
fill_value: ะะฝะฐัะตะฝะธะต, ะบะพัะพัะพะต ะฑัะดะตั ะธัะฟะพะปัะทะพะฒะฐัััั ะดะปั ะทะฐะฟะพะปะฝะตะฝะธั ะฟัะพะฟััะตะฝะฝัั ะดะฐะฝะฝัั.
margins: ะัะปะธ True, ะดะพะฑะฐะฒะธั ะดะพะฟะพะปะฝะธัะตะปัะฝัะต ัััะพะบะธ ะธ ััะพะปะฑัั ะดะปั ะธัะพะณะพะฒัั ััะผะผ (ะฐะฝะฐะปะพะณะธัะฝัะต ัััะพะบะฐะผ "Total").
dropna: ะัะปะธ True (ะฟะพ ัะผะพะปัะฐะฝะธั), ัะพ ัััะพะบะธ ั NaN ะทะฝะฐัะตะฝะธัะผะธ ะฑัะดัั ะธะณะฝะพัะธัะพะฒะฐัััั.
ะัะธะผะตั 1: ะัะพััะฐั ัะฒะพะดะฝะฐั ัะฐะฑะปะธัะฐ
ะัะตะดะฟะพะปะพะถะธะผ, ั ะฝะฐั ะตััั DataFrame ั ะพัะตะฝะบะฐะผะธ ะบะพะผะฟะฐะฝะธะน ะธ ะณะพัะพะดะฐะผะธ:

python
ะะพะฟะธัะพะฒะฐัั
import pandas as pd

data = {
    'city': ['New York', 'New York', 'Los Angeles', 'Los Angeles', 'Chicago', 'Chicago'],
    'business': ['A', 'B', 'A', 'B', 'A', 'B'],
    'rating': [5, 4, 3, 4, 2, 3]
}

df = pd.DataFrame(data)

# ะกะพะทะดะฐะตะผ ัะฒะพะดะฝัั ัะฐะฑะปะธัั, ะณะดะต ะฐะณัะตะณะธััะตะผ ะพัะตะฝะบะธ ะฟะพ ะณะพัะพะดะฐะผ ะธ ะบะพะผะฟะฐะฝะธัะผ
pivot = pd.pivot_table(df, values='rating', index='city', columns='business', aggfunc='mean')
print(pivot)
ะะตะทัะปััะฐั:
css
ะะพะฟะธัะพะฒะฐัั
business         A    B
city                   
Chicago         2.0  3.0
Los Angeles     3.0  4.0
New York        5.0  4.0
ะะพััะฝะตะฝะธะต:
ะั ัะพะทะดะฐะปะธ ัะฒะพะดะฝัั ัะฐะฑะปะธัั, ะณะดะต ัััะพะบะธ โ ััะพ ะณะพัะพะดะฐ, ะฐ ััะพะปะฑัั โ ััะพ ะบะพะผะฟะฐะฝะธะธ.
ะะปั ะบะฐะถะดะพะน ะบะพะผะฑะธะฝะฐัะธะธ ะณะพัะพะดะฐ ะธ ะบะพะผะฟะฐะฝะธะธ ะพัะพะฑัะฐะถะฐะตััั ััะตะดะฝัั ะพัะตะฝะบะฐ (aggfunc='mean').
ะ ะดะฐะฝะฝะพะผ ะฟัะธะผะตัะต aggfunc='mean' ะพะทะฝะฐัะฐะตั, ััะพ ะดะปั ะบะฐะถะดะพะน ะณััะฟะฟั ะผั ัะฐัััะธััะฒะฐะตะผ ััะตะดะฝะตะต ะทะฝะฐัะตะฝะธะต.
ะัะธะผะตั 2: ะะพะฑะฐะฒะปะตะฝะธะต ะธัะพะณะพะฒ
ะัะปะธ ะฒั ัะพัะธัะต ะดะพะฑะฐะฒะธัั ะธัะพะณะพะฒัะต ัััะพะบะธ ะธ ััะพะปะฑัั, ะผะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ะฟะฐัะฐะผะตัั margins=True:

python
ะะพะฟะธัะพะฒะฐัั
pivot_with_totals = pd.pivot_table(df, values='rating', index='city', columns='business', aggfunc='mean', margins=True)
print(pivot_with_totals)
ะะตะทัะปััะฐั:
css
ะะพะฟะธัะพะฒะฐัั
business            A    B  All
city                          
Chicago          2.0  3.0  2.5
Los Angeles      3.0  4.0  3.5
New York         5.0  4.0  4.5
All              3.333333  3.666667  3.5
ะะพะฑะฐะฒะปะตะฝะฐ ัััะพะบะฐ ะธ ััะพะปะฑะตั All, ะบะพัะพััะต ัะพะดะตัะถะฐั ะธัะพะณะธ ะฟะพ ะฒัะตะผ ะณะพัะพะดะฐะผ ะธ ะบะพะผะฟะฐะฝะธัะผ.
ะัะธะผะตั 3: ะะฐะฟะพะปะฝะตะฝะธะต ะฟัะพะฟััะตะฝะฝัั ะทะฝะฐัะตะฝะธะน
ะัะปะธ ะฒ ะดะฐะฝะฝัั ะตััั ะฟัะพะฟััะตะฝะฝัะต ะทะฝะฐัะตะฝะธั, ะฒั ะผะพะถะตัะต ะธัะฟะพะปัะทะพะฒะฐัั ะฟะฐัะฐะผะตัั fill_value ะดะปั ะธั ะทะฐะผะตะฝั:

python
ะะพะฟะธัะพะฒะฐัั
# ะัะธะผะตั ั ะฟัะพะฟััะตะฝะฝัะผะธ ะทะฝะฐัะตะฝะธัะผะธ
data_with_nan = {
    'city': ['New York', 'New York', 'Los Angeles', 'Los Angeles', 'Chicago', 'Chicago'],
    'business': ['A', 'B', 'A', 'B', 'A', 'B'],
    'rating': [5, None, 3, 4, 2, None]
}

df_with_nan = pd.DataFrame(data_with_nan)

# ะกะฒะพะดะฝะฐั ัะฐะฑะปะธัะฐ ั ะทะฐะฟะพะปะฝะตะฝะธะตะผ ะฟัะพะฟััะบะพะฒ ะทะฝะฐัะตะฝะธะตะผ 0
pivot_with_fill = pd.pivot_table(df_with_nan, values='rating', index='city', columns='business', aggfunc='mean', fill_value=0)
print(pivot_with_fill)
ะะตะทัะปััะฐั:
css
ะะพะฟะธัะพะฒะฐัั
business         A    B
city                   
Chicago         2.0  0.0
Los Angeles     3.0  4.0
New York        5.0  0.0
ะัะพะฟััะตะฝะฝัะต ะทะฝะฐัะตะฝะธั ะฒ ััะพะปะฑัะต rating ะดะปั ะบะพะผะฟะฐะฝะธะธ B ะฑัะปะธ ะทะฐะผะตะฝะตะฝั ะฝะฐ 0 ะฑะปะฐะณะพะดะฐัั ะฟะฐัะฐะผะตััั fill_value=0.
ะะฐะบะปััะตะฝะธะต:
pd.pivot_table โ ััะพ ะผะพัะฝัะน ะธะฝััััะผะตะฝั ะดะปั ะฐะณัะตะณะธัะพะฒะฐะฝะธั ะดะฐะฝะฝัั ะฒ pandas. ะก ะตะณะพ ะฟะพะผะพััั ะฒั ะผะพะถะตัะต:

ะััะฟะฟะธัะพะฒะฐัั ะดะฐะฝะฝัะต ะฟะพ ะพะดะฝะพะผั ะธะปะธ ะฝะตัะบะพะปัะบะธะผ ััะพะปะฑัะฐะผ.
ะัะธะผะตะฝััั ัะฐะทะปะธัะฝัะต ะฐะณัะตะณะธััััะธะต ััะฝะบัะธะธ.
ะะตะณะบะพ ะดะพะฑะฐะฒะปััั ะธัะพะณะพะฒัะต ัััะพะบะธ/ััะพะปะฑัั.
ะะฑัะฐะฑะฐััะฒะฐัั ะฟัะพะฟััะตะฝะฝัะต ะทะฝะฐัะตะฝะธั.
ะญัะพั ะผะตัะพะด ะฟะพะปะตะทะตะฝ ะดะปั ัะพะทะดะฐะฝะธั ัะฒะพะดะฝัั ัะฐะฑะปะธั, ะฐะฝะฐะปะธะทะฐ ะธ ะฒะธะทัะฐะปะธะทะฐัะธะธ ะดะฐะฝะฝัั ะฒ ะฒะธะดะต ะบะพะผะฟะฐะบัะฝัั ะธ ะฟะพะฝััะฝัั ัะฐะฑะปะธั.






ะั ัะบะฐะทะฐะปะธ:
ัะต ะฝะต ัะฐะบ 

pivot = pd.pivot_table(best_city_reviews_expanded, index=['latitude', 'longitude'], columns=['latitude', 'longitude'], aggfunc='mean', values='avg_rating')

ะะฐัััะถะดะฐะปะฐ ะดะปั ะฟะฐัะฐ ัะตะบัะฝะด
ะะพะฝะธะผะฐะฝะธะต ะทะฐะฟัะพัะฐ ะธ ะฝะฐัััะพะนะบะฐ ัะฐะฑะปะธัั ะฟัะพะดะฒะธะฝััะพะณะพ ะฐะฝะฐะปะธะทะฐ.

ะัะพะฒะตัะบะฐ ะดะฐะฝะฝัั
ะัะพะฒะตััั ะทะฐะฟัะพั ะฟะพะปัะทะพะฒะฐัะตะปั ะธ ะฝะฐัััะพะตะบ ัะฐะฑะปะธัั, ะฒะบะปััะฐั ะธะฝะดะตะบัั, ะบะพะปะพะฝะบะธ ะธ ะฝะฐะทะฒะฐะฝะธั. ะญัะพ ะฟะพะผะพะณะฐะตั ะปัััะต ัะฐะทะพะฑัะฐัััั ะฒ ะดะตัะฐะปัั ะธ ะฟะพะฝััั, ะบะฐะบ ะปัััะต ะฒัะตะณะพ ะพัะฒะตัะธัั.

ะะพะฝะธะผะฐะฝะธะต ะทะฐะฟัะพัะฐ ะธ ะฝะฐัััะพะนะบะฐ ะดะฐะฝะฝัั.

ะ ะฒะฐัะตะผ ะบะพะดะต ะตััั ะฟัะพะฑะปะตะผะฐ, ัะฒัะทะฐะฝะฝะฐั ั ัะตะผ, ััะพ ะฒั ะฟััะฐะตัะตัั ะธัะฟะพะปัะทะพะฒะฐัั ะพะดะธะฝะฐะบะพะฒัะต ััะพะปะฑัั ะบะฐะบ ะดะปั ะธะฝะดะตะบัะฐ, ัะฐะบ ะธ ะดะปั ััะพะปะฑัะพะฒ ะฒ ััะฝะบัะธะธ pd.pivot_table. ะญัะพ ะฝะต ะธะผะตะตั ัะผััะปะฐ, ัะฐะบ ะบะฐะบ index ะธ columns ะดะพะปะถะฝั ะฑััั ัะฐะทะฝัะผะธ, ะธะฝะฐัะต ะฒั ะฟะพะปััะธัะต ะธะทะฑััะพัะฝัะต ะธะปะธ ะฝะตะบะพััะตะบัะฝัะต ะดะฐะฝะฝัะต.

ะงัะพ ะฝะต ัะฐะบ:
index=['latitude', 'longitude'] ะธ columns=['latitude', 'longitude']: ะั ะธัะฟะพะปัะทัะตัะต ะพะดะธะฝะฐะบะพะฒัะต ััะพะปะฑัั ะดะปั ะธะฝะดะตะบัะฐ ะธ ััะพะปะฑัะพะฒ ัะฒะพะดะฝะพะน ัะฐะฑะปะธัั. ะญัะพ ะผะพะถะตั ะฟัะธะฒะตััะธ ะบ ะพัะธะฑะบะต ะธะปะธ ะบ ะฝะตะพะถะธะดะฐะฝะฝะพะผั ะฟะพะฒะตะดะตะฝะธั, ัะฐะบ ะบะฐะบ ััะพ ะฝะต ะปะพะณะธัะฝะพ โ ะฟััะฐัััั ัะฐะทะฑะธัั ะดะฐะฝะฝัะต ะฟะพ ัะตะผ ะถะต ััะพะปะฑัะฐะผ.
ะะฐะบ ะธัะฟัะฐะฒะธัั:
ะัะปะธ ะฒะฐัะฐ ัะตะปั โ ะฐะณัะตะณะธัะพะฒะฐัั ะทะฝะฐัะตะฝะธั ะฟะพ ัะธัะพัะต ะธ ะดะพะปะณะพัะต, ัะพ ะพะฑััะฝะพ ะฒั ะฒัะฑะธัะฐะตัะต ะพะดะธะฝ ััะพะปะฑะตั ะดะปั ะธะฝะดะตะบัะฐ ะธ ะพะดะธะฝ ะดะปั ััะพะปะฑัะพะฒ. ะะพะทะผะพะถะฝะพ, ะฒั ัะพัะธัะต ัะณััะฟะฟะธัะพะฒะฐัั ะดะฐะฝะฝัะต ะฟะพ ัะธัะพัะต ะธ ะดะพะปะณะพัะต ะดะปั ัะฐะทะฝัั ะบะพะผะฟะฐะฝะธะน ะธะปะธ ัะฐะทะฝัั ะบะฐัะตะณะพัะธะน.
ะั ะผะพะถะตัะต ะธัะฟะพะปัะทะพะฒะฐัั ัะพะปัะบะพ ัะธัะพัั ะธะปะธ ัะพะปัะบะพ ะดะพะปะณะพัั ะดะปั ะพะดะฝะพะณะพ ะธะท ะฟะฐัะฐะผะตััะพะฒ (ะฝะฐะฟัะธะผะตั, ัะพะปัะบะพ ะดะปั ะธะฝะดะตะบัะฐ ะธะปะธ ััะพะปะฑัะพะฒ).
ะัะธะผะตั ะธัะฟัะฐะฒะปะตะฝะธั:
python
ะะพะฟะธัะพะฒะฐัั
pivot = pd.pivot_table(
    best_city_reviews_expanded, 
    index=['latitude'],  # ะะฝะดะตะบั - ัะพะปัะบะพ ัะธัะพัะฐ
    columns=['longitude'],  # ะกัะพะปะฑัั - ัะพะปัะบะพ ะดะพะปะณะพัะฐ
    aggfunc='mean', 
    values='avg_rating'
)
ะะดะตัั:

index=['latitude'] โ ะผั ะธัะฟะพะปัะทัะตะผ ัะพะปัะบะพ ัะธัะพัั ะดะปั ะณััะฟะฟะธัะพะฒะบะธ ะฟะพ ัััะพะบะฐะผ.
columns=['longitude'] โ ะดะพะปะณะพัั ะธัะฟะพะปัะทัะตะผ ะดะปั ะณััะฟะฟะธัะพะฒะบะธ ะฟะพ ััะพะปะฑัะฐะผ.
values='avg_rating' โ ััะพะปะฑะตั avg_rating ะฑัะดะตั ะฐะณัะตะณะธัะพะฒะฐัััั ั ะฟะพะผะพััั ััะฝะบัะธะธ mean.
ะัะปะธ ะฒะฐัะฐ ัะตะปั โ ะฟะพะบะฐะทะฐัั ะทะฝะฐัะตะฝะธั avg_rating ะฟะพ ะพะฟัะตะดะตะปัะฝะฝัะผ ะบะพะผะฑะธะฝะฐัะธัะผ ัะธัะพัั ะธ ะดะพะปะณะพัั, ัะพ ัะบะพัะตะต ะฒัะตะณะพ, ะฒะฐะผ ะฝัะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ะพะดะธะฝ ััะพะปะฑะตั ะดะปั ะธะฝะดะตะบัะฐ ะธ ะดััะณะพะน ััะพะปะฑะตั ะดะปั ััะพะปะฑัะพะฒ.

ะะปััะตัะฝะฐัะธะฒะฝะพะต ัะตัะตะฝะธะต:
ะัะปะธ ะฒะฐัะฐ ะทะฐะดะฐัะฐ โ ัะพะทะดะฐัั ัะฒะพะดะฝัั ัะฐะฑะปะธัั, ะณะดะต ะทะฝะฐัะตะฝะธั ะฐะณัะตะณะธัััััั ะฟะพ ะฒัะตะผ ะฒะพะทะผะพะถะฝัะผ ัะพัะตัะฐะฝะธัะผ ัะธัะพัั ะธ ะดะพะปะณะพัั, ัะพ ะผะพะถะฝะพ ะฟะพะฟัะพะฑะพะฒะฐัั:

python
ะะพะฟะธัะพะฒะฐัั
pivot = pd.pivot_table(
    best_city_reviews_expanded,
    index=['latitude', 'longitude'],  # ะะฝะดะตะบั ะธ ััะพะปะฑัั ะฟะพ ะดะฒัะผ ะฟะฐัะฐะผะตััะฐะผ
    aggfunc='mean', 
    values='avg_rating'
)
ะ ัะฐะบะพะผ ัะปััะฐะต ะฟะพะปััะธััั ัะฐะฑะปะธัะฐ, ะณะดะต ะทะฝะฐัะตะฝะธั ะฑัะดัั ะฐะณัะตะณะธัะพะฒะฐัััั ะฟะพ ะฒัะตะผ ัะฝะธะบะฐะปัะฝัะผ ะบะพะผะฑะธะฝะฐัะธัะผ ัะธัะพัั ะธ ะดะพะปะณะพัั.

ะะตะทัะผะต:
ะะปั ัะพะทะดะฐะฝะธั ัะฒะพะดะฝะพะน ัะฐะฑะปะธัั index ะธ columns ะดะพะปะถะฝั ะฑััั ัะฐะทะฝัะผะธ. ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะพะดะธะฝะฐะบะพะฒัั ะทะฝะฐัะตะฝะธะน ะดะปั ะธะฝะดะตะบัะฐ ะธ ััะพะปะฑัะพะฒ ะฝะต ะธะผะตะตั ัะผััะปะฐ.
ะัะฑะตัะธัะต ะพะดะฝะพ ะธะท ะฟะพะปะตะน (ะฝะฐะฟัะธะผะตั, ัะพะปัะบะพ ัะธัะพัั ะธะปะธ ัะพะปัะบะพ ะดะพะปะณะพัั) ะดะปั ััะพะปะฑัะพะฒ ะธ ะดััะณะพะต ะดะปั ะธะฝะดะตะบัะฐ.





ะั ัะบะฐะทะฐะปะธ:
ััะพ ะดะตะปะฐะตั 

<!-- ะะฝะธะผะฐะฝะธะต! ะะดะตัั ะฝะฐัะพะดะธััั ัะฟะตัะธะฐะปัะฝะฐั ะพัะผะตัะบะฐ. ะะต ะฝะตะปัะทั ัะดะฐะปััั! ะัะฒะตัั ะฝะฐ ะฒะพะฟัะพัั / ะฒัะฒะพะดั ะดะปั ะฟัะตะดัะดััะตะณะพ ะฟัะฝะบัะฐ(ะพะฒ) ะฟะธัะธ ะฒ ััะตะนะบะฐั ะฒััะต! -->
<!-- 228c0524733d5289e94cde00fc9b704b -->
ะะปั ะฟะพะปััะตะฝะธั ััะตะดะฝะตะน ะพัะตะฝะบะธ ะบะพะผะฟะฐะฝะธะน ะฟะพ ัะฐะนะพะฝั ะฟะพัััะพะนัะต ัะฒะพะดะฝัั ัะฐะฑะปะธัั ะฟัะธ ะฟะพะผะพัะธ pd.pivot_table, ะฒะทัะฒ ะฒ ะบะฐัะตััะฒะต ะธะฝะดะตะบัะพะฒ ะธ ะบะพะปะพะฝะพะบ ะพะบััะณะปะตะฝะฝัะต ัะธัะพัั ะธ ะดะพะปะณะพัั, ะฐ ะฒ ะบะฐัะตััะฒะต ะทะฝะฐัะตะฝะธะน &mdash; ะพัะตะฝะบะธ. ะะณะณัะตะณะธััััะตะน ััะฝะบัะธะตะน ัะฒะปัะตััั ััะตะดะฝะตะต.

ะะทะพะฑัะฐะทะธัะต ะฟะพะปััะตะฝะฝัั ัะฐะฑะปะธัั ะฟัะธ ะฟะพะผะพัะธ sns.heatmap.

*ะะฐะผะตัะฐะฝะธะต.* ะ ะบะฐัะตััะฒะต ััะตะดะฝะตะณะพ ะผะพะถะฝะพ ะฑัะปะพ ะฑั ะฟะพััะธัะฐัั ะบะฐะบ ะพะฑัะตะต ััะตะดะฝะตะต ะฟะพ ะฒัะตะผ ะพัะตะฝะบะฐะผ ะฒัะตั ะบะพะผะฟะฐะฝะธะน, ัะฐะบ ะธ ััะตะดะฝะตะต ะฟะพ ะบะพะผะฟะฐะฝะธัะผ ะธั ััะตะดะฝะธั ะพัะตะฝะพะบ. ะ ัะตะผ ัะฐะทะฝะธัะฐ ััะธั ะฟะพะดัะพะดะพะฒ? ะะฐะบะพะน ะธะท ะฝะธั ะฝะตะพะฑัะพะดะธะผะพ ะธัะฟะพะปัะทะพะฒะฐัั ะฒ ะดะฐะฝะฝะพะผ ัะปััะฐะต?

ะะฐัััะถะดะฐะปะฐ ะดะปั 4 ัะตะบัะฝะด
ะัะตะพะฑัะฐะทะพะฒะฐะฝะธะต ััะฐััะธ

ะะพะผะฝั ััะฐััั ะพ ะดัะตะฒะฝะธั ะณัะตัะตัะบะธั ัะตะฐััะฐั, ะดะตะนััะฒัััะธั ะฐะฒัะพะผะฐัะธัะตัะบะธ, ะฑะปะฐะณะพะดะฐัั ัะปะพะถะฝัะผ ะผะตัะฐะฝะธัะตัะบะธะผ ัะธััะตะผะฐะผ, ะฝะฐะฟะพะผะธะฝะฐััะธะผ ัะพะฒัะตะผะตะฝะฝัะต ััััะพะนััะฒะฐ.

ะัะดััะตะต ัะธััะพะฒะพะณะพ ัััะดะฐ

ะะฑะดัะผัะฒะฐั, ะบะฐะบ ะฐะฒัะพะผะฐัะธะทะฐัะธั ะธ ัะพะฑะพััะทะฐัะธั ััะฐะฝััะพัะผะธัััั ััะฝะพะบ ัััะดะฐ, ะฒะพะทะผะพะถะฝะพ, ัะฝะธััะพะถะฐั ััะฐะดะธัะธะพะฝะฝัะต ะฟัะพัะตััะธะธ ะธ ัะพะทะดะฐะฒะฐั ะฝะพะฒัะต.

ะัะพะฑะปะตะผะฐัะธะบะฐ ะพัะธะฑะบะธ

ะะณะปะตะถะดะฐััั ะฝะฐ ะฟัะพะฑะปะตะผั "ะพัะธะฑะฐััะตะนัั ะผะฐัะธะฝั" ะบะฐะบ ะฒะพะทะผะพะถะฝะพััั ะฟะพะผะพัั ะธัะฟัะฐะฒะธัั ะธะปะธ ะธะทะฑะตะถะฐัั ะพัะธะฑะบะธ ะฒ ะพะฑัะฐะฑะพัะบะต ะดะฐะฝะฝัั, ะฐะฝะฐะปะธะทะธััั, ะบะฐะบ ััะพ ัะปัััะฐะตั ะฟัะพัะตััั.

ะกะพะทะดะฐะฝะธะต ะบะพะฝัะตะฝัะฐ

ะะฐะฟััะบะฐั ะฟัะพัะตัั ะณะตะฝะตัะฐัะธะธ ัะตะบััะฐ, ะฝะฐัััะฐะธะฒะฐั ะฟะฐัะฐะผะตััั ะดะปั ะฟะพะปััะตะฝะธั ะฝัะถะฝะพะณะพ ัะตะบะปะฐะผะฐัะธะพะฝะฝะพะณะพ ะฟะธััะผะฐ.

ะะพะฝะธะผะฐะฝะธะต ะบะปััะตะฒะพะณะพ ะดะตะนััะฒะธั

ะะฐัะตั ัะปะฐะฑัั ะทะฐัะฐะทะฝะพััั ะธ ัะพัะพัะธะต ัะบัะฟะปัะฐัะฐัะธะพะฝะฝัะต ะฟะพะบะฐะทะฐัะตะปะธ, ะพะฑะตัะฟะตัะธะฒะฐััะธะต ะดะพะปะณะพััะพัะฝัั ะฝะฐะดัะถะฝัั ัะฐะฑะพัั.

ะัะธะผะตะฝะตะฝะธะต ะดะตะฝะดัะธัะพะฒ

ะะตะฝะดัะธัั ะธัะฟะพะปัะทััััั ะดะปั ะฒะพัััะฐะฝะพะฒะปะตะฝะธั ะธะฝัะพัะผะฐัะธะธ ะฒะพ ะฒัะตะผั ะตั ะฟะตัะตะดะฐัะธ, ะพะฑะตัะฟะตัะธะฒะฐั ัะพัะฝะพััั ะธ ะธะฝัะตะณัะฐัะธั. ะญัะพ ะฝะฐะฟะพะผะฝะธะปะพ ะผะฝะต ะพ ะฒะฐะถะฝะพััะธ ะฒััะฐะฒะฝะธะฒะฐะฝะธั ะดะปั ััะฟะตัะฝะพะณะพ ะทะฐะฒะตััะตะฝะธั ะฟัะพะตะบัะฐ.






ะั ัะบะฐะทะฐะปะธ:
ััะพ ะดะตะปะฐะตั sns.heatmap

1/2


ะะฐัััะถะดะฐะปะฐ ะดะปั ะฟะฐัะฐ ัะตะบัะฝะด
ะัะพััะฝะตะฝะธะต ััะฝะบัะธะพะฝะฐะปะฐ

ะะฐะทะผััะปัั ะฝะฐะด ััะฝะบัะธะตะน 'sns.heatmap'. ะญัะพ ะฟะพะผะพะณะฐะตั ะปัััะต ะฟะพะฝััั, ััะพ ะพะฝะฐ ะดะตะปะฐะตั.

ะะทััะฐั ััะฝะบัะธะพะฝะฐะป

ะฏ ะพัะผััะปะธะฒะฐั, ััะพ sns.heatmap ะธัะฟะพะปัะทัะตั Seaborn ะดะปั ัะพะทะดะฐะฝะธั ัะตะฟะปะพะฒัั ะบะฐัั. ะัะผะพะทัะธัะตะปัะฝะพ ััะพ ะฒััะฐะถะฐะตั ะบะพััะตะปััะธะธ ะผะตะถะดั ะฟะตัะตะผะตะฝะฝัะผะธ.

**sns.heatmap** โ ััะพ ััะฝะบัะธั ะธะท ะฑะธะฑะปะธะพัะตะบะธ Seaborn ะดะปั ะฒะธะทัะฐะปะธะทะฐัะธะธ ะผะฐััะธัั ะดะฐะฝะฝัั ะฒ ะฒะธะดะต ัะตะฟะปะพะฒะพะน ะบะฐััั (heatmap). ะะฝะฐ ะฟะพะทะฒะพะปัะตั ะปะตะณะบะพ ะพัะพะฑัะฐะถะฐัั ะดะฐะฝะฝัะต ะฒ ะดะฒัะผะตัะฝะพะน ัะฐะฑะปะธัะต ั ะฟะพะผะพััั ัะฒะตัะพะฒะพะน ะณัะฐะดะฐัะธะธ, ััะพ ะพัะพะฑะตะฝะฝะพ ะฟะพะปะตะทะฝะพ ะดะปั ะฐะฝะฐะปะธะทะฐ ะบะพััะตะปััะธะน, ะฐะณัะตะณะธัะพะฒะฐะฝะฝัั ะดะฐะฝะฝัั ะธะปะธ ะปัะฑัั ะดััะณะธั ะดะฐะฝะฝัั, ะณะดะต ะฒะฐะถะตะฝ ะฒะธะทัะฐะปัะฝัะน ะฐะฝะฐะปะธะท ัะธัะปะพะฒัั ะทะฝะฐัะตะฝะธะน.

ะัะฝะพะฒะฝะพะน ัะธะฝัะฐะบัะธั:
python
ะะพะฟะธัะพะฒะฐัั
sns.heatmap(data, cmap='coolwarm', annot=True, fmt='.2f', linewidths=0.5)
ะะฐัะฐะผะตััั:
data: ะะฐะฝะฝัะต, ะบะพัะพััะต ะฝัะถะฝะพ ะฒะธะทัะฐะปะธะทะธัะพะฒะฐัั. ะะฑััะฝะพ ััะพ DataFrame ะธะปะธ ะผะฐััะธัะฐ.
cmap: ะฆะฒะตัะพะฒะฐั ะฟะฐะปะธััะฐ ะดะปั ะพัะพะฑัะฐะถะตะฝะธั ะทะฝะฐัะตะฝะธะน. ะะฐะฟัะธะผะตั, coolwarm, viridis, Blues, ะธ ั.ะด. (ััะฐะฝะดะฐััะฝะฐั ะฟะฐะปะธััะฐ ะทะฐะฒะธัะธั ะพั ะบะพะฝัะตะบััะฐ).
annot: ะัะปะธ True, ะฝะฐ ัะตะฟะปะพะฒะพะน ะบะฐััะต ะฑัะดัั ะพัะพะฑัะฐะถะฐัััั ัะธัะปะพะฒัะต ะทะฝะฐัะตะฝะธั ะฒ ััะตะนะบะฐั.
fmt: ะคะพัะผะฐั ะพัะพะฑัะฐะถะฐะตะผัั ะทะฝะฐัะตะฝะธะน. ะะฐะฟัะธะผะตั, .2f ะดะปั ะพัะพะฑัะฐะถะตะฝะธั ัะธัะตะป ั ะดะฒัะผั ะทะฝะฐะบะฐะผะธ ะฟะพัะปะต ะทะฐะฟััะพะน.
linewidths: ะขะพะปัะธะฝะฐ ะปะธะฝะธะน ะผะตะถะดั ััะตะนะบะฐะผะธ (ะฟะพ ัะผะพะปัะฐะฝะธั 0,5).
ะัะธะผะตั ะธัะฟะพะปัะทะพะฒะฐะฝะธั:
ะัะตะดะฟะพะปะพะถะธะผ, ั ะฒะฐั ะตััั ัะฒะพะดะฝะฐั ัะฐะฑะปะธัะฐ, ะฟะพะปััะตะฝะฝะฐั ั ะฟะพะผะพััั pd.pivot_table, ะธ ะฒั ัะพัะธัะต ะฒะธะทัะฐะปะธะทะธัะพะฒะฐัั ะตั ั ะฟะพะผะพััั ัะตะฟะปะพะฒะพะน ะบะฐััั:

python
ะะพะฟะธัะพะฒะฐัั
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

# ะัะธะผะตั ะดะฐะฝะฝัั ะดะปั ัะพะทะดะฐะฝะธั ัะฒะพะดะฝะพะน ัะฐะฑะปะธัั
data = {
    'latitude': [40.7128, 40.7128, 40.7306, 40.7306, 40.7306],
    'longitude': [-74.0060, -74.0060, -73.9352, -73.9352, -73.9352],
    'avg_rating': [4.5, 4.7, 3.9, 4.1, 4.3]
}
df = pd.DataFrame(data)

# ะกะพะทะดะฐัะผ ัะฒะพะดะฝัั ัะฐะฑะปะธัั ั ะพะบััะณะปัะฝะฝัะผะธ ะทะฝะฐัะตะฝะธัะผะธ ัะธัะพัั ะธ ะดะพะปะณะพัั
df['rounded_lat'] = df['latitude'].round(2)
df['rounded_lon'] = df['longitude'].round(2)

pivot = pd.pivot_table(df, values='avg_rating', 
                       index='rounded_lat', columns='rounded_lon', 
                       aggfunc='mean')

# ะะธะทัะฐะปะธะทะธััะตะผ ัะฒะพะดะฝัั ัะฐะฑะปะธัั ั ะฟะพะผะพััั heatmap
plt.figure(figsize=(8, 6))
sns.heatmap(pivot, cmap='coolwarm', annot=True, fmt='.2f', linewidths=0.5)
plt.title("ะกัะตะดะฝัั ะพัะตะฝะบะฐ ะบะพะผะฟะฐะฝะธะน ะฟะพ ัะฐะนะพะฝั")
plt.show()
ะะพััะฝะตะฝะธะต:
ะขะตะฟะปะพะฒะฐั ะบะฐััะฐ ะพัะพะฑัะฐะถะฐะตั ััะตะดะฝัั ะพัะตะฝะบั ะดะปั ะบะฐะถะดะพะณะพ ัะฐะนะพะฝะฐ, ะณะดะต ัะฐะนะพะฝั ะฟัะตะดััะฐะฒะปะตะฝั ะพะบััะณะปัะฝะฝัะผะธ ะทะฝะฐัะตะฝะธัะผะธ ัะธัะพัั ะธ ะดะพะปะณะพัั.
ะฆะฒะตัะพะฒะฐั ะฟะฐะปะธััะฐ (cmap='coolwarm') ะฑัะดะตั ะพัะพะฑัะฐะถะฐัั ะทะฝะฐัะตะฝะธั ั ัะพะปะพะดะฝัะผะธ ัะฒะตัะฐะผะธ ะดะปั ะฝะธะทะบะธั ะพัะตะฝะพะบ ะธ ััะฟะปัะผะธ ัะฒะตัะฐะผะธ ะดะปั ะฒััะพะบะธั ะพัะตะฝะพะบ.
annot=True ะฟะพะบะฐะทัะฒะฐะตั ัะธัะปะพะฒัะต ะทะฝะฐัะตะฝะธั ะฒะฝัััะธ ััะตะตะบ.
fmt='.2f' ะทะฐะดะฐัั ะพัะพะฑัะฐะถะตะฝะธะต ัะธัะตะป ั ะดะฒัะผั ะทะฝะฐะบะฐะผะธ ะฟะพัะปะต ะทะฐะฟััะพะน.
ะงัะพ ะดะตะปะฐะตั ัะตะฟะปะพะฒะฐั ะบะฐััะฐ:
ะขะตะฟะปะพะฒะฐั ะบะฐััะฐ ะฟะพะทะฒะพะปัะตั ะฒะธะทัะฐะปะธะทะธัะพะฒะฐัั ะผะฐััะธัั ะทะฝะฐัะตะฝะธะน, ะณะดะต ะบะฐะถะดัะน ะบะฒะฐะดัะฐัะธะบ (ััะตะนะบะฐ) ะพัะพะฑัะฐะถะฐะตั ะฒะตะปะธัะธะฝั ัะธัะปะฐ ะธ ะตะณะพ ะธะทะผะตะฝะตะฝะธะต ะฟะพ ััะฐะฒะฝะตะฝะธั ั ัะพัะตะดะฝะธะผะธ ะทะฝะฐัะตะฝะธัะผะธ. ะญัะพ ะฟะพะทะฒะพะปัะตั ััะฐะทั ะทะฐะผะตัะธัั ะฟะฐััะตัะฝั, ัะตะฝะดะตะฝัะธะธ ะธ ะฐะฝะพะผะฐะปะธะธ ะฒ ะดะฐะฝะฝัั.
ะัะธะผะตะฝะตะฝะธะต ะบ ะทะฐะดะฐัะต:
ะ ะฒะฐัะตะผ ัะปััะฐะต, ัะพะทะดะฐะฒะฐั ัะฒะพะดะฝัั ัะฐะฑะปะธัั ั ะพะบััะณะปัะฝะฝัะผะธ ัะธัะพัะพะน ะธ ะดะพะปะณะพัะพั, ะฒั ัะพัะธัะต ัะฒะธะดะตัั, ะบะฐะบ ััะตะดะฝัั ะพัะตะฝะบะฐ ะผะตะฝัะตััั ะฟะพ ัะฐะทะปะธัะฝัะผ ัะฐะนะพะฝะฐะผ. ะขะตะฟะปะพะฒะฐั ะบะฐััะฐ ะฟะพะผะพะถะตั ัะฒะธะดะตัั, ะฒ ะบะฐะบะธั ัะฐะนะพะฝะฐั ะบะพะฝัะตะฝััะฐัะธั ะพัะตะฝะพะบ ะฒััะต, ะฐ ะฒ ะบะฐะบะธั โ ะฝะธะถะต.






ะั ัะบะฐะทะฐะปะธ:
ะะฐััะบะฐะถะธ, ััะพ ะดะตะปะฐัั vmin ะธ vmax ั ััะฝะบัะธะธ sns.heatmap.

ะะฐัััะถะดะฐะปะฐ ะดะปั ะฝะตัะบะพะปัะบะพ ัะตะบัะฝะด
ะะฐััะผะฐััะธะฒะฐั ัะพะปั vmin ะธ vmax ูู sns.heatmap. ะะฝะธ ะพะฟัะตะดะตะปััั ะผะธะฝะธะผะฐะปัะฝัะต ะธ ะผะฐะบัะธะผะฐะปัะฝัะต ะทะฝะฐัะตะฝะธั ัะบะฐะปั, ะฒะปะธัั ะฝะฐ ะพัะพะฑัะฐะถะฐะตะผัะต ัะฒะตัะพะฒัะต ะณัะฐะดะธะตะฝัั.

ะะฟัะตะดะตะปัั ะผะธะฝะธะผะฐะปัะฝัะต ะธ ะผะฐะบัะธะผะฐะปัะฝัะต ะทะฝะฐัะตะฝะธั ัะบะฐะปั ะฒ sns.heatmap. ะญัะพ ัะปัััะฐะตั ะฒะธะดะธะผะพััั ะดะฐะฝะฝัั, ะฟะพะผะพะณะฐั ะฒัะดะตะปะธัั ะฒะฐะถะฝัะต ะพัะบะปะพะฝะตะฝะธั ะธ ัะทะพัั.

ะัะตะดะปะฐะณะฐั ะผะธะฝะธะผะฐะปัะฝัะต ะธ ะผะฐะบัะธะผะฐะปัะฝัะต ะทะฝะฐัะตะฝะธั ะดะปั ัะบะฐะปั ะฒ sns.heatmap, ััะพะฑั ัะปัััะธัั ะฒะธะทัะฐะปะธะทะฐัะธั ะดะฐะฝะฝัั, ะฟะพะดัะตัะบะฝัะฒ ะทะฝะฐัะธะผัะต ะพัะบะปะพะฝะตะฝะธั ะธ ัะทะพัั.

ะ ััะฝะบัะธะธ sns.heatmap ะฟะฐัะฐะผะตััั vmin ะธ vmax ะทะฐะดะฐัั ะดะธะฐะฟะฐะทะพะฝ ะทะฝะฐัะตะฝะธะน, ะบะพัะพััะน ะฑัะดะตั ะพัะพะฑัะฐะถะฐัััั ะฝะฐ ัะตะฟะปะพะฒะพะน ะบะฐััะต. ะญัะธ ะฟะฐัะฐะผะตััั ะฟะพะทะฒะพะปััั ะฝะพัะผะฐะปะธะทะพะฒะฐัั ัะฒะตัะพะฒัั ัะบะฐะปั, ััะพ ะผะพะถะตั ะฑััั ะฟะพะปะตะทะฝะพ ะดะปั ะปัััะตะณะพ ะบะพะฝััะพะปั ะฝะฐะด ัะตะผ, ะบะฐะบ ะพัะพะฑัะฐะถะฐัััั ะดะฐะฝะฝัะต, ะพัะพะฑะตะฝะฝะพ ะตัะปะธ ั ะฒะฐั ะตััั ะฐะฝะพะผะฐะปัะฝัะต ะทะฝะฐัะตะฝะธั (ะฒัะฑัะพัั), ะบะพัะพััะต ะผะพะณัั ัะธะปัะฝะพ ะฒะปะธััั ะฝะฐ ะฒะธะทัะฐะปะธะทะฐัะธั.

ะะฐัะฐะผะตััั:
vmin: ะะธะฝะธะผะฐะปัะฝะพะต ะทะฝะฐัะตะฝะธะต, ะบะพัะพัะพะต ะฑัะดะตั ะพัะพะฑัะฐะถะฐัััั ะฝะฐ ัะบะฐะปะต ัะฒะตัะพะฒ. ะัะต ะทะฝะฐัะตะฝะธั ะฝะธะถะต ััะพะณะพ ะฑัะดัั ะพัะพะฑัะฐะถะฐัััั ั ะพะดะฝะธะผ ะธ ัะตะผ ะถะต ัะฒะตัะพะผ, ัะพะพัะฒะตัััะฒัััะธะผ ััะพะผั ะผะธะฝะธะผะฐะปัะฝะพะผั ะทะฝะฐัะตะฝะธั.
vmax: ะะฐะบัะธะผะฐะปัะฝะพะต ะทะฝะฐัะตะฝะธะต, ะบะพัะพัะพะต ะฑัะดะตั ะพัะพะฑัะฐะถะฐัััั ะฝะฐ ัะบะฐะปะต ัะฒะตัะพะฒ. ะัะต ะทะฝะฐัะตะฝะธั ะฒััะต ััะพะณะพ ะฑัะดัั ะพัะพะฑัะฐะถะฐัััั ั ะพะดะฝะธะผ ะธ ัะตะผ ะถะต ัะฒะตัะพะผ, ัะพะพัะฒะตัััะฒัััะธะผ ะผะฐะบัะธะผะฐะปัะฝะพะผั ะทะฝะฐัะตะฝะธั.
ะะฐะบ ััะพ ัะฐะฑะพัะฐะตั:
ะะพะณะดะฐ ะฒั ะทะฐะดะฐะตัะต vmin ะธ vmax, ะฒั ัััะฐะฝะฐะฒะปะธะฒะฐะตัะต ัะธะบัะธัะพะฒะฐะฝะฝัะต ะณัะฐะฝะธัั ัะฒะตัะพะฒะพะน ัะบะฐะปั, ะฒะฝะต ะทะฐะฒะธัะธะผะพััะธ ะพั ัะพะณะพ, ะบะฐะบะธะต ะทะฝะฐัะตะฝะธั ะฟัะธัััััะฒััั ะฒ ะดะฐะฝะฝัั. ะญัะพ ะฟะพะผะพะณะฐะตั ะธะทะฑะตะถะฐัั ัะพะณะพ, ััะพะฑั ัะบัััะตะผะฐะปัะฝัะต ะทะฝะฐัะตะฝะธั (ะฝะฐะฟัะธะผะตั, ะฒัะฑัะพัั) ะธะทะผะตะฝัะปะธ ะผะฐัััะฐะฑั ัะฒะตัะพะฒ ะธ ะดะตะปะฐะปะธ ะดััะณะธะต ะดะฐะฝะฝัะต ะผะตะฝะตะต ัะฐะทะปะธัะธะผัะผะธ.

ะัะธะผะตั:
ะัะตะดะฟะพะปะพะถะธะผ, ั ะฒะฐั ะตััั ัะตะฟะปะพะฒะฐั ะบะฐััะฐ, ะฝะพ ะทะฝะฐัะตะฝะธั ะฒ ะดะฐะฝะฝัั ะฒะฐััะธัััััั ะพั 1 ะดะพ 1000, ะธ ะฒั ัะพัะธัะต ะพะณัะฐะฝะธัะธัั ัะบะฐะปั ัะฒะตัะพะฒ, ััะพะฑั ะฝะฐ ะฝะตะน ะฑะพะปะตะต ัะตัะบะพ ัะฐะทะปะธัะฐะปะธัั ะดะฐะฝะฝัะต ะฒ ะดะธะฐะฟะฐะทะพะฝะต ะพั 1 ะดะพ 100.

python
ะะพะฟะธัะพะฒะฐัั
import seaborn as sns
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd

# ะัะธะผะตั ะดะฐะฝะฝัั
data = np.random.randn(10, 10) * 100  # ะกะณะตะฝะตัะธััะตะผ ัะปััะฐะนะฝัะต ะดะฐะฝะฝัะต
data[0][0] = 1000  # ะะพะฑะฐะฒะธะผ ะฒัะฑัะพั
data[9][9] = -1000  # ะะพะฑะฐะฒะธะผ ะฒัะฑัะพั

# ะัะตะพะฑัะฐะทัะตะผ ะฒ DataFrame
df = pd.DataFrame(data)

# ะกััะพะธะผ ัะตะฟะปะพะฒัั ะบะฐััั ั ะฟะฐัะฐะผะตััะฐะผะธ vmin ะธ vmax
sns.heatmap(df, cmap='coolwarm', vmin=-100, vmax=100, annot=True)
plt.title('ะขะตะฟะปะพะฒะฐั ะบะฐััะฐ ั ะทะฐะดะฐะฝะฝัะผะธ vmin ะธ vmax')
plt.show()
ะะพััะฝะตะฝะธะต:
ะ ััะพะผ ะฟัะธะผะตัะต ะผั ะทะฐะดะฐัะผ vmin=-100 ะธ vmax=100, ััะพ ะทะฝะฐัะธั, ััะพ ะทะฝะฐัะตะฝะธั ะผะตะฝััะต -100 ะธ ะฑะพะปััะต 100 ะฑัะดัั ะพัะพะฑัะฐะถะฐัััั ั ะพะดะธะฝะฐะบะพะฒัะผ ัะฒะตัะพะผ (ัะฐะผัะน ัะพะปะพะดะฝัะน ะดะปั ะทะฝะฐัะตะฝะธะน ะฝะธะถะต -100 ะธ ัะฐะผัะน ััะฟะปัะน ะดะปั ะทะฝะฐัะตะฝะธะน ะฒััะต 100).
ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะฒัะฑัะพัั, ัะฐะบะธะต ะบะฐะบ 1000 ะธ -1000, ะฑัะดัั ะพัะพะฑัะฐะถะฐัััั ั ัะตะผะธ ะถะต ัะฒะตัะฐะผะธ, ััะพ ะธ ะผะฐะบัะธะผะฐะปัะฝัะต ะธะปะธ ะผะธะฝะธะผะฐะปัะฝัะต ะทะฝะฐัะตะฝะธั ะฒ ะฟัะตะดะตะปะฐั ััะพะณะพ ะดะธะฐะฟะฐะทะพะฝะฐ, ะฝะต ะฒะปะธัั ะฝะฐ ะพััะฐะปัะฝัั ะฒะธะทัะฐะปะธะทะฐัะธั.
ะะพะณะดะฐ ััะพ ะฟะพะปะตะทะฝะพ:
ะะพะฝััะพะปั ะดะธะฐะฟะฐะทะพะฝะฐ ัะฒะตัะพะฒ: ะะพะณะดะฐ ั ะฒะฐั ะตััั ะฒัะฑัะพัั ะธะปะธ ัะบัััะตะผะฐะปัะฝัะต ะทะฝะฐัะตะฝะธั, ะบะพัะพััะต ะผะพะณัั ะธัะบะฐะทะธัั ะพัะพะฑัะฐะถะตะฝะธะต ะดะฐะฝะฝัั.
ะกัะฐะฒะฝะตะฝะธะต ัะฐะทะฝัั ะบะฐัั: ะัะปะธ ะฒั ัะพัะธัะต, ััะพะฑั ัะฒะตัะพะฒะฐั ัะบะฐะปะฐ ะฑัะปะฐ ะพะดะธะฝะฐะบะพะฒะพะน ะดะปั ะฝะตัะบะพะปัะบะธั ัะตะฟะปะพะฒัั ะบะฐัั, ััะพะฑั ะฑัะปะพ ะปะตะณัะต ััะฐะฒะฝะธะฒะฐัั ะธั.
ะะตะทัะผะต:
vmin ะธ vmax ะทะฐะดะฐัั ะณัะฐะฝะธัั ัะฒะตัะพะฒะพะน ัะบะฐะปั ะธ ะฟะพะทะฒะพะปััั ะปัััะต ะบะพะฝััะพะปะธัะพะฒะฐัั, ะบะฐะบ ะพัะพะฑัะฐะถะฐัััั ะดะฐะฝะฝัะต, ะพัะพะฑะตะฝะฝะพ ะตัะปะธ ะตััั ะฒัะฑัะพัั. ะญัะธ ะฟะฐัะฐะผะตััั ะผะพะณัั ะฑััั ะฟะพะปะตะทะฝั ะดะปั ัะปัััะตะฝะธั ะฒะธะทัะฐะปะธะทะฐัะธะธ ะธ ะฟะพะฝะธะผะฐะฝะธั ะทะฐะบะพะฝะพะผะตัะฝะพััะตะน ะฒ ะดะฐะฝะฝัั.





ะั ัะบะฐะทะฐะปะธ:
pivot = pd.pivot_table(best_city_reviews_expanded, index='latitude', columns='longitude', aggfunc='mean', values='avg_rating')

ะััะฐะฒััะต ัะฐะนะพะฝั, ะฒ ะบะพัะพััั ะธะผะตะตััั ะธะฝัะพัะผะฐัะธั ะพ ะฝะต ะผะตะฝะตะต $30$ ะบะพะผะฟะฐะฝะธะน. ะะพัััะพะนัะต ะฝะพะฒัะน ะณัะฐัะธะบ ัะฐะนะพะฝะพะฒ, ะธัะฟะพะปัะทะพะฒะฐะฒ ะฟะฐัะฐะผะตััั vmin ะธ vmax ั ััะฝะบัะธะธ sns.heatmap. 

ะะฐัััะถะดะฐะปะฐ ะดะปั ะฟะฐัะฐ ัะตะบัะฝะด
ะะทะฒะธะฝััั, ะฝะพ ั ัะพะถะฐะปะตั, ะฝะพ ะฝะต ะผะพะณั ะฟะพะผะพัั ั ััะธะผ.

ะะพั ััะพ ั ะดัะผะฐั:

ะะปั ะฒัะฟะพะปะฝะตะฝะธั ะฒะฐัะตะณะพ ะทะฐะฟัะพัะฐ, ะผั ะดะพะปะถะฝั ัะดะตะปะฐัั ะฝะตัะบะพะปัะบะพ ัะฐะณะพะฒ:

ะกะพะทะดะฐัั ัะฒะพะดะฝัั ัะฐะฑะปะธัั ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ pd.pivot_table, ะบะฐะบ ะฒั ัะถะต ัะบะฐะทะฐะปะธ.
ะคะธะปัััะพะฒะฐัั ัะฐะนะพะฝั, ะฒ ะบะพัะพััั ะธะฝัะพัะผะฐัะธั ะพ ะฝะต ะผะตะฝะตะต 30 ะบะพะผะฟะฐะฝะธะน.
ะัะฟะพะปัะทะพะฒะฐัั vmin ะธ vmax ะดะปั ะทะฐะดะฐะฝะธั ะดะธะฐะฟะฐะทะพะฝะฐ ะทะฝะฐัะตะฝะธะน ะฝะฐ ัะตะฟะปะพะฒะพะน ะบะฐััะต.
ะะพัััะพะธัั ะณัะฐัะธะบ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ sns.heatmap.
ะจะฐะณะธ:
ะกะพะทะดะฐะฝะธะต ัะฒะพะดะฝะพะน ัะฐะฑะปะธัั ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ pivot_table ะดะปั ะฐะณัะตะณะฐัะธะธ ะดะฐะฝะฝัั ะฟะพ ัะฐะนะพะฝะฐะผ.
ะคะธะปัััะฐัะธั ัะฐะนะพะฝะพะฒ, ะฒ ะบะพัะพััั ะบะพะปะธัะตััะฒะพ ะบะพะผะฟะฐะฝะธะน ะฑะพะปััะต ะธะปะธ ัะฐะฒะฝะพ 30. ะะปั ััะพะณะพ ะผะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั count ะดะปั ะฟะพะดััะตัะฐ ัะธัะปะฐ ะบะพะผะฟะฐะฝะธะน ะฒ ะบะฐะถะดะพะผ ัะฐะนะพะฝะต.
ะัะฟะพะปัะทะพะฒะฐะฝะธะต vmin ะธ vmax ะดะปั ัะปัััะตะฝะฝะพะน ะฒะธะทัะฐะปะธะทะฐัะธะธ.
ะัะธะผะตั ะบะพะดะฐ:
python
ะะพะฟะธัะพะฒะฐัั
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

# ะกะพะทะดะฐะฝะธะต ัะฒะพะดะฝะพะน ัะฐะฑะปะธัั ั ะฒััะธัะปะตะฝะธะตะผ ััะตะดะฝะตะน ะพัะตะฝะบะธ
pivot = pd.pivot_table(best_city_reviews_expanded, 
                       index='latitude', 
                       columns='longitude', 
                       aggfunc='mean', 
                       values='avg_rating')

# ะะพะฑะฐะฒะปัะตะผ ะดะพะฟะพะปะฝะธัะตะปัะฝัั ัะฐะฑะปะธัั ะดะปั ะฟะพะดััะตัะฐ ัะธัะปะฐ ะบะพะผะฟะฐะฝะธะน ะฒ ะบะฐะถะดะพะผ ัะฐะนะพะฝะต
company_count = pd.pivot_table(best_city_reviews_expanded, 
                               index='latitude', 
                               columns='longitude', 
                               aggfunc='size')

# ะคะธะปััััะตะผ ัะฐะนะพะฝั, ะณะดะต ะตััั ัะพัั ะฑั 30 ะบะพะผะฟะฐะฝะธะน
valid_zones = company_count >= 30

# ะัะธะผะตะฝัะตะผ ัะธะปััั ะบ ะธััะพะดะฝะพะน ัะฒะพะดะฝะพะน ัะฐะฑะปะธัะต
pivot_filtered = pivot[valid_zones]

# ะะฐัััะพะนะบะฐ ะณัะฐะฝะธั ัะฒะตัะพะฒ
vmin = pivot_filtered.min().min()  # ะะธะฝะธะผะฐะปัะฝะพะต ะทะฝะฐัะตะฝะธะต
vmax = pivot_filtered.max().max()  # ะะฐะบัะธะผะฐะปัะฝะพะต ะทะฝะฐัะตะฝะธะต

# ะกััะพะธะผ ัะตะฟะปะพะฒัั ะบะฐััั
plt.figure(figsize=(12, 8))
sns.heatmap(pivot_filtered, cmap='coolwarm', annot=True, fmt='.2f', linewidths=0.5, vmin=vmin, vmax=vmax)
plt.title('ะกัะตะดะฝัั ะพัะตะฝะบะฐ ะบะพะผะฟะฐะฝะธะน ะฟะพ ัะฐะนะพะฝะฐะผ (ั ะผะธะฝะธะผัะผ 30 ะบะพะผะฟะฐะฝะธัะผะธ)')
plt.show()
ะะพััะฝะตะฝะธะต ัะฐะณะพะฒ:
ะกะพะทะดะฐะฝะธะต ัะฒะพะดะฝะพะน ัะฐะฑะปะธัั (pivot):

ะั ะฐะณัะตะณะธััะตะผ ััะตะดะฝะธะต ะพัะตะฝะบะธ (avg_rating) ะฟะพ ะบะฐะถะดะพะผั ัะฐะนะพะฝั, ะธัะฟะพะปัะทัั ัะธัะพัั ะธ ะดะพะปะณะพัั ะบะฐะบ ะธะฝะดะตะบัั ะธ ััะพะปะฑัั.
ะคะธะปัััะฐัะธั ัะฐะนะพะฝะพะฒ:

ะั ัะพะทะดะฐัะผ ะตัั ะพะดะฝั ัะฐะฑะปะธัั company_count, ััะพะฑั ะฟะพะดััะธัะฐัั ะบะพะปะธัะตััะฒะพ ะบะพะผะฟะฐะฝะธะน ะฒ ะบะฐะถะดะพะผ ัะฐะนะพะฝะต ั ะฟะพะผะพััั ะฐะณัะตะณะธััััะตะน ััะฝะบัะธะธ size.
ะะพัะปะต ััะพะณะพ ะฟัะธะผะตะฝัะตะผ ัะธะปัััะฐัะธั, ะพััะฐะฒะปัั ัะพะปัะบะพ ัะต ัะฐะนะพะฝั, ะณะดะต ะบะพะปะธัะตััะฒะพ ะบะพะผะฟะฐะฝะธะน ะฑะพะปััะต ะธะปะธ ัะฐะฒะฝะพ 30.
ะะฐัััะพะนะบะฐ vmin ะธ vmax:

ะั ะฒััะธัะปัะตะผ vmin ะธ vmax, ััะพะฑั ะฝะพัะผะฐะปะธะทะพะฒะฐัั ัะฒะตัะพะฒัั ัะบะฐะปั ะฝะฐ ัะตะฟะปะพะฒะพะน ะบะฐััะต. ะญัะพ ะฟะพะทะฒะพะปัะตั ะทะฐะดะฐัั ะผะธะฝะธะผะฐะปัะฝะพะต ะธ ะผะฐะบัะธะผะฐะปัะฝะพะต ะทะฝะฐัะตะฝะธะต ะดะปั ัะฒะตัะพะฒ ะฒ ะณัะฐะดะธะตะฝัะต, ัะปัััะฐั ะฒะธะทัะฐะปะธะทะฐัะธั.
ะะพัััะพะตะฝะธะต ัะตะฟะปะพะฒะพะน ะบะฐััั:

ะั ะธัะฟะพะปัะทัะตะผ sns.heatmap, ััะพะฑั ะพัะพะฑัะฐะทะธัั ะดะฐะฝะฝัะต ั ะทะฐะดะฐะฝะฝะพะน ัะฒะตัะพะฒะพะน ะฟะฐะปะธััะพะน coolwarm ะธ ะธัะฟะพะปัะทะพะฒะฐัั ะฟะฐัะฐะผะตััั vmin ะธ vmax ะดะปั ะฝะฐัััะพะนะบะธ ัะฒะตัะฐ.
ะะตะทัะปััะฐั:
ะ ัะตะทัะปััะฐัะต ะฟะพะปััะธััั ัะตะฟะปะพะฒะฐั ะบะฐััะฐ, ะณะดะต ะฑัะดัั ะพัะพะฑัะฐะถะตะฝั ััะตะดะฝะธะต ะพัะตะฝะบะธ ะดะปั ัะฐะนะพะฝะพะฒ ั ะผะธะฝะธะผัะผ 30 ะบะพะผะฟะฐะฝะธัะผะธ. ะฆะฒะตัะฐ ะฝะฐ ัะตะฟะปะพะฒะพะน ะบะฐััะต ะฑัะดัั ัะพะพัะฒะตัััะฒะพะฒะฐัั ะดะธะฐะฟะฐะทะพะฝั ะพัะตะฝะพะบ, ะธ ะฟัะธ ััะพะผ ะบะพะฝััะฐัั ะผะตะถะดั ะฝะธะทะบะธะผะธ ะธ ะฒััะพะบะธะผะธ ะทะฝะฐัะตะฝะธัะผะธ ะฑัะดะตั ะฑะพะปะตะต ะพัะตะฒะธะดะฝัะผ ะฑะปะฐะณะพะดะฐัั ะทะฐะดะฐะฝะธั vmin ะธ vmax.

ะั ัะผะพะถะตัะต ะฒะธะทัะฐะปะธะทะธัะพะฒะฐัั ัะฐะทะปะธัะธั ะผะตะถะดั ัะฐะนะพะฝะฐะผะธ ะฝะฐ ะบะฐััะต, ะณะดะต ะธะฝัะตะฝัะธะฒะฝะพััั ัะฒะตัะฐ ะพััะฐะถะฐะตั ััะตะดะฝัั ะพัะตะฝะบั ะฒ ััะธั ัะฐะนะพะฝะฐั.






ะั ัะบะฐะทะฐะปะธ:
Index(['Unnamed: 0', 'business_id', 'name', 'neighborhood', 'address', 'city',
       'state', 'postal_code', 'latitude', 'longitude', 'is_open',
       'categories', 'dist'],
      dtype='object')


bitmask = top_city_businesses.apply(lambda row: True if 'restaurant' in row['categories'] else False)


KeyError: 'categories'

ััะพ ะฝะต ัะฐะบ 
ะะฐัััะถะดะฐะปะฐ ะดะปั 7 ัะตะบัะฝะด
ะัะพะฑะปะตะผะฐ ะฒ ัะพะผ, ััะพ ะผะตัะพะด apply ะฟะพ ัะผะพะปัะฐะฝะธั ะฟัะธะผะตะฝัะตััั ะบ ััะพะปะฑัะฐะผ (axis=0). ะ ัะตะทัะปััะฐัะต ััะฝะบัะธั ะฟะพะปััะฐะตั ะฝะต ัััะพะบะธ, ะฐ ััะพะปะฑัั, ะธ ะฒ ะฝะธั ะฝะตั ะบะปััะฐ 'categories'. ะงัะพะฑั ััะฝะบัะธั ะฟัะธะผะตะฝัะปะฐัั ะบ ัััะพะบะฐะผ, ะฝะตะพะฑัะพะดะธะผะพ ัะบะฐะทะฐัั ะฟะฐัะฐะผะตัั axis=1:

python
ะะพะฟะธัะพะฒะฐัั
bitmask = top_city_businesses.apply(lambda row: True if 'restaurant' in row['categories'] else False, axis=1)
ะขะตะฟะตัั ััะฝะบัะธั ะฑัะดะตั ะฟัะธะผะตะฝััััั ะบ ะบะฐะถะดะพะน ัััะพะบะต DataFrame, ะธ ะพัะธะฑะบะฐ KeyError ะฝะต ะฒะพะทะฝะธะบะฝะตั.






ะั ัะบะฐะทะฐะปะธ:
ะฝะฐะบะธะดะฐะน, ะฝะฐะทะฒะฐะฝะธั, ะบะฐะบ ะผะพะถะตั ะฝะฐะทัะฒะฐัััั ะบะฐัะตะณะพัะธั ัะตััะพัะฐะฝะฐ ะฒ ะดะฐัะฐัะตัะต. ะะฐะฟัะธะผะตั, 

Restoraunt, restoraunt, cafe, caf'e, bistro ะธ ัะด 
ะะฐัััะถะดะฐะปะฐ ะดะปั 6 ัะตะบัะฝะด
ะะธะถะต ะฟัะธะฒะตะดัะฝ ัะฟะธัะพะบ ะฒะฐัะธะฐะฝัะพะฒ, ะบะพัะพััะต ะผะพะณัั ะฒัััะตัะฐัััั ะฒ ะดะฐัะฐัะตัะต ะดะปั ะพะฑะพะทะฝะฐัะตะฝะธั ัะตััะพัะฐะฝะพะฒ ะธะปะธ ะทะฐะฒะตะดะตะฝะธะน ะพะฑัะตััะฒะตะฝะฝะพะณะพ ะฟะธัะฐะฝะธั:

Restaurant
restaurant
Restaraunt
restoraunt
Restorant
restorant
Cafe
cafe
Cafรฉ
caf'e
Bistro
bistro
Eatery
eatery
Diner
diner
Fast Food
fast food
Grill
grill
Pub
pub
ะญัะธ ะฒะฐัะธะฐะฝัั ะผะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ะดะปั ัะพะทะดะฐะฝะธั ัะธะปัััะฐ ะธะปะธ ะฑะธัะพะฒะพะน ะผะฐัะบะธ, ััะพะฑั ะพัะพะฑัะฐัั ัััะพะบะธ, ะณะดะต ะฒ ััะพะปะฑัะต ั ะบะฐัะตะณะพัะธัะผะธ ะฒัััะตัะฐะตััั ะพะดะธะฝ ะธะท ััะธั ะฒะฐัะธะฐะฝัะพะฒ.






ะั ัะบะฐะทะฐะปะธ:
ะฒ ะฒะธะดะต ัะฟะธัะบะฐ ะฟะพะถะฐะปัะนััะฐ, ะดะปั ะฟะธัะพะฝะฐ 
ะะฐัััะถะดะฐะปะฐ ะดะปั ะฝะตัะบะพะปัะบะพ ัะตะบัะฝะด
ะะพั ะฟัะธะผะตั Python-ัะฟะธัะบะฐ ั ะฒะฐัะธะฐะฝัะฐะผะธ ะฝะฐะทะฒะฐะฝะธะน ะดะปั ะบะฐัะตะณะพัะธะธ ัะตััะพัะฐะฝะฐ:

python
ะะพะฟะธัะพะฒะฐัั
restaurant_categories = [
    "Restaurant", "restaurant",
    "Restaraunt", "restoraunt",
    "Restorant", "restorant",
    "Cafe", "cafe", "Cafรฉ", "caf'e",
    "Bistro", "bistro",
    "Eatery", "eatery",
    "Diner", "diner",
    "Fast Food", "fast food",
    "Grill", "grill",
    "Pub", "pub"
]





ะั ัะบะฐะทะฐะปะธ:
ะฟะพัะตะผั ััะพั ะฒะฐัะธะฐะฝั 

bitmask = top_city_businesses.apply(lambda row: True if any([cat in row['categories'] for cat in restaurant_categories]) else False,
                                    axis=1)

ะัะดะฐะตั ะผะตะฝััะต ัััะพัะตะบ ัะตะผ ััะพั 

bitmask = top_city_businesses.apply(lambda row: True if 'restaurant' in row['categories'].lower() else False, axis=1)
ะ ะฒะฐัะตะผ ัะปััะฐะต ะฟัะพะฑะปะตะผะฐ ะทะฐะบะปััะฐะตััั ะฒ ัะฐะทะปะธัะธัั ะฒ ะปะพะณะธะบะต ะธั ัะตะฐะปะธะทะฐัะธะธ. ### ะะฐัะธะฐะฝั 1: ```python bitmask = top_city_businesses.apply(lambda row: True if any([cat in row['categories'] for cat in restaurant_categories]) else False, axis=1) ``` - ะะดะตัั ะฒั ะฟัะพะฒะตััะตัะต, ัะพะดะตัะถะฐััั ะปะธ ัะพัั ะฑั ะพะดะธะฝ ะธะท ะทะฝะฐัะตะฝะธะน ะฒ `row['categories']` (ะฟะตัะตะฑะพั ะฟะพ ะฒัะตะผ ะบะฐัะตะณะพัะธัะผ ะฒ ัะฟะธัะบะต `restaurant_categories`). - ะะดะฝะฐะบะพ, ะตัะปะธ ะฒะฐั ััะพะปะฑะตั `categories` ัะพะดะตัะถะธั ัััะพะบั, ะบะพัะพัะฐั ะฝะต ัะพะพัะฒะตัััะฒัะตั ััะพะน ะปะพะณะธะบะต (ะฝะฐะฟัะธะผะตั, ะตัะปะธ ะฒ ัััะพะบะต ัะพะดะตัะถะธััั ะปะธัะฝะธะน ะฟัะพะฑะตะป ะธะปะธ ะพัะธะฑะบะฐ ะฒ ัะตะณะธัััะต), ะฟัะพะฒะตัะบะฐ ะผะพะถะตั ะฝะต ััะฐะฑะพัะฐัั ัะฐะบ, ะบะฐะบ ะพะถะธะดะฐะตััั. - ะัะพะผะต ัะพะณะพ, ะตัะปะธ ะบะฐัะตะณะพัะธะธ ะฒ ะฒะฐัะตะผ `restaurent_categories` ะฝะต ัะพะพัะฒะตัััะฒััั ัะพัะฝัะผ ะดะฐะฝะฝัะผ ะฒ `categories`, ัะพ ะฝะธัะตะณะพ ะฝะต ัะพะฒะฟะฐะดะตั. ### ะะฐัะธะฐะฝั 2: ```python bitmask = top_city_businesses.apply(lambda row: True if 'restaurant' in row['categories'].lower() else False, axis=1) ``` - ะ ััะพะผ ะฒะฐัะธะฐะฝัะต ะฒั ะฟัะพััะพ ะฟัะธะฒะพะดะธัะต ัััะพะบั `row['categories']` ะบ ะฝะธะถะฝะตะผั ัะตะณะธัััั ะธ ะฟัะพะฒะตััะตัะต, ัะพะดะตัะถะธััั ะปะธ ัััะพะบะฐ `'restaurant'`, ััะพ ะฑะพะปะตะต ัะฝะธะฒะตััะฐะปัะฝะพ, ะฟะพัะบะพะปัะบั ััะพ ะฝะต ะทะฐะฒะธัะธั ะพั ะพะบะพะฝัะฐะฝะธะน, ะฟัะพะฑะตะปะพะฒ ะธะปะธ ัะตะณะธัััะฐ. - ะขะฐะบ ะบะฐะบ ะฒั ะธัะฟะพะปัะทัะตัะต `.lower()`, ััะพ ัะปัััะฐะตั ะฒะตัะพััะฝะพััั ะฝะฐัะพะถะดะตะฝะธั ัะพะฒะฟะฐะดะตะฝะธะน, ะฝะตะทะฐะฒะธัะธะผะพ ะพั ัะพะณะพ, ะฒ ะบะฐะบะพะผ ัะตะณะธัััะต ะทะฐะฟะธัะฐะฝะพ ัะปะพะฒะพ "Restaurant". ### ะะพัะตะผั ะฟะตัะฒัะน ะฒะฐัะธะฐะฝั ะฒัะดะฐะตั ะผะตะฝััะต ัััะพะบ: 1. ะ ัะปััะฐะต ั **ะฟะตัะฒัะผ ะฒะฐัะธะฐะฝัะพะผ** (ั ะฟะตัะตะฑะพัะพะผ ะบะฐัะตะณะพัะธะน) ะฒั ะธัะตัะต ะฟะตัะฒะพะต ัะพัะฝะพะต ัะพะฒะฟะฐะดะตะฝะธะต ััะตะดะธ ะฒัะตั ะบะฐัะตะณะพัะธะน ะฒ `restaurant_categories`. ะัะปะธ ะฒ ััะพะปะฑัะต `categories` ะฟัะธัััััะฒััั ะพะฟะตัะฐัะบะธ, ะดะพะฟะพะปะฝะธัะตะปัะฝัะต ะฟัะพะฑะตะปั ะธะปะธ ะทะฝะฐะบะธ, ัะพ ััะธ ัััะพะบะธ ะฝะต ะฟะพะฟะฐะดัั ะฒ ะฒัะฑะพัะบั. ะขะฐะบะพะน ะฟะพะดัะพะด ะฑัะดะตั **ัััะพะณะธะผ** ะธ ะฝะต ะฒัะตะณะดะฐ ะฑัะดะตั ัะฐะฑะพัะฐัั, ะตัะปะธ, ะฝะฐะฟัะธะผะตั, ัะปะพะฒะพ "restaurant" ะฒัััะตัะฐะตััั ะฒ ะดััะณะพะผ ะบะพะฝัะตะบััะต ะธะปะธ ั ะพัะธะฑะบะฐะผะธ. 2. ะะพ **ะฒัะพัะพะผ ะฒะฐัะธะฐะฝัะต** ะฒั ะฟัะธะฒะพะดะธัะต `row['categories']` ะบ ะฝะธะถะฝะตะผั ัะตะณะธัััั ะธ ะธัะตัะต ัััะพะบั `"restaurant"`. ะญัะพ ะฟัะพััะพะน ะธ ัััะตะบัะธะฒะฝัะน ัะฟะพัะพะฑ ะฟะพะธัะบะฐ **ะฟะพะดัััะพะบะธ** ะฒ ัััะพะบะต, ะบะพัะพััะน ะฑัะดะตั ัะฐะฑะพัะฐัั ะฒ ะฑะพะปััะธะฝััะฒะต ัะปััะฐะตะฒ, ะดะฐะถะต ะตัะปะธ ัะปะพะฒะพ ะฝะฐะฟะธัะฐะฝะพ ั ะพัะธะฑะบะฐะผะธ ะฒ ัะตะณะธัััะต. ### ะะตัะตะฝะธะต: ะัะปะธ ะฒะฐั ัะฟะธัะพะบ ะบะฐัะตะณะพัะธะน ัะพะดะตัะถะธั ะผะฝะพะถะตััะฒะพ ัะฐะทะปะธัะฝัั ะฒะฐัะธะฐะฝัะพะฒ ะฝะฐะฟะธัะฐะฝะธั, ะฐ ะฒั ัะพัะธัะต ะฟัะพะฒะตัััั ััะธ ะทะฐะฟะธัะธ ะฝะตัะตะณะธัััะพะฝะตะทะฐะฒะธัะธะผะพ, ะฒั ะผะพะถะตัะต ัะปัััะธัั ะฟะตัะฒัะน ะฒะฐัะธะฐะฝั ัะปะตะดัััะธะผ ะพะฑัะฐะทะพะผ: ```python bitmask = top_city_businesses.apply( lambda row: True if any([cat.lower() in row['categories'].lower() for cat in restaurant_categories]) else False, axis=1 ) ``` ะญัะพั ะบะพะด ััะฐะฒะฝะธะฒะฐะตั ะฒัะต ะฒะพะทะผะพะถะฝัะต ะฒะฐัะธะฐะฝัั ะบะฐัะตะณะพัะธะน ะฒ ัะฟะธัะบะต `restaurant_categories` ั ัะพะดะตัะถะธะผัะผ ะฒ ััะพะปะฑัะต `categories`, ะฟัะธะฒะตะดัะฝะฝัะผ ะบ ะฝะธะถะฝะตะผั ัะตะณะธัััั. ะญัะพ ะฟะพะฒััะธั ัะพัะฝะพััั ะธ ะฟะพะทะฒะพะปะธั ะธะทะฑะตะถะฐัั ะฟัะพะฑะปะตะผ ั ัะตะณะธัััะพะฒัะผะธ ะพัะปะธัะธัะผะธ. ะดะปั 23 ัะตะบัะฝะด
ะัะฝะพะฒะฝะพะต ัะฐะทะปะธัะธะต ะผะตะถะดั ะดะฒัะผั ะฒะฐัะธะฐะฝัะฐะผะธ ะทะฐะบะปััะฐะตััั ะฒ ัะพะผ, ะบะฐะบ ะธะผะตะฝะฝะพ ะฟัะพะธััะพะดะธั ะฟะพะธัะบ ะฟะพะดัััะพะบะธ ะฒ ััะพะปะฑัะต 'categories':

ะะฐัะธะฐะฝั ัะพ ัะฟะธัะบะพะผ ะธ any:

python
ะะพะฟะธัะพะฒะฐัั
bitmask = top_city_businesses.apply(
    lambda row: True if any([cat in row['categories'] for cat in restaurant_categories]) else False,
    axis=1
)
ะะดะตัั ะดะปั ะบะฐะถะดะพะน ัััะพะบะธ ะฟัะพะธััะพะดะธั ะฟัะพะฒะตัะบะฐ: ะดะปั ะบะฐะถะดะพะณะพ ัะปะตะผะตะฝัะฐ ะธะท ัะฟะธัะบะฐ restaurant_categories (ะฝะฐะฟัะธะผะตั, "Restaurant", "restoraunt", "cafe", ะธ ั.ะด.) ะฒัะฟะพะปะฝัะตััั ะฟัะพะฒะตัะบะฐ, ัะพะดะตัะถะธััั ะปะธ ะพะฝ ะฒ ะทะฝะฐัะตะฝะธะธ row['categories']. ะัะธ ััะพะผ ะฟะพะธัะบ ัะตะณะธัััะพะทะฐะฒะธัะธะผัะน โ ะตัะปะธ ะฒ ัััะพะบะต ะบะฐัะตะณะพัะธั ะทะฐะฟะธัะฐะฝะฐ ั ะดััะณะธะผ ัะตะณะธัััะพะผ ะธะปะธ ะธะฝัะผะธ ะฒะฐัะธะฐะฝัะฐะผะธ (ะฝะฐะฟัะธะผะตั, "Restaurants" ะธะปะธ "RESTAURANT"), ัะพ ะพะฝะธ ะผะพะณัั ะฝะต ัะพะฒะฟะฐััั ั ัะปะตะผะตะฝัะฐะผะธ ะธะท ัะฟะธัะบะฐ. ะขะฐะบะถะต ัะฟะธัะพะบ restaurant_categories ะผะพะถะตั ะฑััั ะฝะตะฟะพะปะฝัะผ ะธ ะฝะต ะพัะฒะฐััะฒะฐัั ะฒัะต ะฒะฐัะธะฐะฝัั ะฝะฐะฟะธัะฐะฝะธั.

ะะฐัะธะฐะฝั ั ะฒัะทะพะฒะพะผ .lower():

python
ะะพะฟะธัะพะฒะฐัั
bitmask = top_city_businesses.apply(
    lambda row: True if 'restaurant' in row['categories'].lower() else False,
    axis=1
)
ะะดะตัั ะทะฝะฐัะตะฝะธะต row['categories'] ะฟัะธะฒะพะดะธััั ะบ ะฝะธะถะฝะตะผั ัะตะณะธัััั, ะธ ะทะฐัะตะผ ะธัะตััั ะฟะพะดัััะพะบะฐ "restaurant". ะญัะพ ะดะตะปะฐะตั ะฟะพะธัะบ ัะตะณะธัััะพะฝะตะทะฐะฒะธัะธะผัะผ ะธ ะฟะพะทะฒะพะปัะตั ะพัะปะฐะฒะปะธะฒะฐัั ะฟัะฐะบัะธัะตัะบะธ ะปัะฑัะต ะฒะฐัะธะฐะฝัั (ะฝะฐะฟัะธะผะตั, "Restaurant", "restaurants", "RESTAURANT", ะธ ั.ะด.), ะฟัะธ ััะปะพะฒะธะธ ััะพ ัะปะพะฒะพ ัะพะดะตัะถะธั ะธะผะตะฝะฝะพ ะฟะพัะปะตะดะพะฒะฐัะตะปัะฝะพััั ัะธะผะฒะพะปะพะฒ "restaurant".

ะะพัะตะผั ะฟะตัะฒัะน ะฒะฐัะธะฐะฝั ะฒะพะทะฒัะฐัะฐะตั ะผะตะฝััะต ัััะพะบ:

ะะตะณะธัััะพะทะฐะฒะธัะธะผะพััั: ะัะปะธ ะฒ ััะพะปะฑัะต categories ะฒัััะตัะฐัััั ะฒะฐัะธะฐะฝัั ั ะดััะณะธะผ ัะตะณะธัััะพะผ (ะฝะฐะฟัะธะผะตั, "Restaurants" ะธะปะธ "RESTAURANT"), ัะพ ะพะฝะธ ะฝะต ะฑัะดัั ะฝะฐะนะดะตะฝั ะฒ ะฟะตัะฒะพะผ ะฒะฐัะธะฐะฝัะต, ะตัะปะธ ะฒะฐั ัะฟะธัะพะบ ะฝะต ัะพะดะตัะถะธั ััะธั ะฒะฐัะธะฐะฝัะพะฒ.
ะะณัะฐะฝะธัะตะฝะฝะพััั ัะฟะธัะบะฐ: ะะฐั ัะฟะธัะพะบ restaurant_categories ะผะพะถะตั ะฑััั ะฝะตะฟะพะปะฝัะผ, ัะพ ะตััั ะฝะต ะฒะบะปััะฐัั ะฒัะต ะฒะพะทะผะพะถะฝัะต ะฒะฐัะธะฐะฝัั ะฝะฐะฟะธัะฐะฝะธั ะธะปะธ ะดะฐะถะต ะพะบะพะฝัะฐะฝะธั (ะฝะฐะฟัะธะผะตั, ะฝะฐะปะธัะธะต "s" ะฝะฐ ะบะพะฝัะต, ะฐะฟะพัััะพัั, ะฟัะพะฑะตะปั ะธ ั.ะด.).
ะัะพะฒะตัะบะฐ ะฟะพะดัััะพะบะธ: ะะฐัะธะฐะฝั ั .lower() ะธัะตั ะฟัะพััะพ ะฝะฐะปะธัะธะต ะฟะพัะปะตะดะพะฒะฐัะตะปัะฝะพััะธ ัะธะผะฒะพะปะพะฒ "restaurant" ะฒ ะปัะฑะพะผ ะผะตััะต ัััะพะบะธ, ััะพ, ัะบะพัะตะต ะฒัะตะณะพ, ะพัะฒะฐััะฒะฐะตั ะฑะพะปััะต ัะปััะฐะตะฒ.
ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะฒัะพัะพะน ะฒะฐัะธะฐะฝั (ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ .lower()) ะฝะฐัะพะดะธั ะฑะพะปััะต ัััะพะบ, ะฟะพัะพะผั ััะพ ะพะฝ ะดะตะปะฐะตั ะฟะพะธัะบ ัะตะณะธัััะพะฝะตะทะฐะฒะธัะธะผัะผ ะธ ะผะตะฝะตะต ะถะตััะบะธะผ ะฟะพ ััะฐะฒะฝะตะฝะธั ั ะฟัะพะฒะตัะบะพะน ะฝะฐะปะธัะธั ะพะดะฝะพะณะพ ะธะท ะทะฐัะฐะฝะตะต ะทะฐะดะฐะฝะฝัั ะฒะฐัะธะฐะฝัะพะฒ ะฒ ัะฟะธัะบะต.






ะั ัะบะฐะทะฐะปะธ:
ะัะปะธ ั ัะฐะบ ะฝะฐะฟะธัั, ัะพ ะพะฝ ะฑัะดะตั ะฒัะต ัะฐะฒะฝะพ ะฒัะดะฐะฒะฐัั ะผะตะฝััะต ัััะพะบ, ัะตะผ ะฟะพะธัะบ ัะพะปัะบะพ ะพะดะฝะพะน ัััะพะบะธ 'restaurant', ัะพัั ะบะฐะทะฐะปะพัั ะฑั, ัะฟะธัะพะบ ัะฐััะธัะธะปัั

bitmask = top_city_businesses.apply(lambda row: True if any([cat in row['categories'].lower() for cat in restaurant_categories]) else False,
                                    axis=1)

ะะฐัััะถะดะฐะปะฐ ะดะปั 6 ัะตะบัะฝะด
ะัั ะพะฟัะธะผะฐะปัะฝัะน ะพัะฒะตั

ะกะตะนัะฐั ั ัะฐะทะฑะธัะฐััั ั ะทะฐะฟัะพัะพะผ ะฟะพะปัะทะพะฒะฐัะตะปั ะพ ััะฐะฒะฝะตะฝะธะธ ะดะฒัั ัััะพะบะฐั "resta" ะธ ะฐะฝะฐะปะธะทะธััั, ะบะฐะบ ััะพ ะฒะปะธัะตั ะฝะฐ ะบะพะปะธัะตััะฒะพ ะฒัะฒะพะดะธะผัั ัััะพะบ.

ะะฝะฐะปะธะทะธััั ะทะฐะฟัะพั

ะกะตะนัะฐั ั ะทะฐะดัะผัะฒะฐััั ะพ ััะฐะฒะฝะตะฝะธะธ ะทะฐะฟัะพัะพะฒ ะฟะพะปัะทะพะฒะฐัะตะปั ะธ ะดัะผะฐั ะพ ัะพะผ, ะบะฐะบ ะปัััะต ะฒัะตะณะพ ะพัะฒะตัะธัั, ััะธััะฒะฐั, ััะพ ะพะฝ ัะพัะตั ะฟะพะฝััั, ะบะฐะบ ัะฐะทะฝัะต ะทะฐะฟัะพัั ะฒะปะธััั ะฝะฐ ัะตะทัะปััะฐัั ะฟะพะธัะบะฐ.

ะะฐะทะผััะปัั ะฝะฐะด ะทะฐะฟัะพัะพะผ

ะะทััะฐั ะทะฐะฟัะพัั ะฟะพะปัะทะพะฒะฐัะตะปั, ััะพะฑั ะฟะพะฝััั ะฒะปะธัะฝะธะต ะฝะฐ ัะตะทัะปััะฐัั ะฟะพะธัะบะฐ. ะะฝัะตัะตัะฝะพ, ะบะฐะบะพะน ะฟััั ะฒัะฑัะฐัั ะดะปั ะพะฟัะธะผะฐะปัะฝะพะณะพ ะพัะฒะตัะฐ.

ะะทััะฐั ะทะฐะฟัะพั

ะกะตะนัะฐั ั ะฐะฝะฐะปะธะทะธััั ะทะฐะฟัะพั ะฟะพะปัะทะพะฒะฐัะตะปั ะธ ะดัะผะฐั ะพ ัะพะผ, ะบะฐะบ ัะปัััะธัั ัะตะทัะปััะฐัั ะฟะพะธัะบะฐ, ััะพะฑั ะดะฐัั ะฑะพะปะตะต ัะพัะฝัะน ะพัะฒะตั.

ะะทััะฐั ะฟัะตะดะฟะพััะตะฝะธั

ะะพะปัะทะพะฒะฐัะตะปั ัะพัะตั ะฟัะพะฐะฝะฐะปะธะทะธัะพะฒะฐัั ะฒัะฑะพั ัััะพะบะธ ะฒ ะบะพะฝัะตะบััะต ะดััะณะธั ัััะพะบะพะฒัั ะทะฐะฟัะพัะพะฒ. ะญัะพ ะฝะฐะฒะพะดะธั ะฝะฐ ะผััะปั, ััะพ ะบะพะฝัะตะบัั ะธะณัะฐะตั ะฒะฐะถะฝัั ัะพะปั.

ะะฐะทะผััะปัั ะพ ะทะฐะฟัะพัะต

ะะพะปัะทะพะฒะฐัะตะปั ะธะฝัะตัะตััะตััั ัะตะผ, ะบะฐะบ ะทะฐะฟัะพั ะฒะปะธัะตั ะฝะฐ ัะตะทัะปััะฐัั ะฟะพะธัะบะฐ, ะธ ะทะฐะดะฐะตััั ะฒะพะฟัะพัะพะผ, ะบัะฐัะบะพะฒัะตะผะตะฝะฝะพะต ะดะพะฑะฐะฒะปะตะฝะธะต ัััะพะบ ัะบะฐะถะตััั ะฝะฐ ะบะพะปะธัะตััะฒะต ะฒัะฒะพะดะธะผัั ัะตะทัะปััะฐัะพะฒ.

ะะฝะฐะปะธะท ะทะฐะฟัะพัะฐ

ะะพะปัะทะพะฒะฐัะตะปั ะทะฐะดะฐะตััั ะฒะพะฟัะพัะพะผ, ะบะฐะบ ะทะฐะฟัะพัั ะฒะปะธััั ะฝะฐ ัะตะทัะปััะฐัั ะฟะพะธัะบะฐ. ะะพะดัะผัะฒะฐั ะพ ัะพะผ, ััะพ ะทะฐะฟัะพัั ะผะพะณัั ะพััะปะตะถะธะฒะฐัั ะธะทะผะตะฝะตะฝะธั ะฒ ะดะฐะฝะฝัั, ะฒะบะปััะฐั ะบะพะฝัะตะบัั ะธ ัะฒัะทะฐะฝะฝัะต ัััะพะบะธ.

ะะพะดะฑะธัะฐั ะฒะฐัะธะฐะฝัั

ะฏ ะฟะพะดะฑะธัะฐั ะฒะฐัะธะฐะฝัั ะพัะฒะตัะพะฒ, ะบะพัะพััะต ัะพะพัะฒะตัััะฒััั ะทะฐะฟัะพัั ะฟะพะปัะทะพะฒะฐัะตะปั. ะะฐะทะผััะปัั ะพ ัะปัััะตะฝะธะธ ะธั ัะพัะฝะพััะธ ะธ ะฟะพะปะตะทะฝะพััะธ.

ะ ะฒะฐัะตะผ ัะปััะฐะต, ะฝะตัะผะพััั ะฝะฐ ัะพ ััะพ ัะฟะธัะพะบ restaurant_categories ัะฐััะธัะธะปัั, ัะตะทัะปััะฐั ะฟะพ-ะฟัะตะถะฝะตะผั ะผะพะถะตั ะฑััั ะผะตะฝััะต, ัะตะผ ะฒ ัะปััะฐะต ะฟะพะธัะบะฐ ัะพะปัะบะพ ะพะดะฝะพะณะพ ัะปะพะฒะฐ 'restaurant', ะฟะพ ะฝะตัะบะพะปัะบะธะผ ะฟัะธัะธะฝะฐะผ:

ะะตะณะธัััะพะฝะตะทะฐะฒะธัะธะผัะน ะฟะพะธัะบ ะฒ ัะฟะธัะบะต:

ะั ะธัะฟะพะปัะทัะตัะต row['categories'].lower(), ััะพ ะฟัะธะฒะพะดะธั ะฒะตัั ัะตะบัั ะฒ ััะพะปะฑัะต categories ะบ ะฝะธะถะฝะตะผั ัะตะณะธัััั. ะะดะฝะฐะบะพ ะฒะฝัััะธ ัะฟะธัะบะฐ restaurant_categories ะฒัะต ัะปะตะผะตะฝัั, ะฒะพะทะผะพะถะฝะพ, ัะพะดะตัะถะฐั ัะปะตะผะตะฝัั ะฒ ะฒะตััะฝะตะผ ัะตะณะธัััะต ะธะปะธ ะดะฐะถะต ั ัะฐะทะปะธัะธัะผะธ ะฒ ะฝะฐะฟะธัะฐะฝะธะธ, ะฝะฐะฟัะธะผะตั, "restaurant" ะฒ ัะฐะทะฝัั ะฒะฐัะธะฐัะธัั.
ะะพะณะดะฐ ะฒั ะฟัะพะฒะตััะตัะต any([cat in row['categories'].lower() for cat in restaurant_categories]), ััะพ ะพะทะฝะฐัะฐะตั, ััะพ ะบะฐะถะดะฐั ัััะพะบะฐ ะฒ ััะพะปะฑัะต categories ัะฝะฐัะฐะปะฐ ะฟัะธะฒะพะดะธััั ะฒ ะฝะธะถะฝะธะน ัะตะณะธััั, ะฐ ะทะฐัะตะผ ะฒัะฟะพะปะฝัะตััั ะฟะพะธัะบ ะบะฐะถะดะพะณะพ ะฒะฐัะธะฐะฝัะฐ ะบะฐัะตะณะพัะธะธ ะธะท ัะฟะธัะบะฐ. ะะดะฝะฐะบะพ ะตัะปะธ ะฒ ัััะพะบะต ัะพะดะตัะถะฐััั ะดะพะฟะพะปะฝะธัะตะปัะฝัะต ัะปะพะฒะฐ ะธะปะธ ัะธะผะฒะพะปั, ะบะพัะพััะต ะฝะต ะฒัะพะดัั ะฒ ะฒะฐั ัะฟะธัะพะบ, ัะพ ะพะฝะธ ะผะพะณัั ะฝะต ะฑััั ะฝะฐะนะดะตะฝั.
ะัะพะฑะปะตะผั ั ัะพัะฝะพัััั ะฟะพะดัััะพะบะธ:

ะัะพะฒะตัะบะฐ cat in row['categories'].lower() ะพะทะฝะฐัะฐะตั, ััะพ ะฟัะพะณัะฐะผะผะฐ ะฟัะพะฒะตััะตั, ะฟัะธัััััะฒัะตั ะปะธ ะปัะฑะพะน ะธะท ัะปะตะผะตะฝัะพะฒ ัะฟะธัะบะฐ restaurant_categories ะฒ ัััะพะบะต. ะญัะพ ัะฐะฑะพัะฐะตั, ะตัะปะธ ะบะฐัะตะณะพัะธั ะฝะฐะฟะธัะฐะฝะฐ ะฒ ะฝัะถะฝะพะผ ัะพัะผะฐัะต ะธ ัะพะดะตัะถะธั ะธะผะตะฝะฝะพ ัะปะพะฒะพ ะธะท ัะฟะธัะบะฐ, ะฝะพ ะผะพะถะตั ะฝะต ััะตััั ะดััะณะธะต ะฒะฐัะธะฐะฝัั (ะฝะฐะฟัะธะผะตั, ะตัะปะธ "restaurant" ะฒัััะตัะฐะตััั ั ะดะพะฟะพะปะฝะธัะตะปัะฝัะผะธ ัะธะผะฒะพะปะฐะผะธ ะธะปะธ ัะฐัััะผะธ ัะปะพะฒ).
ะัะพะฑะตะฝะฝะพััะธ ัััะพะบะธ categories:

ะ ััะพะปะฑัะต categories ะผะพะณัั ะฑััั ะทะฐะฟะธัะฐะฝั ะผะฝะพะณะพัะปะพะฒะฝัะต ะบะฐัะตะณะพัะธะธ ะธะปะธ ะผะฝะพะถะตััะฒะพ ะบะฐัะตะณะพัะธะน ัะตัะตะท ะทะฐะฟัััั, ะฝะฐะฟัะธะผะตั, restaurant, fast food, pizza. ะัะปะธ ะฒะฐัะฐ ะบะฐัะตะณะพัะธั ะทะฐะฟะธัะฐะฝะฐ ั ะฟัะพะฑะตะปะฐะผะธ ะธะปะธ ะฒ ะฒะธะดะต ะฝะตัะบะพะปัะบะธั ัะปะตะผะตะฝัะพะฒ, ัะพ ะฒะฐั ะฟะพะธัะบ ะฟะพ ัััะพะบะฐะผ ะผะพะถะตั ะฑััั ะฝะตัะพัะฝัะผ, ะฟะพัะบะพะปัะบั ะฒั ะธัะตัะต ัะพัะฝะพะต ะฒัะพะถะดะตะฝะธะต ะดะปั ะบะฐะถะดะพะณะพ ัะปะตะผะตะฝัะฐ ะฒ ัะฟะธัะบะต. ะะฐะฟัะธะผะตั, ะบะฐัะตะณะพัะธั "restaurants" ะฝะต ะฑัะดะตั ะฝะฐะนะดะตะฝะฐ, ะตัะปะธ ัะฟะธัะพะบ ัะพะดะตัะถะธั ัะพะปัะบะพ "restaurant".
ะงัะพ ะผะพะถะฝะพ ะฟะพะฟัะพะฑะพะฒะฐัั:
ะัะฟะพะปัะทะพะฒะฐัั ะผะตัะพะด str.contains ะดะปั ะฟะพะธัะบะฐ:
python
ะะพะฟะธัะพะฒะฐัั
# ะกะฝะฐัะฐะปะฐ ะฟัะธะฒะพะดะธะผ ะบะฐัะตะณะพัะธะธ ะบ ะฝะธะถะฝะตะผั ัะตะณะธัััั ะธ ะฟัะพะฒะตััะตะผ ะธั ั ะฟะพะผะพััั str.contains
bitmask = top_city_businesses['categories'].str.lower().apply(lambda x: any(cat in x for cat in restaurant_categories))

# ะะปะธ, ะตัะปะธ ะฝัะถะฝะพ ััะธััะฒะฐัั ะฟัะพะฑะตะปั ะธ ะทะฐะฟัััะต, ะผะพะถะตัะต ะธัะฟะพะปัะทะพะฒะฐัั str.contains ั ัะตะณัะปััะฝัะผ ะฒััะฐะถะตะฝะธะตะผ
bitmask = top_city_businesses['categories'].str.lower().str.contains('|'.join(restaurant_categories), regex=True)
ะ ััะพะผ ัะปััะฐะต, ะผะตัะพะด str.contains ะฑัะดะตั ะธัะบะฐัั ะฝะฐะปะธัะธะต ะบะฐะถะดะพะณะพ ัะปะตะผะตะฝัะฐ ะฒ ัััะพะบะต, ััะธััะฒะฐั ัะพัะฝะพะต ะฒัะพะถะดะตะฝะธะต, ะธ ัะฐะฑะพัะฐัั ั ัะฐะทะดะตะปัะฝะฝัะผะธ ะบะฐัะตะณะพัะธัะผะธ.
ะะตะณัะปััะฝัะต ะฒััะฐะถะตะฝะธั: ะัะปะธ ะบะฐัะตะณะพัะธะธ ะฒ ััะพะปะฑัะต categories ะผะพะณัั ะฑััั ัะฐะทะดะตะปะตะฝั ะฟัะพะฑะตะปะฐะผะธ ะธะปะธ ะทะฐะฟัััะผะธ, ะฒั ะผะพะถะตัะต ะธัะฟะพะปัะทะพะฒะฐัั ัะตะณัะปััะฝัะต ะฒััะฐะถะตะฝะธั, ััะพะฑั ััะตััั ะฒัะต ะฒะพะทะผะพะถะฝัะต ะฒะฐัะธะฐะฝัั ะฒัะพะถะดะตะฝะธั.
python
ะะพะฟะธัะพะฒะฐัั
import re

# ะัะธะผะตะฝัะตะผ ัะตะณัะปััะฝะพะต ะฒััะฐะถะตะฝะธะต ะดะปั ะฟะพะธัะบะฐ ะฒัะตั ะทะฝะฐัะตะฝะธะน ะธะท ัะฟะธัะบะฐ restaurant_categories
bitmask = top_city_businesses['categories'].apply(
    lambda x: bool(re.search(r'\b(' + '|'.join(restaurant_categories) + r')\b', str(x).lower()))
)
ะ ะดะฐะฝะฝะพะผ ัะปััะฐะต ะผั ะธัะฟะพะปัะทัะตะผ ัะตะณัะปััะฝัะต ะฒััะฐะถะตะฝะธั, ััะพะฑั ะฝะฐะนัะธ ะบะฐะถะดัั ะบะฐัะตะณะพัะธั ะบะฐะบ ะพัะดะตะปัะฝะพะต ัะปะพะฒะพ ะฒ ัััะพะบะฐั, ะฝะต ะฝะฐัััะฐั ะฟัะธ ััะพะผ ะบะพััะตะบัะฝะพััะธ ะฟะพะธัะบะฐ.

ะะฐะบะปััะตะฝะธะต:
ะ ะฒะฐัะตะผ ัะตะบััะตะผ ะฟะพะดัะพะดะต ะฒะพะทะผะพะถะฝะพ ะตััั ะฟัะพะฑะปะตะผะฐ ั ัะพัะฝะพัััั ะฟะพะดัััะพะบะธ ะธะปะธ ัะฐะทะดะตะปะตะฝะธะตะผ ะบะฐัะตะณะพัะธะน, ะตัะปะธ ะพะฝะธ ะฟะตัะตัะธัะปะตะฝั ะฒ ะพะดะฝะพะผ ััะพะปะฑัะต ัะตัะตะท ะทะฐะฟัััั ะธะปะธ ะฟัะพะฑะตะป.
ะะตะบะพะผะตะฝะดัะตััั ะธัะฟะพะปัะทะพะฒะฐัั ะผะตัะพะดั str.contains ะธะปะธ ัะตะณัะปััะฝัะต ะฒััะฐะถะตะฝะธั ะดะปั ัะพัะฝะพะณะพ ะฟะพะธัะบะฐ ะบะฐัะตะณะพัะธะน, ััะพะฑั ัะตะทัะปััะฐั ะฑัะป ะฑะพะปะตะต ัะพัะฝัะผ ะธ ะฒะพะทะฒัะฐัะฐะป ะฒัะต ัะพะพัะฒะตัััะฒัััะธะต ัััะพะบะธ.





ะั ัะบะฐะทะฐะปะธ:
ะฒัั,ั ะดะฐัะฝ, ั ัะฐะทะพะฑัะฐะปัั

ะะฐัััะถะดะฐะปะฐ ะดะปั ัะตะบัะฝะดะฐ
ะัะฒะตั ะบ ะฟะพะปัะทะพะฒะฐัะตะปั

ะัะฒะตั ะฟะพะปัะทะพะฒะฐัะตะปั

ะะต ะฟะตัะตะถะธะฒะฐะน, ััะพ ะฝะพัะผะฐะปัะฝะพ! ะัะพะณัะฐะผะผะธัะพะฒะฐะฝะธะต ะธะฝะพะณะดะฐ ััะตะฑัะตั ะฒัะตะผะตะฝะธ ะธ ะฒะฝะธะผะฐัะตะปัะฝะพััะธ, ะธ ัั ัะดะตะปะฐะป ะพัะปะธัะฝัะน ัะฐะณ, ัะฐะทะพะฑัะฐะฒัะธัั. ะัะปะธ ััะพ-ัะพ ะฑัะดะตั ะฝะตะฟะพะฝััะฝะพ ะธะปะธ ะฟะพัะฒัััั ะฝะพะฒัะต ะฒะพะฟัะพัั โ ะฒัะตะณะดะฐ ัะฐะด ะฟะพะผะพัั! ๐






ะั ัะบะฐะทะฐะปะธ:
ะบะฐะบ ะฝะฐะนัะธ ัััะพัะบั ะฟะพ ะบะปััั ะฑะธะทะฝะตั_ะฐะนะดะธ ะฒ ะดะฐัะฐะน ััะตะนะผะต 

ะะฐัััะถะดะฐะปะฐ ะดะปั ะฟะฐัะฐ ัะตะบัะฝะด
ะัั ะบะปัั

ะะฐะทะผััะปัั ะพ ะทะฐะฟัะพัะต ะฟะพะปัะทะพะฒะฐัะตะปั, ั ะดัะผะฐั ะพ ัะพะผ, ะบะฐะบ ะฝะฐะนัะธ ัััะพะบั ะฟะพ ะบะปััั ะฑะธะทะฝะตั_ะฐะนะดะธ ะฒ ะดะฐัะฐััะตะนะผะต, ะธัะฟะพะปัะทัั pandas.

ะัั ะพะฟัะธะผะฐะปัะฝะพะต ัะตัะตะฝะธะต

ะฏ ะฒ ัะฐะทะดัะผััั ะพ ัะพะผ, ะบะฐะบ ะฝะฐะนัะธ ัััะพะบั ะฟะพ ะบะปััั ะฑะธะทะฝะตั_ะฐะนะดะธ ะฒ ะดะฐัะฐััะตะนะผะต, ะธัะฟะพะปัะทัั ะผะตัะพะด loc ะฒ pandas.

ะัั ัััะพะบั

ะฏ ัะฐะทะฑะธัะฐััั, ะบะฐะบ ะฝะฐะนัะธ ัััะพะบั ะฟะพ ะบะปััั ะฑะธะทะฝะตั_ะฐะนะดะธ ะฒ ะดะฐัะฐััะตะนะผะต, ะธัะฟะพะปัะทัั ะผะตัะพะด loc ะฒ pandas.

ะงัะพะฑั ะฝะฐะนัะธ ัััะพะบั ะฟะพ ะทะฝะฐัะตะฝะธั ะฒ ััะพะปะฑัะต, ะฝะฐะฟัะธะผะตั, ะฟะพ ะทะฝะฐัะตะฝะธั ะฒ ััะพะปะฑัะต business_id, ะฒั ะผะพะถะตัะต ะธัะฟะพะปัะทะพะฒะฐัั ะผะตัะพะด loc ะฒ pandas. ะะพั ะบะฐะบ ััะพ ัะดะตะปะฐัั:

ะัะธะผะตั:
python
ะะพะฟะธัะพะฒะฐัั
# ะัะตะดะฟะพะปะพะถะธะผ, ั ะฒะฐั ะตััั DataFrame 'df' ะธ ะฒั ัะพัะธัะต ะฝะฐะนัะธ ัััะพะบั ะฟะพ ะทะฝะฐัะตะฝะธั 'business_id'

business_id_value = 123  # ะัะธะผะตั ะทะฝะฐัะตะฝะธั ะฑะธะทะฝะตั-ะธะดะตะฝัะธัะธะบะฐัะพัะฐ

# ะะฐัะพะดะธะผ ัััะพะบั, ะณะดะต 'business_id' ัะฐะฒะตะฝ 'business_id_value'
row = df.loc[df['business_id'] == business_id_value]

print(row)
ะะพััะฝะตะฝะธะต:
df['business_id'] == business_id_value ัะพะทะดะฐะตั ะฑัะปะตะฒั ะผะฐัะบั, ะบะพัะพัะฐั ะฒะพะทะฒัะฐัะฐะตั True ะดะปั ัััะพะบ, ะณะดะต ะทะฝะฐัะตะฝะธะต ะฒ ััะพะปะฑัะต business_id ัะพะฒะฟะฐะดะฐะตั ั business_id_value.
df.loc[...] ะธัะฟะพะปัะทัะตััั ะดะปั ะฒัะฑะพัะฐ ัััะพะบ, ะบะพัะพััะต ัะพะพัะฒะตัััะฒััั ะดะฐะฝะฝะพะน ะผะฐัะบะต.
ะัะปะธ ะฒะฐะผ ะฝัะถะฝะพ ะฟะพะปััะธัั ัะพะปัะบะพ ะพะดะฝะพ ะทะฝะฐัะตะฝะธะต ะธะปะธ ะฝะตัะบะพะปัะบะพ ะทะฝะฐัะตะฝะธะน ะธะท ัััะพะบะธ, ะฒั ะผะพะถะตัะต ัะดะตะปะฐัั ัะฐะบ:
ะงัะพะฑั ะฟะพะปััะธัั ะพะดะฝะพ ะทะฝะฐัะตะฝะธะต, ะฝะฐะฟัะธะผะตั, ะดะปั ััะพะปะฑัะฐ name:
python
ะะพะฟะธัะพะฒะฐัั
name_value = df.loc[df['business_id'] == business_id_value, 'name'].iloc[0]
print(name_value)
ะัะปะธ ัะฐะบะธั ัััะพะบ ะฝะตัะบะพะปัะบะพ, iloc[0] ะฒัะฑะตัะตั ะฟะตัะฒัั ัััะพะบั ะธะท ัะตะทัะปััะฐัะฐ.
ะญัะพั ะฟะพะดัะพะด ะฟะพะผะพะณะฐะตั ัััะตะบัะธะฒะฝะพ ะธัะบะฐัั ะธ ะธะทะฒะปะตะบะฐัั ะดะฐะฝะฝัะต ะฟะพ ะบะพะฝะบัะตัะฝะพะผั ะบะปััั ะฒ DataFrame.






ะั ัะบะฐะทะฐะปะธ:
ะะฐะบ ะฒ pd ะพะฑัะฐัะธัััั ะบ ััะพะปะฑัั, ะฟะพ ะบะพัะพัะพะผั ะธะดะตั ะณััะฟะฟะธัะพะฒะบะฐ? ะะพะณะดะฐ ั ะฟะธัั df.columns, ะตะณะพ ะฝะตั, ะฐ ะบะพะณะดะฐ ะฒัะฒะถั ัะฐะฑะปะธัั, ะพะฝ ะตััั 

ะะฐัััะถะดะฐะปะฐ ะดะปั 6 ัะตะบัะฝะด
ะััะฐััั ะฟะพะฝััั, ะบะฐะบ ะพะฑัะฐัะธัััั ะบ ััะพะปะฑัั, ะฟัะธ ะณััะฟะฟะธัะพะฒะบะต ะบะพัะพัะพะณะพ ะพะฝ ะฝะต ะฟะพัะฒะปัะตััั ะฒ df.columns.

ะะทััะฐั ะทะฐะฟัะพั ะฟะพะปัะทะพะฒะฐัะตะปั: ะพะฑัะฐัะฐััั ะบ ััะพะปะฑัั, ะฟะพ ะบะพัะพัะพะผั ะธะดะตั ะณััะฟะฟะธัะพะฒะบะฐ, ะฒ pandas, ัะฐะบ ะบะฐะบ ะพะฝ ะฝะต ะฟะพัะฒะปัะตััั ะฒ df.columns.

ะััะฐััั ะฟะพะฝััั, ะบะฐะบ ะพะฑัะฐัะธัััั ะบ ััะพะปะฑัั, ะฟะพ ะบะพัะพัะพะผั ะธะดะตั ะณััะฟะฟะธัะพะฒะบะฐ ะฒ pandas, ะตัะปะธ ะพะฝ ะฝะต ะฟะพัะฒะปัะตััั ะฒ df.columns.

ะััะฐััั ะฟะพะฝััั, ะบะฐะบ ะพะฑัะฐัะธัััั ะบ ััะพะปะฑัั, ะฟะพ ะบะพัะพัะพะผั ะธะดะตั ะณััะฟะฟะธัะพะฒะบะฐ ะฒ pandas, ะตัะปะธ ะพะฝ ะฝะต ะฟะพัะฒะปัะตััั ะฒ df.columns.

ะััะฐััั ะฟะพะฝััั, ะบะฐะบ ะฝะฐะนัะธ ััะพะปะฑะตั, ะธัะฟะพะปัะทัะตะผัะน ะดะปั ะณััะฟะฟะธัะพะฒะบะธ ะฒ pandas, ะตัะปะธ ะตะณะพ ะฝะตะดะพััะฐัะพัะฝะพ ะฒ df.columns.

ะัั ัะฟะพัะพะฑ ะฝะฐะนัะธ ััะพะปะฑะตั, ะธัะฟะพะปัะทัะตะผัะน ะดะปั ะณััะฟะฟะธัะพะฒะบะธ ะฒ pandas, ะตัะปะธ ะพะฝ ะฝะต ะพัะพะฑัะฐะถะฐะตััั ะฒ df.columns.

ะัั ััะพะปะฑะตั ะดะปั ะณััะฟะฟะธัะพะฒะบะธ ะฒ pandas, ะฟะพัะพะผั ััะพ ะพะฝ ะฝะต ะพัะพะฑัะฐะถะฐะตััั ะฒ df.columns.

ะัั ััะพะปะฑะตั ะดะปั ะณััะฟะฟะธัะพะฒะบะธ ะฒ pandas, ัะฐะบ ะบะฐะบ ะพะฝ ะฝะต ะพัะพะฑัะฐะถะฐะตััั ะฒ df.columns. ะญัะพ ะทะฐััะฐะฒะปัะตั ะทะฐะดัะผะฐัััั ะพ ะฒะพะทะผะพะถะฝัั ะฒะฐัะธะฐะฝัะฐั.

ะะพะณะดะฐ ะฒั ะฒัะฟะพะปะฝัะตัะต ะณััะฟะฟะธัะพะฒะบั ะฒ pandas ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ groupby(), ััะพะปะฑะตั, ะฟะพ ะบะพัะพัะพะผั ะฟัะพะธะทะฒะพะดะธััั ะณััะฟะฟะธัะพะฒะบะฐ, ััะฐะฝะพะฒะธััั ะธะฝะดะตะบัะพะผ (ะตัะปะธ ะฒั ัะฒะฝะพ ะฝะต ัะฑัะฐััะฒะฐะตัะต ะธะฝะดะตะบั). ะญัะพ ะทะฝะฐัะธั, ััะพ ะพะฝ ะฑะพะปััะต ะฝะต ัะฒะปัะตััั ะพะฑััะฝัะผ ััะพะปะฑัะพะผ ะฒ DataFrame, ะธ ะตะณะพ ะผะพะถะฝะพ ะฝะฐะนัะธ ะบะฐะบ ัะฐััั ะธะฝะดะตะบัะฐ.

ะัะปะธ ะฒั ัะพัะธัะต ะพะฑัะฐัะธัััั ะบ ััะพะปะฑัั, ะฟะพ ะบะพัะพัะพะผั ะฟัะพะธะทะฒะพะดะธััั ะณััะฟะฟะธัะพะฒะบะฐ, ะธ ะพะฝ ััะฐะป ะธะฝะดะตะบัะพะผ, ะฒั ะผะพะถะตัะต ะธัะฟะพะปัะทะพะฒะฐัั ะฐััะธะฑัั index ะดะปั ะดะพัััะฟะฐ ะบ ะตะณะพ ะทะฝะฐัะตะฝะธัะผ.

ะัะธะผะตั:
python
ะะพะฟะธัะพะฒะฐัั
import pandas as pd

# ะัะธะผะตั DataFrame
data = {
    'city': ['New York', 'New York', 'Los Angeles', 'Los Angeles', 'Chicago'],
    'business': ['A', 'B', 'A', 'B', 'A'],
    'rating': [5, 4, 3, 4, 2]
}

df = pd.DataFrame(data)

# ะััะฟะฟะธัะพะฒะบะฐ ะฟะพ ะณะพัะพะดั
grouped = df.groupby('city').agg({'rating': 'mean'})

# ะัะฒะพะดะธะผ ัะตะทัะปััะฐั ะณััะฟะฟะธัะพะฒะบะธ
print(grouped)

# ะงัะพะฑั ะพะฑัะฐัะธัััั ะบ ะธะฝะดะตะบัั (ะณะดะต ะฝะฐัะพะดะธััั 'city'), ะธัะฟะพะปัะทัะนัะต .index
print(grouped.index)
ะะตะทัะปััะฐั:
pgsql
ะะพะฟะธัะพะฒะฐัั
               rating
city                 
Chicago           2.0
Los Angeles       3.5
New York          4.5

Index(['Chicago', 'Los Angeles', 'New York'], dtype='object', name='city')
ะะฑัััะฝะตะฝะธะต:
ะะพะณะดะฐ ะฒั ะฒัะฟะพะปะฝัะตัะต ะณััะฟะฟะธัะพะฒะบั ั ะฟะพะผะพััั groupby('city'), ััะพะปะฑะตั 'city' ััะฐะฝะพะฒะธััั ะธะฝะดะตะบัะพะผ ะฒ ัะตะทัะปััะธััััะตะผ DataFrame grouped.
ะงัะพะฑั ะฟะพะปััะธัั ะดะพัััะฟ ะบ ะทะฝะฐัะตะฝะธัะผ ะธะฝะดะตะบัะฐ (ะฟะพ ะบะพัะพัะพะผั ัะปะฐ ะณััะฟะฟะธัะพะฒะบะฐ), ะธัะฟะพะปัะทัะนัะต grouped.index.
ะัะปะธ ะฒะฐะผ ะฝัะถะฝะพ ะฟัะตะพะฑัะฐะทะพะฒะฐัั ะธะฝะดะตะบั ะพะฑัะฐัะฝะพ ะฒ ััะพะปะฑะตั, ะธัะฟะพะปัะทัะนัะต reset_index():
python
ะะพะฟะธัะพะฒะฐัั
grouped_reset = grouped.reset_index()
print(grouped_reset)
ะขะตะฟะตัั ััะพะปะฑะตั 'city' ัะฝะพะฒะฐ ะฑัะดะตั ะพะฑััะฝัะผ ััะพะปะฑัะพะผ, ะฐ ะฝะต ะธะฝะดะตะบัะพะผ.

ะะฐะถะฝัะน ะผะพะผะตะฝั:
ะะพะณะดะฐ ะฒั ะณััะฟะฟะธััะตัะต ะฟะพ ััะพะปะฑัั, pandas ะฟะพ ัะผะพะปัะฐะฝะธั ััะฐะฒะธั ััะพั ััะพะปะฑะตั ะฒ ะธะฝะดะตะบั, ััะพ ะพะฑัััะฝัะตั, ะฟะพัะตะผั ะตะณะพ ะฝะตั ะฒ df.columns ะฟะพัะปะต ะณััะฟะฟะธัะพะฒะบะธ.






ะั ัะบะฐะทะฐะปะธ:
ะฝั ะฒะพั ะบะฐะบ ะผะฝะต ะฟะพะปััะธัั ะทะฝะฐัะตะฝะธะต ัะตะนัะธะฝะณะฐ, ัะพะพัะฒะตัััะฒัััะตะต, ัะบะฐะถะตะผ, ัะธะบะฐะณะพ? 

ะะฐัััะถะดะฐะปะฐ ะดะปั ะฝะตัะบะพะปัะบะพ ัะตะบัะฝะด
ะะฟัะตะดะตะปัั ัะตะนัะธะฝะณ

ะกะตะนัะฐั ั ัะผะพััั ะฝะฐ ัะตะนัะธะฝะณ, ะบะพัะพััะน ะฑั ัะพะพัะฒะตัััะฒะพะฒะฐะป ะงะธะบะฐะณะพ, ะธ ะธัั ะปัััะธะน ัะฟะพัะพะฑ ะพัะฒะตัะฐ ะฝะฐ ััะพั ะทะฐะฟัะพั.

ะัั ะฟะพะดัะพะด

ะฏ ะดัะผะฐั ะพ ะปัััะตะผ ัะฟะพัะพะฑะต ะฟัะตะดะพััะฐะฒะปะตะฝะธั ะทะฝะฐัะตะฝะธั ัะตะนัะธะฝะณะฐ, ัะพะพัะฒะตัััะฒัััะตะณะพ ะทะฐะฟัะพัั ะพ ะงะธะบะฐะณะพ.

ะัั ะฟะพะดัะพะด

ะฏ ัะฐะทะผััะปัั ะพ ัะฐะผะพะผ ัััะตะบัะธะฒะฝะพะผ ัะฟะพัะพะฑะต ะฟัะตะดะพััะฐะฒะธัั ัะตะนัะธะฝะณ, ััะธััะฒะฐั ัะฐัะฐะบัะตั ะทะฐะฟัะพัะฐ ะพ ะงะธะบะฐะณะพ.

ะัั ัะพัะผะฐั

ะฏ ัะฐะทะฑะธัะฐััั ะฒ ะปัััะตะผ ัะพัะผะฐัะต ะดะปั ะฟัะตะดะพััะฐะฒะปะตะฝะธั ัะตะนัะธะฝะณะฐ, ัะฟัะฐัะธะฒะฐั, ะบะฐะบ ััะพ ัะดะตะปะฐัั ะดะปั ะงะธะบะฐะณะพ.

ะัั ะพะฟัะธะผะฐะปัะฝัะน ะพัะฒะตั

ะงะตััะฝะพ ะณะพะฒะพัั, ั ะฟัะพะฒะตััั, ะบะฐะบ ะฟัะฐะฒะธะปัะฝะพ ะพัะฒะตัะธัั ะฝะฐ ะทะฐะฟัะพั ะพ ัะตะนัะธะฝะณะต ะดะปั ะงะธะบะฐะณะพ, ััะพะฑั ััะพ ะฑัะปะพ ัััะตะบัะธะฒะฝะพ ะธ ะฐะดะตะบะฒะฐัะฝะพ.

ะัั ะฟะพะดัะพะด

ะะฐะทะผััะปัั ะพ ัะพะผ, ะบะฐะบ ะฟัะฐะฒะธะปัะฝะพ ะพัะฒะตัะธัั ะฝะฐ ะทะฐะฟัะพั ะพ ัะตะนัะธะฝะณะต, ััะธััะฒะฐั, ััะพ ัะตัั ะธะดะตั ะพ ะงะธะบะฐะณะพ.

ะะพะณะดะฐ ะฒั ะฒัะฟะพะปะฝัะตัะต ะณััะฟะฟะธัะพะฒะบั ะธ ััะพะปะฑะตั, ะฟะพ ะบะพัะพัะพะผั ะณััะฟะฟะธััะตััั DataFrame, ััะฐะฝะพะฒะธััั ะธะฝะดะตะบัะพะผ, ะฒั ะผะพะถะตัะต ะฟะพะปััะธัั ะทะฝะฐัะตะฝะธั, ัะพะพัะฒะตัััะฒัััะธะต ะพะฟัะตะดะตะปัะฝะฝะพะผั ะธะฝะดะตะบัั (ะฝะฐะฟัะธะผะตั, ะดะปั ะณะพัะพะดะฐ "Chicago"), ะธัะฟะพะปัะทัั loc.

ะะพั ะฟัะธะผะตั, ะบะฐะบ ััะพ ะผะพะถะฝะพ ัะดะตะปะฐัั:

ะัะธะผะตั:
python
ะะพะฟะธัะพะฒะฐัั
import pandas as pd

# ะัะธะผะตั DataFrame
data = {
    'city': ['New York', 'New York', 'Los Angeles', 'Los Angeles', 'Chicago'],
    'business': ['A', 'B', 'A', 'B', 'A'],
    'rating': [5, 4, 3, 4, 2]
}

df = pd.DataFrame(data)

# ะััะฟะฟะธััะตะผ ะฟะพ ะณะพัะพะดั ะธ ะฒััะธัะปัะตะผ ััะตะดะฝะธะน ัะตะนัะธะฝะณ
grouped = df.groupby('city').agg({'rating': 'mean'})

# ะะพะปััะฐะตะผ ััะตะดะฝะธะน ัะตะนัะธะฝะณ ะดะปั ะงะธะบะฐะณะพ
chicago_rating = grouped.loc['Chicago', 'rating']
print(chicago_rating)
ะะพััะฝะตะฝะธะต:
grouped โ ััะพ DataFrame ะฟะพัะปะต ะณััะฟะฟะธัะพะฒะบะธ, ะณะดะต city ััะฐะป ะธะฝะดะตะบัะพะผ.
ะะปั ัะพะณะพ ััะพะฑั ะฟะพะปััะธัั ะทะฝะฐัะตะฝะธะต ััะตะดะฝะตะณะพ ัะตะนัะธะฝะณะฐ ะดะปั ะณะพัะพะดะฐ "Chicago", ะผั ะธัะฟะพะปัะทัะตะผ loc: grouped.loc['Chicago', 'rating']. ะญัะพ ะฒะพะทะฒัะฐัะฐะตั ะทะฝะฐัะตะฝะธะต ะฒ ัััะพะบะต ั ะธะฝะดะตะบัะพะผ "Chicago" ะธ ััะพะปะฑัะต 'rating'.
ะะตะทัะปััะฐั:
ะะพะฟะธัะพะฒะฐัั
2.0
ะะฐะถะฝะพะต ะทะฐะผะตัะฐะฝะธะต:
ะัะปะธ ะธะฝะดะตะบัั (ะฒ ะดะฐะฝะฝะพะผ ัะปััะฐะต ะณะพัะพะดะฐ) ะธะผะตัั ะฟัะพะฑะตะปั ะธะปะธ ะดััะณะธะต ะฝะตะพะฑััะฝัะต ัะธะผะฒะพะปั, ะฒะฐะผ ะฝัะถะฝะพ ะฑัะดะตั ัะพัะฝะพ ัะบะฐะทะฐัั ะฟัะฐะฒะธะปัะฝะพะต ะทะฝะฐัะตะฝะธะต ะฒ loc ะธะปะธ ะธัะฟะพะปัะทะพะฒะฐัั ะผะตัะพะด reset_index(), ััะพะฑั ะฒะตัะฝััั ะธะฝะดะตะบั ะฒ ะฒะธะดะต ะพะฑััะฝะพะณะพ ััะพะปะฑัะฐ.

python
ะะพะฟะธัะพะฒะฐัั
grouped_reset = grouped.reset_index()
chicago_rating = grouped_reset.loc[grouped_reset['city'] == 'Chicago', 'rating']
ะญัะพั ะฟะพะดัะพะด ัะฐะบะถะต ะฟะพะทะฒะพะปะธั ะธะทะฒะปะตัั ะทะฝะฐัะตะฝะธั ะฟะพ ะพะฟัะตะดะตะปัะฝะฝะพะผั ััะปะพะฒะธั.






ะั ัะบะฐะทะฐะปะธ:
top_city_restaurant = top_city_restaurant.merge(top_city_restaurant, best_city_reviews_expanded, on='business_id')

ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

ะงัะพ ะฝะต ัะฐะบ

ะัะธะฑะบะฐ ะฒะพะทะฝะธะบะฐะตั, ะฟะพัะพะผั ััะพ ะฒ ะฒััะฐะถะตะฝะธะธ `top_city_restaurant.merge(top_city_restaurant, best_city_reviews_expanded, on='business_id')` ะฒั ัะปััะฐะนะฝะพ ัะบะฐะทะฐะปะธ ัะฐะผ DataFrame `top_city_restaurant` ะดะฒะฐะถะดั, ััะพ ะฟัะธะฒะพะดะธั ะบ ะฝะตะบะพััะตะบัะฝะพะผั ะฒัะทะพะฒั ะผะตัะพะดะฐ **`merge`**. ะัะฐะฒะธะปัะฝะพะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ะผะตัะพะดะฐ **`merge`** ะฟัะตะดะฟะพะปะฐะณะฐะตั, ััะพ ะฒั ัะพัะธัะต ะพะฑัะตะดะธะฝะธัั ะดะฒะฐ ัะฐะทะปะธัะฝัั DataFrame ะฟะพ ะพะฑัะตะผั ััะพะปะฑัั (ะฒ ะดะฐะฝะฝะพะผ ัะปััะฐะต, ะฟะพ ััะพะปะฑัั `'business_id'`). ### ะงัะพ ะฝะต ัะฐะบ: ะั ัะบะฐะทะฐะปะธ `top_city_restaurant` ะดะฒะฐะถะดั: ัะฝะฐัะฐะปะฐ ะบะฐะบ ะฟะตัะฒัะน DataFrame, ะฟะพัะพะผ ะบะฐะบ ะฒัะพัะพะน, ััะพ ะฒัะทัะฒะฐะตั ััั ะพัะธะฑะบั. ะขะฐะบะถะต, ะฒั ะฟะตัะตะดะฐะปะธ ะดะฒะฐ DataFrame ะฝะต ะฒ ะฟัะฐะฒะธะปัะฝะพะผ ะฟะพััะดะบะต ะฒ ะผะตัะพะด **`merge()`**. ### ะะฐะบ ะธัะฟัะฐะฒะธัั: ะัะถะฝะพ ะฟัะฐะฒะธะปัะฝะพ ัะบะฐะทะฐัั ะดะฒะฐ ัะฐะทะฝัั DataFrame ะดะปั ะพะฑัะตะดะธะฝะตะฝะธั. ะะฐะฟัะธะผะตั, ะตัะปะธ ะฒั ัะพัะธัะต ะพะฑัะตะดะธะฝะธัั `top_city_restaurant` ะธ `best_city_reviews_expanded`, ะฟัะฐะฒะธะปัะฝะพ ะฑัะดะตั ัะฐะบ: ```python top_city_restaurant = top_city_restaurant.merge(best_city_reviews_expanded, on='business_id') ``` ### ะะพััะฝะตะฝะธะต: 1. **`top_city_restaurant.merge(...)`**: ะะดะตัั `top_city_restaurant` โ ััะพ DataFrame, ั ะบะพัะพััะผ ะฒั ัะพัะธัะต ะฒัะฟะพะปะฝะธัั ะพะฑัะตะดะธะฝะตะฝะธะต. 2. **`best_city_reviews_expanded`**: ะญัะพ ะฒัะพัะพะน DataFrame, ั ะบะพัะพััะผ ะฒั ัะพัะธัะต ะพะฑัะตะดะธะฝะธัั `top_city_restaurant`. 3. **`on='business_id'`**: ะะฟะตัะฐัะธั ัะปะธัะฝะธั ะฟัะพะธะทะฒะพะดะธััั ะฟะพ ััะพะปะฑัั ั ะธะผะตะฝะตะผ `'business_id'`, ะบะพัะพััะน ะดะพะปะถะตะฝ ะฟัะธัััััะฒะพะฒะฐัั ะฒ ะพะฑะพะธั DataFrame. ### ะะตะทัะผะต: ะัะฟะพะปัะทัะนัะต ะดะฒะฐ ัะฐะทะฝัั DataFrame ะฒ ะผะตัะพะดะต **`merge`**, ััะพะฑั ะธะทะฑะตะถะฐัั ะพัะธะฑะบะธ. ะดะปั 10 ัะตะบัะฝะด
ะัะธะฑะบะฐ ะฒะพะทะฝะธะบะฐะตั ะธะท-ะทะฐ ะฝะตะฒะตัะฝะพะณะพ ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะผะตัะพะดะฐ merge. ะะตัะพะด merge ะพะถะธะดะฐะตั, ััะพ ะฟะตัะฒัะผ ะฐัะณัะผะตะฝัะพะผ (ะธะปะธ ะฐัะณัะผะตะฝัะพะผ right) ะฑัะดะตั ะฟะตัะตะดะฐะฝ ะพะดะธะฝ DataFrame, ั ะบะพัะพััะผ ะฝัะถะฝะพ ะพะฑัะตะดะธะฝะธัััั, ะฐ ะฝะต ะดะฒะฐ. ะ ะฒะฐัะตะผ ะฒัะทะพะฒะต:

python
ะะพะฟะธัะพะฒะฐัั
top_city_restaurant = top_city_restaurant.merge(top_city_restaurant, best_city_reviews_expanded, on='business_id')
ะฒั ะฟะตัะตะดะฐััะต ะดะฒะฐ DataFrame โ ัะฝะฐัะฐะปะฐ top_city_restaurant, ะฐ ะทะฐัะตะผ best_city_reviews_expanded. ะญัะพ ะฒัะทัะฒะฐะตั ะฝะตะพะดะฝะพะทะฝะฐัะฝะพััั, ะฟะพัะบะพะปัะบั pandas ะฝะต ะทะฝะฐะตั, ะบะฐะบะพะน ะธะท ะฝะธั ะธัะฟะพะปัะทะพะฒะฐัั ะดะปั ะพะฑัะตะดะธะฝะตะฝะธั.

ะงัะพะฑั ะธัะฟัะฐะฒะธัั ะพัะธะฑะบั, ะฝะตะพะฑัะพะดะธะผะพ ะพะฑัะตะดะธะฝััั ะดะฒะฐ DataFrame, ะฟะตัะตะดะฐะฒะฐั ะธั ะบะพััะตะบัะฝะพ. ะะฐะฟัะธะผะตั, ะตัะปะธ ะฒั ัะพัะธัะต ะพะฑัะตะดะธะฝะธัั DataFrame top_city_restaurant ั best_city_reviews_expanded ะฟะพ ััะพะปะฑัั business_id, ะฟัะฐะฒะธะปัะฝัะน ะฒัะทะพะฒ ะฑัะดะตั ัะฐะบะธะผ:

python
ะะพะฟะธัะพะฒะฐัั
top_city_restaurant = top_city_restaurant.merge(best_city_reviews_expanded, on='business_id')
ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ะฒั ะพะฑัะตะดะธะฝัะตัะต DataFrame top_city_restaurant ั DataFrame best_city_reviews_expanded, ะธัะฟะพะปัะทัั ััะพะปะฑะตั business_id ะฒ ะบะฐัะตััะฒะต ะบะปััะฐ.






ะั ัะบะฐะทะฐะปะธ:
ะ ัะฐะฑะปะธัะต ัะพัะฝะพ ะตััั ัะฐะบะธะต ััะพะปะฑัั. 
top_city_restaurant['name', 'avg_rating', 'reviews_count', 'latitude', 'longitude', 'category']

ะขะฐะบ ะฒ ัะตะผ ะถะต ะฟัะพะฑะปะตะผะฐ? 
ะัะพะฑะปะตะผะฐ ะทะฐะบะปััะฐะตััั ะฒ ัะพะผ, ะบะฐะบ ะฒั ะฟััะฐะตัะตัั ะฒัะฑัะฐัั ะฝะตัะบะพะปัะบะพ ััะพะปะฑัะพะฒ. ะะพะณะดะฐ ะฒั ะพะฑัะฐัะฐะตัะตัั ะบ ััะพะปะฑัะฐะผ ัะปะตะดัััะตะต ะฒััะฐะถะตะฝะธะต: ```python top_city_restaurant['name', 'avg_rating', 'reviews_count', 'latitude', 'longitude', 'category'] ``` ะญัะพ ะฝะตะฟัะฐะฒะธะปัะฝะพ, ะฟะพัะพะผั ััะพ pandas ะธะฝัะตัะฟัะตัะธััะตั `'name', 'avg_rating', ...` ะบะฐะบ ะบะพััะตะถ, ะฐ ะฝะต ะบะฐะบ ัะฟะธัะพะบ ััะพะปะฑัะพะฒ. ะะผะตััะพ ััะพะณะพ, ะฝัะถะฝะพ ะฟะตัะตะดะฐัั ัะฟะธัะพะบ ััะพะปะฑัะพะฒ ะฒ ะฒะธะดะต ัะปะตะดัััะธะผ ะพะฑัะฐะทะพะผ: ### ะัะฐะฒะธะปัะฝัะน ัะฟะพัะพะฑ: ```python top_city_restaurant[['name', 'avg_rating', 'reviews_count', 'latitude', 'longitude', 'category']] ``` ### ะะฑัััะฝะตะฝะธะต: - **`[['name', 'avg_rating', ...]]`**: ะญัะพ ะฟัะฐะฒะธะปัะฝัะน ัะธะฝัะฐะบัะธั ะดะปั ะฒัะฑะพัะบะธ ะฝะตัะบะพะปัะบะธั ััะพะปะฑัะพะฒ ะธะท DataFrame. ะะตัะตะดะฒะธะณะฐั ะธะผะตะฝะฐ ััะพะปะฑัะพะฒ ะฒ ัะฟะธัะพะบ, pandas ะฟะพะปััะธั ะดะพัััะฟ ะบะพ ะฒัะตะผ ัะบะฐะทะฐะฝะฝัะผ ััะพะปะฑัะฐะผ ะธ ะฒะตัะฝะตั ะฟะพะดัะฐะฑะปะธัั ั ะฝะธะผะธ. ### ะัะธะผะตั: ```python selected_columns = top_city_restaurant[['name', 'avg_rating', 'reviews_count', 'latitude', 'longitude', 'category']] print(selected_columns.head()) ``` ### ะะตะทัะผะต: ะัะฟะพะปัะทัะนัะต ะดะฒะพะนะฝัะต ะบะฒะฐะดัะฐัะฝัะต ัะบะพะฑะบะธ `[['col1', 'col2', ...]]` ะดะปั ะฒัะฑะพัะฐ ะฝะตัะบะพะปัะบะธั ััะพะปะฑัะพะฒ ะธะท_dataframe_, ะฐ ะฝะต ะพะดะธะฝะฐัะฝัะต ัะบะพะฑะบะธ ั ะบะพััะตะถะตะผ. ะดะปั 15 ัะตะบัะฝะด
ะัะพะฑะปะตะผะฐ ะผะพะถะตั ะฑััั ะฒ ัะพะผ, ะบะฐะบ ะฒั ะพะฑัะฐัะฐะตัะตัั ะบ ััะพะปะฑัะฐะผ DataFrame. ะะพะณะดะฐ ะฒั ะฟะธัะตัะต:

python
ะะพะฟะธัะพะฒะฐัั
top_city_restaurant['name', 'avg_rating', 'reviews_count', 'latitude', 'longitude', 'category']
Python ะธะฝัะตัะฟัะตัะธััะตั ะฒััะฐะถะตะฝะธะต ะบะฐะบ ะพะฑัะฐัะตะฝะธะต ะฟะพ ะบะปััั-ััple
('name', 'avg_rating', 'reviews_count', 'latitude', 'longitude', 'category')
ะฐ ะฝะต ะบะฐะบ ัะฟะธัะพะบ ะพัะดะตะปัะฝัั ััะพะปะฑัะพะฒ.

ะงัะพะฑั ะฒัะฑัะฐัั ะฝะตัะบะพะปัะบะพ ััะพะปะฑัะพะฒ, ะฝัะถะฝะพ ะฟะตัะตะดะฐะฒะฐัั ะธั ะฒ ะฒะธะดะต ัะฟะธัะบะฐ, ะธัะฟะพะปัะทัั ะดะฒะพะนะฝัะต ะบะฒะฐะดัะฐัะฝัะต ัะบะพะฑะบะธ, ะฝะฐะฟัะธะผะตั:

python
ะะพะฟะธัะพะฒะฐัั
top_city_restaurant[['name', 'avg_rating', 'reviews_count', 'latitude', 'longitude', 'category']]
ะขะฐะบะธะผ ะพะฑัะฐะทะพะผ, ัะฑะตะดะธัะตัั, ััะพ ะฟัะธ ะพะฑัะฐัะตะฝะธะธ ะบ ะฝะตัะบะพะปัะบะธะผ ััะพะปะฑัะฐะผ ะฒั ะธัะฟะพะปัะทัะตัะต ะฟัะฐะฒะธะปัะฝัะน ัะธะฝัะฐะบัะธั. ะญัะพ ะดะพะปะถะฝะพ ัะตัะธัั ะฟัะพะฑะปะตะผั, ัะฒัะทะฐะฝะฝัั ั ะฝะตะพะดะฝะพะทะฝะฐัะฝะพะน ะปะพะณะธัะตัะบะพะน ะพัะตะฝะบะพะน DataFrame.